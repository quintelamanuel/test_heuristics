!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.apollon=t():e.apollon=t()}(self,(()=>(()=>{"use strict";var e,t,n,o,s,i={321:(e,t,n)=>{n.r(t),n.d(t,{addToQueryPath:()=>Mu,clear:()=>ku,copySelectedElementsToLDM:()=>Lu,downloadGDM:()=>$u,downloadLDM:()=>Uu,finishQueryPath:()=>Su,loadGDM:()=>Fu,onChange:()=>bu,onEditorClick:()=>Eu,onSwitch:()=>vu,selectQueryRoot:()=>xu,selectRelationshipModifiableOption:()=>Nu,setTheming:()=>wu,showQueryShape:()=>Bu,stopShowingQueryShape:()=>Ou,tagSelectedClassesAsInstantiable:()=>Tu,tagSelectedClassesAsModifiable:()=>Pu,tagSelectedClassesAsQueried:()=>Au,tagSelectedClassesAsRequired:()=>Du,toggleExperiment:()=>zu,toggleRelationshipModifiableOptions:()=>Ru});const o=JSON.parse('{"light":{"--apollon-primary":"#2a8fbd","--apollon-primary-contrast":"#212529","--apollon-secondary":"#6c757d","--apollon-warning-yellow":"#ffc800","--apollon-background":"#ffffff","--apollon-background-variant":"#e5e5e5","--apollon-gray":"#e9ecef","--apollon-gray-variant":"#343a40","--apollon-grid":"rgba(36, 39, 36, 0.1)"},"dark":{"--apollon-primary":"#51a2a2","--apollon-primary-contrast":"#eae1e1","--apollon-secondary":"#6f85c2","--apollon-warning-yellow":"#ffc800","--apollon-background":"#1B2121","--apollon-background-variant":"#3e4c4c","--apollon-gray":"#343a40","--apollon-gray-variant":"#6c757d","--apollon-grid":"#3e4c4c"}}');var s=n.t(o,2);const i={GDM:"apollon_gdm",LDM:"apollon_ldm"},r={GDM:"apollon_gdm_model",LDM:"apollon_ldm_model"},a={colorEnabled:!0,scale:.5},l=!1,c="#e000ff",d={INSTANTIABLE:"<<instantiable>>",MODIFIABLE:"<<modifiable>>",REQUIRED:"<<required>>",QUERIED:"<<queried>>",QUERY_ROOT:"<<query_root>>",PENDING:"<<pending>>"},h={INSTANTIABLE:"#FFE0B2",MODIFIABLE:"#FFF9C4",REQUIRED:"#aeffff",QUERIED:"#ffc4f1",QUERY_ROOT:"#e1b8ff",PENDING:"#ff6876",DEFAULT:"#ffffff"},u={FILL:"#ffffff",STROKE:"#000000",TEXT:"#000000"};class p{constructor(e){this.lastSelectionUpdateData=null,this.currentQueryPathBuilder=null,this.showingQueryShapeBtn=!1,this.editorManager=e}initialize(){this.initStyles(),this.setupEventListeners(),this.setTheming("light"),this.initQueryShapeButtons(),this.setupSelectionStateListeners(),this.updateAllButtonStates(!1,!1,!1,this.isQueryPathInProgress(),!1,!1)}setCurrentQueryPathBuilder(e){this.currentQueryPathBuilder=e}setupEventListeners(){const e=document.getElementById("theming-light-mode-button"),t=document.getElementById("theming-dark-mode-button");e&&e.addEventListener("click",(()=>this.setTheming("light"))),t&&t.addEventListener("click",(()=>this.setTheming("dark"))),this.setupQueryShapeButtonListeners()}initQueryShapeButtons(){this.enableButton("selectQueryRootBtn"),this.disableButton("addToPathBtn"),this.disableButton("finishPathBtn")}setupQueryShapeButtonListeners(){const e=document.getElementById("selectQueryRootBtn"),t=document.getElementById("addToPathBtn"),n=document.getElementById("finishPathBtn"),o=document.getElementById("showQueryShapeBtn"),s=document.getElementById("stopShowingQueryShapeBtn");e&&e.addEventListener("click",(()=>this.selectQueryRoot())),t&&t.addEventListener("click",(()=>this.addToQueryPath())),n&&n.addEventListener("click",(()=>this.finishQueryPath())),o&&o.addEventListener("click",(()=>this.showQueryShape())),s&&s.addEventListener("click",(()=>this.stopShowingQueryShape()))}selectQueryRoot(){console.log("Query shape root selected"),this.disableButton("selectQueryRootBtn"),this.enableButton("addToPathBtn"),this.enableButton("finishPathBtn")}addToQueryPath(){console.log("Added to query path")}finishQueryPath(){console.log("Query path finished"),this.enableButton("selectQueryRootBtn"),this.disableButton("addToPathBtn"),this.disableButton("finishPathBtn")}showQueryShape(){if(console.log("Showing query shape"),this.showingQueryShapeBtn=!0,this.lastSelectionUpdateData){const{hasClassSelected:e,hasRelationshipSelected:t,hasQueryRootSelected:n,onlyOneThingSelected:o}=this.lastSelectionUpdateData;this.updateAllButtonStates(e,t,n,this.isQueryPathInProgress(),o,this.showingQueryShapeBtn)}}stopShowingQueryShape(){if(console.log("Stopped showing query shape"),this.showingQueryShapeBtn=!1,this.lastSelectionUpdateData){const{hasClassSelected:e,hasRelationshipSelected:t,hasQueryRootSelected:n,onlyOneThingSelected:o}=this.lastSelectionUpdateData;this.updateAllButtonStates(e,t,n,this.isQueryPathInProgress(),o,this.showingQueryShapeBtn)}}initStyles(){const e=document.createElement("style");e.textContent="\n      .active-editor {\n        box-shadow: 0 0 0 3px #4d90fe; /* Blue outline for active editor */\n      }\n      \n      .theme-button {\n        cursor: pointer;\n        padding: 5px 10px;\n        margin: 5px;\n        border: 1px solid #ccc;\n        border-radius: 3px;\n      }\n      \n      .theme-button.selected {\n        background-color: #4d90fe;\n        color: white;\n      }\n    ",document.head.appendChild(e)}onEditorClick(e){this.editorManager.setActiveEditor(e)}onChange(e){const t=e.target;if(!t)return;const{name:n,value:o}=t;this.editorManager.updateActiveOptions({[n]:o}),this.editorManager.saveActiveModel(),this.editorManager.renderAll()}onSwitch(e){const t=e.target;if(!t)return;const{name:n,checked:o}=t;this.editorManager.updateActiveOptions({[n]:o}),this.editorManager.saveActiveModel(),this.editorManager.renderAll()}setTheming(e){const t=document.documentElement,n=document.getElementById("light"===e?"theming-light-mode-button":"theming-dark-mode-button"),o=document.getElementById("light"===e?"theming-dark-mode-button":"theming-light-mode-button");n&&o&&(n.classList.add("selected"),o.classList.remove("selected"));for(const n of Object.keys(s[e]))t.style.setProperty(n,s[e][n])}refreshUI(){this.editorManager.getActiveEditorId();const{options:e}=this.editorManager.getActiveEditor();if(e){const t=document.getElementById("colorEnabled");t&&(t.checked=e.colorEnabled||!1);const n=document.getElementById("scale");n&&e.scale&&(n.value=e.scale.toString())}}showRelationshipModifiableOptions(e){const{relationshipId:t,sourceRole:n,targetRole:o}=e,s=document.getElementById("tagModifiableBtn"),i=document.getElementById("modifiableOptionBtn1"),r=document.getElementById("modifiableOptionBtn2");s&&i&&r?(i.dataset.relationshipId=t,r.dataset.relationshipId=t,this.disableButton("tagModifiableBtn"),this.enableButton("modifiableOptionBtn1"),i.textContent=n,this.enableButton("modifiableOptionBtn2"),r.textContent=o):console.error("One or more buttons not found in the DOM")}resetRelationshipModifiableOptions(){const e=document.getElementById("modifiableOptionBtn1"),t=document.getElementById("modifiableOptionBtn2"),n=e.dataset.relationshipId;return this.disableButton("modifiableOptionBtn1"),this.disableButton("modifiableOptionBtn2"),delete e.dataset.relationshipId,delete t.dataset.relationshipId,this.enableButton("tagModifiableBtn"),n}isQueryPathInProgress(){return null!==this.currentQueryPathBuilder}setupSelectionStateListeners(){document.addEventListener("apollon:selection-changed",(e=>{const t=e;this.lastSelectionUpdateData=t.detail;const{hasClassSelected:n,hasRelationshipSelected:o,hasQueryRootSelected:s,onlyOneThingSelected:i}=this.lastSelectionUpdateData;this.updateAllButtonStates(n,o,s,this.isQueryPathInProgress(),i,this.showingQueryShapeBtn)}))}getLastSelectionUpdateData(){return this.lastSelectionUpdateData}updateAllButtonStates(e,t,n,o,s,i){const r={hasClassSelected:e,hasRelationshipSelected:t,hasQueryRootSelected:n,isQueryPathInProgress:o,onlyOneThingSelected:s,showingQueryShape:i};this.updateButtonStates(r)}updateButtonStates(e){if(e.showingQueryShape)return this.disableAllButtons(),void this.enableButton("stopShowingQueryShapeBtn");this.updateButton("instantiableClassBtn",e.onlyOneThingSelected&&e.hasClassSelected&&!e.isQueryPathInProgress),this.updateButton("modifiableClassBtn",e.onlyOneThingSelected&&e.hasClassSelected&&!e.isQueryPathInProgress),this.updateButton("tagModifiableBtn",e.onlyOneThingSelected&&e.hasRelationshipSelected&&!e.isQueryPathInProgress),this.updateButton("selectQueryRootBtn",e.onlyOneThingSelected&&e.hasClassSelected&&!e.isQueryPathInProgress),this.updateButton("showQueryShapeBtn",e.onlyOneThingSelected&&e.hasQueryRootSelected&&!e.isQueryPathInProgress),this.updateButton("stopShowingQueryShapeBtn",!1)}updateButton(e,t){t?this.enableButton(e):this.disableButton(e)}disableAllButtons(){["selectQueryRootBtn","addToPathBtn","finishPathBtn","showQueryShapeBtn","instantiableClassBtn","modifiableClassBtn","tagModifiableBtn","modifiableOptionBtn1","modifiableOptionBtn2"].forEach((e=>this.disableButton(e)))}enableButton(e){const t=document.getElementById(e);t&&(t.disabled=!1,t.removeAttribute("disabled"),t.classList.add("active"))}disableButton(e){const t=document.getElementById(e);t&&(t.disabled=!0,t.setAttribute("disabled","true"),t.classList.remove("active"))}highlightRelarionships(e){const t=this.editorManager.getModelsManager().getGDMManager();for(const n of e)t.changeRelationshipStrokeColor(n.id,c)}resetHighlightedRelationships(){const e=this.editorManager.getModelsManager().getGDMManager(),t=Object.values(e.getModel().relationships);for(const n of t)e.resetRelationshipStrokeColor(n.id)}}const m={Activity:"Activity",ActivityActionNode:"ActivityActionNode",ActivityFinalNode:"ActivityFinalNode",ActivityForkNode:"ActivityForkNode",ActivityForkNodeHorizontal:"ActivityForkNodeHorizontal",ActivityInitialNode:"ActivityInitialNode",ActivityMergeNode:"ActivityMergeNode",ActivityObjectNode:"ActivityObjectNode"},g={ActivityControlFlow:"ActivityControlFlow"},y={Package:"Package",Class:"Class",AbstractClass:"AbstractClass",Interface:"Interface",Enumeration:"Enumeration",ClassAttribute:"ClassAttribute",ClassMethod:"ClassMethod"},f={ClassBidirectional:"ClassBidirectional",ClassUnidirectional:"ClassUnidirectional",ClassInheritance:"ClassInheritance",ClassRealization:"ClassRealization",ClassDependency:"ClassDependency",ClassAggregation:"ClassAggregation",ClassComposition:"ClassComposition"},C={Component:"Component",Subsystem:"Subsystem",ComponentInterface:"ComponentInterface"},E={ComponentInterfaceProvided:"ComponentInterfaceProvided",ComponentInterfaceRequired:"ComponentInterfaceRequired",ComponentDependency:"ComponentDependency"},b={DeploymentNode:"DeploymentNode",DeploymentComponent:"DeploymentComponent",DeploymentArtifact:"DeploymentArtifact",DeploymentInterface:"DeploymentInterface"},v={DeploymentAssociation:"DeploymentAssociation",DeploymentInterfaceProvided:"DeploymentInterfaceProvided",DeploymentInterfaceRequired:"DeploymentInterfaceRequired",DeploymentDependency:"DeploymentDependency"},w={ObjectName:"ObjectName",ObjectAttribute:"ObjectAttribute",ObjectMethod:"ObjectMethod"},k={ObjectLink:"ObjectLink"},x={UseCase:"UseCase",UseCaseActor:"UseCaseActor",UseCaseSystem:"UseCaseSystem"},M={UseCaseAssociation:"UseCaseAssociation",UseCaseGeneralization:"UseCaseGeneralization",UseCaseInclude:"UseCaseInclude",UseCaseExtend:"UseCaseExtend"},S={PetriNetPlace:"PetriNetPlace",PetriNetTransition:"PetriNetTransition"},I={PetriNetArc:"PetriNetArc"},T={CommunicationLink:"CommunicationLink"},P={CommunicationLinkMessage:"CommunicationLinkMessage"},D={ClassDiagram:"ClassDiagram",ObjectDiagram:"ObjectDiagram",ActivityDiagram:"ActivityDiagram",UseCaseDiagram:"UseCaseDiagram",CommunicationDiagram:"CommunicationDiagram",ComponentDiagram:"ComponentDiagram",DeploymentDiagram:"DeploymentDiagram",PetriNet:"PetriNet",ReachabilityGraph:"ReachabilityGraph",SyntaxTree:"SyntaxTree",Flowchart:"Flowchart",BPMN:"BPMN"},A={SyntaxTreeTerminal:"SyntaxTreeTerminal",SyntaxTreeNonterminal:"SyntaxTreeNonterminal"},L={SyntaxTreeLink:"SyntaxTreeLink"},R={FlowchartTerminal:"FlowchartTerminal",FlowchartProcess:"FlowchartProcess",FlowchartDecision:"FlowchartDecision",FlowchartInputOutput:"FlowchartInputOutput",FlowchartFunctionCall:"FlowchartFunctionCall"},N={FlowchartFlowline:"FlowchartFlowline"},B={ColorLegend:"ColorLegend"},O={ReachabilityGraphMarking:"ReachabilityGraphMarking"},$={ReachabilityGraphArc:"ReachabilityGraphArc"},U={BPMNTask:"BPMNTask",BPMNSubprocess:"BPMNSubprocess",BPMNTransaction:"BPMNTransaction",BPMNCallActivity:"BPMNCallActivity",BPMNAnnotation:"BPMNAnnotation",BPMNStartEvent:"BPMNStartEvent",BPMNIntermediateEvent:"BPMNIntermediateEvent",BPMNEndEvent:"BPMNEndEvent",BPMNGateway:"BPMNGateway",BPMNDataObject:"BPMNDataObject",BPMNDataStore:"BPMNDataStore",BPMNPool:"BPMNPool",BPMNSwimlane:"BPMNSwimlane",BPMNGroup:"BPMNGroup"},F={BPMNFlow:"BPMNFlow"},z={...y,...w,...m,...x,...P,...C,...b,...S,...O,...A,...R,...B,...U},H={[D.ClassDiagram]:y,[D.ObjectDiagram]:w,[D.ActivityDiagram]:m,[D.UseCaseDiagram]:x,[D.CommunicationDiagram]:P,[D.ComponentDiagram]:C,[D.DeploymentDiagram]:b,[D.PetriNet]:S,[D.ReachabilityGraph]:O,[D.SyntaxTree]:A,[D.Flowchart]:R,[D.BPMN]:U,...B};class j{constructor(e,t){this.editorManager=e,this.modelsManager=t}tagSelectedClasses(e,t){const{editor:n,editorId:o}=this.editorManager.getActiveEditor();if(!n)return;if(!this.editorManager.getSelection())return;let s=!1;for(const n of e)(t=t.bind(this.modelsManager))(n),s=!0;if(s){if(o===i.GDM){const e=this.modelsManager.getModelGDM();this.editorManager.updateOptions(o,{model:e})}else{const e=this.modelsManager.getModelLDM();this.editorManager.updateOptions(o,{model:e})}this.editorManager.render(o)}}removeTagFromClasses(e,t){const{editor:n,editorId:o}=this.editorManager.getActiveEditor();if(!n)return;if(!this.editorManager.getSelection())return;let s=!1;for(const n of e)(t=t.bind(this.modelsManager))(n),s=!0;if(s){if(o===i.GDM){const e=this.modelsManager.getModelGDM();this.editorManager.updateOptions(o,{model:e})}else{const e=this.modelsManager.getModelLDM();this.editorManager.updateOptions(o,{model:e})}this.editorManager.render(o)}}removeTagClassPending(e){this.removeTagFromClasses(e,this.modelsManager.removeClassTagPending)}tagClassAsInstantiable(e){this.tagSelectedClasses(e,this.modelsManager.tagClassAsInstantiable)}tagClassAsModifiable(e){this.tagSelectedClasses(e,this.modelsManager.tagClassAsModifiable)}tagClassAsRequired(e){this.tagSelectedClasses(e,this.modelsManager.tagClassAsRequired)}tagClassAsQueried(e){this.tagSelectedClasses(e,this.modelsManager.tagClassAsQueried)}tagClassAsQueryRoot(e){this.tagSelectedClasses(e,this.modelsManager.tagClassAsQueryRoot)}tagClassAsPending(e){this.tagSelectedClasses(e,this.modelsManager.tagClassAsPending)}tagRelationshipEndAs(e,t,n){const{editor:o,editorId:s}=this.editorManager.getActiveEditor();if(!o)return;const r=this.editorManager.getSelection();if(!r)return;if(Object.keys(r.relationships).length>1)return void console.error("Cannot tag multiple relationships at once");const a=this.modelsManager.getGDMManager().getRelationshipById(e);if(a&&["ClassUnidirectional","ClassBidirectional","ClassAggregation","ClassComposition"].includes(a.type)){if((n=n.bind(this.modelsManager))(e,t),s===i.GDM){const e=this.modelsManager.getModelGDM();this.editorManager.updateOptions(s,{model:e})}else{const e=this.modelsManager.getModelLDM();this.editorManager.updateOptions(s,{model:e})}this.editorManager.render(s)}else console.error("Please select an association, aggregation, or composition")}tagRelationshipEndAsModifiable(e,t){this.tagRelationshipEndAs(e,t,this.modelsManager.tagRelationshipEndAsModifiable)}tagRelationshipEndAsQueried(e,t){this.tagRelationshipEndAs(e,t,this.modelsManager.tagRelationshipEndAsQueried)}copySelectedElementsToLDM(){const e=this.editorManager.getEditor(i.GDM),t=this.editorManager.getEditor(i.LDM);if(!e||!t)return void console.error("Cannot copy: One or both editors are not available");const n=e.selection,o=Object.keys(n.elements),s=Object.keys(n.relationships);this.copyElementsToLDM(o,s)}updateLDMAfterHeuristics(e,t){this.editorManager.clearInactiveModel(),this.copyElementsToLDM(e,t)}copyElementsToLDM(e,t){const n=this.editorManager.getEditor(i.GDM),o=this.editorManager.getEditor(i.LDM);if(!n||!o)return void console.error("Cannot copy: One or both editors are not available");let s=!1;for(const t of e)this.modelsManager.copyClassifierFromGDMToLDMById(t),s=!0;for(const n of t){const t=this.modelsManager.getGDMManager().getRelationshipById(n),o=t.source.element,i=t.target.element,r=e.includes(o)&&e.includes(i),a=void 0!==this.modelsManager.getLDMManager().getClassElementById(o),l=void 0!==this.modelsManager.getLDMManager().getClassElementById(i);(r||a&&l)&&(this.modelsManager.copyRelationshipFromGDMToLDMById(t.id),s=!0)}if(s){const e=this.modelsManager.getModelGDM();this.editorManager.updateOptions(i.GDM,{model:e});const t=this.modelsManager.getModelLDM();this.editorManager.updateOptions(i.LDM,{model:t}),this.editorManager.renderAll()}}updateLDMRelationships(e){const t=this.editorManager.getEditor(i.GDM),n=this.editorManager.getEditor(i.LDM);if(!t||!n)return void console.error("Cannot copy: One or both editors are not available");let o=!1;for(const t of e){const n=t.relationshipType;["ClassBidirectional","ClassAggregation","ClassComposition"].includes(n)&&(this.modelsManager.updateLDMRelationship(t,e),o=!0)}if(o){const e=this.modelsManager.getModelGDM();this.editorManager.updateOptions(i.GDM,{model:e});const t=this.modelsManager.getModelLDM();this.editorManager.updateOptions(i.LDM,{model:t}),this.editorManager.renderAll()}}getSelectedRelationshipInfo(){const e=this.editorManager.getSelection();if(!e)return;const t=Object.keys(e.relationships||{});if(1!==t.length)return void console.log("Please select exactly one relationship");const n=t[0],o=this.editorManager.getActiveEditor().editorId===i.GDM?this.modelsManager.getModelGDM():this.modelsManager.getModelLDM();if(!o||!o.relationships[n])return;const s=o.relationships[n];if(["ClassUnidirectional","ClassBidirectional","ClassAggregation","ClassComposition"].includes(s.type))return{relationshipId:n,sourceRole:s.source.role||"Source",targetRole:s.target.role||"Target"};console.log("Please select an association, aggregation, or composition")}initialize(){document.addEventListener("apollon:selection-changed",(e=>{const t=e,{selectedElementIds:n,selectedRelationshipIds:o,activeEditorId:s}=t.detail;l&&this.handleAutoTagging(n,o,s)}))}handleAutoTagging(e,t,n){if(n===i.LDM){for(const t of e){const e=this.modelsManager.getLDMManager().getClassElementById(t);e&&e.type===z.Class&&this.modelsManager.tagClassAsRequired(t)}this.editorManager.render(n)}}startQueryRoot(e){console.log(`startQueryShapeRoot(${e}) from TaggingService`),this.tagClassAsQueryRoot([e])}addToQueryPath(e,t,n){const o=this.modelsManager.getGDMManager().getRelationshipOppositeEndClass(t,n);if(!o)throw new Error(`Target class not found for relationship ID: ${n}`);this.tagRelationshipEndAsQueried(n,"source"),this.tagClassAsQueried([o.id]),console.log("addToQueryPath() from TaggingService")}finishQueryPath(){console.log("finishQueryPath() from TaggingService")}highlightRelationships(e,t){const{editor:n,editorId:o}=this.editorManager.getActiveEditor();if(n){for(const n of e)this.modelsManager.changeRelationshipStrokeColor(n,t);this.editorManager.updateOptions(o,{model:this.modelsManager.getModelGDM()}),this.editorManager.render(o)}}highlightRelationship(e,t){const{editor:n,editorId:o}=this.editorManager.getActiveEditor();n&&(this.modelsManager.changeRelationshipStrokeColor(e,t),this.editorManager.updateOptions(o,{model:this.modelsManager.getModelGDM()}),this.editorManager.render(o))}resetHighlightedRelationships(e){const{editor:t,editorId:n}=this.editorManager.getActiveEditor();if(t){for(const t of e)this.modelsManager.resetRelationshipStrokeColor(t);this.editorManager.updateOptions(n,{model:this.modelsManager.getModelGDM()}),this.editorManager.render(n)}}resetHighlightedRelationship(e){const{editor:t,editorId:n}=this.editorManager.getActiveEditor();t&&(this.modelsManager.resetRelationshipStrokeColor(e),this.editorManager.updateOptions(n,{model:this.modelsManager.getModelGDM()}),this.editorManager.render(n))}}class Q{constructor(e){this.editorManager=e}async exportAsJSON(e){const t=await e.exportAsJSON({space:2}),n=new Blob([t],{type:"application/json"}),o=URL.createObjectURL(n);window.open(o)}async downloadGDMAs(e){const t=this.editorManager.getEditor(i.GDM);if(!t)return void console.error("Cannot download: GDM editor not available");const n=`GDM_${(new Date).toISOString().split("T")[0]}`;await this.downloadModelAs(t,e||n)}async downloadLDMAs(e){const t=this.editorManager.getEditor(i.LDM);if(!t)return void console.error("Cannot download: LDM editor not available");const n=`LDM_${(new Date).toISOString().split("T")[0]}`;await this.downloadModelAs(t,e||n)}async downloadModelAs(e,t){const n=document.createElement("a"),o=await e.exportAsJSON({space:2}),s=new Blob([o],{type:"application/json"});n.href=URL.createObjectURL(s),n.download=`${t}.json`,document.body.appendChild(n),n.click(),document.body.removeChild(n)}async loadGDM(){return new Promise(((e,t)=>{const n=document.createElement("input");n.type="file",n.accept="application/json",n.style.display="none",document.body.appendChild(n),n.addEventListener("change",(async o=>{try{const t=o.target.files;if(!t||0===t.length)throw new Error("No file selected");const n=t[0],s=await this.readFileAsText(n),r=JSON.parse(s);if(!r||!r.elements)throw new Error("Invalid model file format");if(!this.editorManager.getEditor(i.GDM))throw new Error("GDM editor not available");this.editorManager.updateOptions(i.GDM,{model:r}),this.editorManager.render(i.GDM);const a=this.editorManager.getModelsManager();a.setModelGDM(r),a.saveGDMToLocalStorage(),console.log("GDM model loaded successfully"),e()}catch(e){console.error("Error loading GDM model:",e),t(e)}finally{document.body.removeChild(n)}})),n.click()}))}readFileAsText(e){return new Promise(((t,n)=>{const o=new FileReader;o.onload=e=>{e.target&&"string"==typeof e.target.result?t(e.target.result):n(new Error("Failed to read file content"))},o.onerror=()=>{n(new Error("Error reading file"))},o.readAsText(e)}))}}n(3443);var W=n(6540),G=n(5338);const q=(e,t)=>{for(const n in t)Array.isArray(t[n])?"selectedBy"===n&&void 0===e[n]?e[n]=[...q({...e,selectedBy:[]}[n],t[n])]:e[n]=[...q(e[n],t[n])]:"object"==typeof t[n]?null==t[n]?e[n]=null:e[n]={...e[n],...q(e[n],t[n])}:void 0!==t[n]&&(void 0===e&&(e={}),e[n]=t[n]);return e};class _{constructor(e=0,t=0){this.x=e,this.y=t}get length(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){return new _(this.x/this.length,this.y/this.length)}add(e,t){return e instanceof _?new _(this.x+e.x,this.y+e.y):"number"==typeof t?new _(this.x+e,this.y+t):this.clone()}subtract(e,t){return e instanceof _?new _(this.x-e.x,this.y-e.y):"number"==typeof t?new _(this.x-e,this.y-t):this.clone()}round(e=10){return new _(Math.round(this.x/e)*e,Math.round(this.y/e)*e)}scale(e){return new _(this.x*e,this.y*e)}clone(){return new _(this.x,this.y)}}const V=n(3829).A;var Y,Z;function X(e){switch(e){case Y.Down:return Y.Up;case Y.Left:return Y.Right;case Y.Right:return Y.Left;case Y.Up:return Y.Down;case Y.Upright:return Y.Upleft;case Y.Downright:return Y.Downleft;case Y.Upleft:return Y.Upright;case Y.Downleft:return Y.Downright;case Y.Topright:return Y.Topleft;case Y.Bottomright:return Y.Bottomleft;case Y.Topleft:return Y.Topright;case Y.Bottomleft:return Y.Bottomright;default:throw Error(`Could not determine opposite direction for direction of ${e}`)}}!function(e){e.Up="Up",e.Right="Right",e.Down="Down",e.Left="Left",e.Upright="Upright",e.Upleft="Upleft",e.Downright="Downright",e.Downleft="Downleft",e.Topright="Topright",e.Topleft="Topleft",e.Bottomright="Bottomright",e.Bottomleft="Bottomleft"}(Y||(Y={})),function(e){e.TOPLEFT="topLeft",e.TOPRIGHT="topRight",e.BOTTOMLEFT="bottomLeft",e.BOTTOMRIGHT="bottomRight"}(Z||(Z={}));const K=e=>({[Y.Up]:new _(e.bounds.width/2,0),[Y.Right]:new _(e.bounds.width,e.bounds.height/2),[Y.Down]:new _(e.bounds.width/2,e.bounds.height),[Y.Left]:new _(0,e.bounds.height/2),[Y.Upright]:new _(e.bounds.width,e.bounds.height/4),[Y.Downright]:new _(e.bounds.width,3*e.bounds.height/4),[Y.Upleft]:new _(0,e.bounds.height/4),[Y.Downleft]:new _(0,3*e.bounds.height/4),[Y.Topright]:new _(3*e.bounds.width/4,0),[Y.Bottomright]:new _(3*e.bounds.width/4,e.bounds.height),[Y.Topleft]:new _(e.bounds.width/4,0),[Y.Bottomleft]:new _(e.bounds.width/4,e.bounds.height)});class J{constructor(e){this.id=V(),this.name="",this.bounds={x:0,y:0,width:160,height:100},this.owner=null,this.resizeFrom=Z.BOTTOMRIGHT,q(this,e)}clone(e){return new(0,this.constructor)({...this,...e,id:V()})}serialize(e){return{id:this.id,name:this.name,type:this.type,owner:this.owner,bounds:this.bounds,highlight:this.highlight,fillColor:this.fillColor,strokeColor:this.strokeColor,textColor:this.textColor,assessmentNote:this.assessmentNote}}deserialize(e,t){this.id=e.id,this.name=e.name,this.type=e.type,this.owner=e.owner||null,this.bounds={...e.bounds},this.highlight=e.highlight,this.fillColor=e.fillColor,this.strokeColor=e.strokeColor,this.textColor=e.textColor,this.assessmentNote=e.assessmentNote}}function ee(e){if(!e.length)return{x:0,y:0,width:0,height:0};const t=e.map((e=>({...e.bounds}))),n=Math.min(...t.map((e=>e.x))),o=Math.min(...t.map((e=>e.y)));return{x:n,y:o,width:Math.max(...t.map((e=>e.x+e.width)))-n,height:Math.max(...t.map((e=>e.y+e.height)))-o}}function te(e,t,n){return n&&1===e?t*e:10*Math.round(t*e/10)}J.features={connectable:!0,droppable:!1,hoverable:!0,movable:!0,resizable:!0,selectable:!0,updatable:!0,alternativePortVisualization:!1},J.supportedRelationships=[],J.isUMLElement=e=>e.type in z;class ne{}function oe(e,t){return ee([e,{bounds:{x:e.bounds.x,y:e.bounds.y,width:10*Math.round((ne.size(t,e.name,{fontWeight:"bold"}).width+20)/10),height:10*Math.round((ne.size(t,e.name,{fontWeight:"bold"}).height+20)/10)}}])}ne.size=(e,t,n)=>{const o=e.layer;if(!o)return{width:0,height:0};const s=document.createElementNS("http://www.w3.org/2000/svg","text");Object.assign(s.style,{...n,visibility:"hidden"}),s.appendChild(document.createTextNode(t)),o.appendChild(s);const i=s.getBBox();return o.removeChild(s),{width:i.width,height:i.height}};class se extends J{constructor(){super(...arguments),this.type=m.ActivityActionNode}render(e){return this.bounds=oe(this,e),[this]}}se.supportedRelationships=[g.ActivityControlFlow];class ie extends J{constructor(e){super(e),this.type=m.ActivityFinalNode,this.bounds={...this.bounds,width:50,height:50},q(this,e)}render(e){return[this]}}ie.supportedRelationships=[g.ActivityControlFlow],ie.features={...J.features,resizable:!1,updatable:!1};class re extends J{constructor(e){super(e),this.type=m.ActivityForkNode,this.bounds={...this.bounds},this.bounds.height=e&&e.bounds&&e.bounds.height||re.defaultHeight,this.bounds.width=re.defaultWidth}render(e){return this.bounds.height=Math.max(this.bounds.height,re.defaultHeight),[this]}}re.supportedRelationships=[g.ActivityControlFlow],re.features={...J.features,updatable:!1},re.defaultWidth=20,re.defaultHeight=60;class ae extends J{constructor(e){super(e),this.type=m.ActivityForkNodeHorizontal,this.bounds={...this.bounds},this.bounds.width=e&&e.bounds&&e.bounds.width||ae.defaultWidth,this.bounds.height=ae.defaultHeight}render(e){return this.bounds.width=Math.max(this.bounds.width,ae.defaultWidth),[this]}}ae.supportedRelationships=[g.ActivityControlFlow],ae.features={...J.features,updatable:!1},ae.defaultWidth=60,ae.defaultHeight=20;class le extends J{constructor(e){super(e),this.type=m.ActivityInitialNode,this.bounds={...this.bounds,width:50,height:50},q(this,e)}render(e){return[this]}}le.supportedRelationships=[g.ActivityControlFlow],le.features={...J.features,resizable:!1,updatable:!1};class ce extends J{constructor(){super(...arguments),this.type=m.ActivityMergeNode,this.bounds={...this.bounds}}render(e){return this.bounds=oe(this,e),[this]}}ce.supportedRelationships=[g.ActivityControlFlow];class de extends J{constructor(){super(...arguments),this.type=m.ActivityObjectNode}render(e){return this.bounds=oe(this,e),[this]}}de.supportedRelationships=[g.ActivityControlFlow];class he extends J{constructor(e){super(),this.ownedElements=[],q(this,e)}reorderChildren(e){return e.map((e=>e.id))}serialize(e){return{...super.serialize(e),type:this.type}}deserialize(e,t=[]){super.deserialize(e),this.ownedElements=t.map((e=>e.id))}}he.features={...J.features,droppable:!0},he.isUMLContainer=e=>"ownedElements"in e;class ue extends he{render(e,t=[],n){const o=oe(this,e),s=t.map((e=>(e.bounds.x+=this.bounds.x,e.bounds.y+=this.bounds.y,e)));let i=ee([{bounds:o},...s]);n&&(i=o);const r=s.map((e=>(e.bounds.x-=this.bounds.x,e.bounds.y-=this.bounds.y,e))),a=i.x-this.bounds.x,l=i.y-this.bounds.y;return r.forEach((e=>{e.bounds.x-=a,e.bounds.y-=l})),this.bounds=i,[this,...r]}}class pe extends ue{constructor(){super(...arguments),this.type=m.Activity}}pe.supportedRelationships=[g.ActivityControlFlow];class me extends J{constructor(e){super(e),this.bounds={...this.bounds,height:te(1,30)},q(this,e)}render(e){const t=ne.size(e,this.name).width+20;return this.bounds.width=Math.max(this.bounds.width,10*Math.round(t/10)),[this]}}me.features={...J.features,hoverable:!1,selectable:!1,movable:!1,resizable:!1,connectable:!1,droppable:!1,updatable:!1};class ge extends me{}class ye extends me{}class fe extends he{get headerHeight(){return this.stereotype?fe.stereotypeHeaderHeight:fe.nonStereotypeHeaderHeight}constructor(e){super(),this.italic=!1,this.underline=!1,this.stereotype=null,this.deviderPosition=0,this.hasAttributes=!1,this.hasMethods=!1,q(this,e)}serialize(e=[]){return{...super.serialize(e),type:this.type,attributes:e.filter((e=>e instanceof ge)).map((e=>e.id)),methods:e.filter((e=>e instanceof ye)).map((e=>e.id))}}render(e,t=[]){const n=t.filter((e=>e instanceof ge)),o=t.filter((e=>e instanceof ye));this.hasAttributes=n.length>0,this.hasMethods=o.length>0,this.bounds.width=[this,...n,...o].reduce(((t,n,o)=>Math.max(t,10*Math.round((ne.size(e,n.name,0===o?{fontWeight:"bold"}:void 0).width+20)/10))),10*Math.round(this.bounds.width/10));let s=this.headerHeight;for(const e of n)e.bounds.x=.5,e.bounds.y=s+.5,e.bounds.width=this.bounds.width-1,s+=e.bounds.height;this.deviderPosition=s;for(const e of o)e.bounds.x=.5,e.bounds.y=s+.5,e.bounds.width=this.bounds.width-1,s+=e.bounds.height;return this.bounds.height=s,[this,...n,...o]}}fe.features={...he.features,droppable:!1,resizable:"WIDTH"},fe.stereotypeHeaderHeight=50,fe.nonStereotypeHeaderHeight=40;class Ce extends fe{constructor(){super(...arguments),this.type=y.AbstractClass,this.italic=!0,this.stereotype="abstract"}reorderChildren(e){const t=e.filter((e=>e.type===y.ClassAttribute)),n=e.filter((e=>e.type===y.ClassMethod));return[...t.map((e=>e.id)),...n.map((e=>e.id))]}}class Ee extends ge{constructor(){super(...arguments),this.type=y.ClassAttribute}}class be extends ye{constructor(){super(...arguments),this.type=y.ClassMethod}}class ve extends ue{constructor(){super(...arguments),this.type=y.Package}}class we extends fe{constructor(){super(...arguments),this.type=y.Class}reorderChildren(e){const t=e.filter((e=>e.type===y.ClassAttribute)),n=e.filter((e=>e.type===y.ClassMethod));return[...t.map((e=>e.id)),...n.map((e=>e.id))]}}class ke extends fe{constructor(){super(...arguments),this.type=y.Enumeration,this.stereotype="enumeration"}reorderChildren(e){const t=e.filter((e=>e.type===y.ClassAttribute)),n=e.filter((e=>e.type===y.ClassMethod));return[...t.map((e=>e.id)),...n.map((e=>e.id))]}}class xe extends fe{constructor(){super(...arguments),this.type=y.Interface,this.stereotype="interface"}reorderChildren(e){const t=e.filter((e=>e.type===y.ClassAttribute)),n=e.filter((e=>e.type===y.ClassMethod));return[...t.map((e=>e.id)),...n.map((e=>e.id))]}}class Me extends J{constructor(e){super(e),this.bounds={...this.bounds,width:20,height:20},q(this,e)}render(e){return[this]}}Me.features={...J.features,resizable:!1,alternativePortVisualization:!0};class Se extends Me{constructor(){super(...arguments),this.type=C.ComponentInterface}}Se.supportedRelationships=[E.ComponentInterfaceProvided,E.ComponentInterfaceRequired];class Ie extends J{constructor(e){super(),this.type=b.DeploymentArtifact,this.bounds={...this.bounds,height:40},q(this,e),this.bounds.height=e&&e.bounds&&e.bounds.height||40}render(e){return this.bounds.height=Math.max(this.bounds.height,40),this.bounds=oe(this,e),[this]}}Ie.supportedRelationships=[v.DeploymentAssociation,v.DeploymentDependency,v.DeploymentInterfaceProvided,v.DeploymentInterfaceRequired];class Te extends ue{constructor(e){super(),this.type=b.DeploymentNode,this.stereotype="node",this.displayStereotype=!0,q(this,e)}serialize(){return{...super.serialize(),type:this.type,stereotype:this.stereotype,displayStereotype:this.displayStereotype}}deserialize(e,t){e.type===b.DeploymentNode&&(super.deserialize(e,t),this.stereotype=e.stereotype,this.displayStereotype=e.displayStereotype)}}Te.supportedRelationships=[v.DeploymentAssociation,v.DeploymentDependency,v.DeploymentInterfaceProvided,v.DeploymentInterfaceRequired];class Pe extends ge{constructor(){super(...arguments),this.type=w.ObjectAttribute}}class De extends ye{constructor(){super(...arguments),this.type=w.ObjectMethod}}class Ae extends fe{constructor(){super(...arguments),this.type=w.ObjectName,this.underline=!0}reorderChildren(e){const t=e.filter((e=>e.type===w.ObjectAttribute)),n=e.filter((e=>e.type===w.ObjectMethod));return[...t.map((e=>e.id)),...n.map((e=>e.id))]}}class Le extends J{constructor(e){super(e),this.type=x.UseCaseActor,this.bounds={...this.bounds,width:90,height:140},q(this,e)}render(e){return[this]}}class Re extends ue{constructor(){super(...arguments),this.type=x.UseCaseSystem}}Re.features={...he.features,connectable:!1};class Ne extends J{constructor(){super(...arguments),this.type=x.UseCase}render(e){return this.bounds=oe(this,e),[this]}}class Be extends Me{constructor(){super(...arguments),this.type=b.DeploymentInterface}}Be.supportedRelationships=[v.DeploymentInterfaceProvided,v.DeploymentInterfaceRequired];class Oe extends J{constructor(e){super(e),this.type=S.PetriNetTransition,this.bounds={...this.bounds},this.bounds.height=e&&e.bounds&&e.bounds.height||Oe.defaultHeight,this.bounds.width=e&&e.bounds&&e.bounds.width||Oe.defaultWidth}render(e){return this.bounds.height=Math.max(this.bounds.height,Oe.defaultHeight),this.bounds.width=Math.max(this.bounds.width,Oe.defaultWidth),[this]}}Oe.features={...J.features},Oe.defaultWidth=20,Oe.defaultHeight=60;class $e extends J{constructor(e){super(e),this.highlight=void 0,this.type=S.PetriNetPlace,this.bounds={...this.bounds,width:60,height:60},q(this,e),this.amountOfTokens=e?.amountOfTokens||0===e?.amountOfTokens?e.amountOfTokens:0,this.capacity=e?.capacity||0===e?.capacity?e.capacity:$e.defaultCapacity}serialize(e){return{...super.serialize(),type:this.type,amountOfTokens:this.amountOfTokens,capacity:isFinite(this.capacity)?this.capacity:this.capacity.toString()}}deserialize(e,t){e.type===S.PetriNetPlace&&(super.deserialize(e,t),this.amountOfTokens=e.amountOfTokens,this.capacity=e.capacity===Number.POSITIVE_INFINITY.toString()?Number.POSITIVE_INFINITY:e.capacity)}render(e){return[this]}}$e.features={...J.features,resizable:!1},$e.defaultCapacity=Number.POSITIVE_INFINITY;class Ue extends J{constructor(e){super(e),this.type=O.ReachabilityGraphMarking,this.isInitialMarking=e?.isInitialMarking||!1}serialize(e){return{...super.serialize(),type:this.type,isInitialMarking:this.isInitialMarking}}deserialize(e,t){e.type===O.ReachabilityGraphMarking&&(super.deserialize(e,t),this.isInitialMarking=e.isInitialMarking)}render(e){return this.bounds=oe(this,e),[this]}}class Fe extends J{constructor(e){super(e),this.type=P.CommunicationLinkMessage,this.direction=e?.direction||"target"}render(e){return[this]}}class ze extends ue{constructor(){super(...arguments),this.stereotype="component",this.displayStereotype=!0}}class He extends ze{constructor(e){super(),this.type=b.DeploymentComponent,q(this,e)}serialize(){return{...super.serialize(),type:this.type,displayStereotype:this.displayStereotype}}deserialize(e,t){e.type===b.DeploymentComponent&&(super.deserialize(e,t),this.displayStereotype=e.displayStereotype)}}He.supportedRelationships=[v.DeploymentAssociation,v.DeploymentDependency,v.DeploymentInterfaceProvided,v.DeploymentInterfaceRequired];class je extends ze{constructor(e){super(),this.type=C.Component,q(this,e)}serialize(){return{...super.serialize(),type:this.type,displayStereotype:this.displayStereotype}}deserialize(e,t){e.type===C.Component&&(super.deserialize(e,t),this.displayStereotype=e.displayStereotype)}}je.supportedRelationships=[E.ComponentDependency,E.ComponentInterfaceProvided,E.ComponentInterfaceRequired];class Qe extends ue{constructor(e){super(),this.stereotype="subsystem",this.displayStereotype=!0,this.type=C.Subsystem,q(this,e)}serialize(){return{...super.serialize(),type:this.type,stereotype:this.stereotype,displayStereotype:this.displayStereotype}}deserialize(e,t){e.type===C.Subsystem&&(super.deserialize(e,t),this.stereotype=e.stereotype,this.displayStereotype=e.displayStereotype)}}Qe.supportedRelationships=[E.ComponentDependency,E.ComponentInterfaceProvided,E.ComponentInterfaceRequired];class We extends J{constructor(){super(...arguments),this.type=A.SyntaxTreeTerminal}render(e){return this.bounds=oe(this,e),[this]}}class Ge extends J{constructor(){super(...arguments),this.type=A.SyntaxTreeNonterminal}render(e){return this.bounds=oe(this,e),[this]}}class qe extends J{constructor(){super(...arguments),this.type=R.FlowchartTerminal}render(e){return this.bounds=oe(this,e),[this]}}class _e extends J{constructor(){super(...arguments),this.type=R.FlowchartFunctionCall}render(e){return this.bounds=oe(this,e),[this]}}class Ve extends J{constructor(){super(...arguments),this.type=R.FlowchartDecision}render(e){return this.bounds=oe(this,e),[this]}}class Ye extends J{constructor(){super(...arguments),this.type=R.FlowchartProcess}render(e){return this.bounds=oe(this,e),[this]}}class Ze extends J{constructor(){super(...arguments),this.type=R.FlowchartInputOutput}render(e){return this.bounds=oe(this,e),[this]}}class Xe extends J{constructor(e){super(e&&!e.bounds?{...e,bounds:{x:0,y:0,width:160,height:50}}:e),this.type=B.ColorLegend}render(e){return[this]}}class Ke extends he{constructor(e){super(e),this.type=U.BPMNTask,q(this,e),this.taskType=e?.taskType||Ke.defaultTaskType,this.marker=e?.marker||Ke.defaultMarker}serialize(e){return{...super.serialize(),type:this.type,taskType:this.taskType,marker:this.marker}}deserialize(e,t){super.deserialize(e,t),this.taskType=e.taskType||Ke.defaultTaskType,this.marker=e.marker||Ke.defaultMarker}render(e){return[this]}}Ke.defaultTaskType="default",Ke.defaultMarker="none";class Je extends he{constructor(){super(...arguments),this.type=U.BPMNSubprocess}render(e){return this.bounds=oe(this,e),[this]}}class et extends he{constructor(e){super(e),this.type=U.BPMNStartEvent,this.bounds={...this.bounds,width:40,height:40},q(this,e),this.eventType=e?.eventType||et.defaultEventType}serialize(e){return{...super.serialize(),type:this.type,eventType:this.eventType}}deserialize(e,t){super.deserialize(e,t),this.eventType=e.eventType||et.defaultEventType}render(e){return[this]}}et.supportedRelationships=[F.BPMNFlow],et.features={...he.features,resizable:!1},et.defaultEventType="default";class tt extends he{constructor(e){super(e),this.type=U.BPMNIntermediateEvent,this.bounds={...this.bounds,width:40,height:40},q(this,e),this.eventType=e?.eventType||tt.defaultEventType}serialize(e){return{...super.serialize(),type:this.type,eventType:this.eventType}}deserialize(e,t){super.deserialize(e,t),this.eventType=e.eventType||tt.defaultEventType}render(e){return[this]}}tt.supportedRelationships=[F.BPMNFlow],tt.features={...he.features,resizable:!1},tt.defaultEventType="default";class nt extends he{constructor(e){super(e),this.type=U.BPMNEndEvent,this.bounds={...this.bounds,width:40,height:40},q(this,e),this.eventType=e?.eventType||nt.defaultEventType}serialize(e){return{...super.serialize(),type:this.type,eventType:this.eventType}}deserialize(e,t){super.deserialize(e,t),this.eventType=e.eventType||nt.defaultEventType}render(e){return[this]}}nt.supportedRelationships=[F.BPMNFlow],nt.features={...he.features,resizable:!1},nt.defaultEventType="default";class ot extends he{constructor(e){super(e),this.type=U.BPMNGateway,this.bounds={...this.bounds,width:40,height:40},q(this,e),this.gatewayType=e?.gatewayType||ot.defaultGatewayType}serialize(e){return{...super.serialize(),type:this.type,gatewayType:this.gatewayType}}deserialize(e,t){super.deserialize(e,t),this.gatewayType=e.gatewayType||ot.defaultGatewayType}render(e){return[this]}}ot.features={...he.features,resizable:!1},ot.defaultGatewayType="exclusive";class st extends he{constructor(){super(...arguments),this.type=U.BPMNTransaction}render(e){return[this]}}class it extends he{constructor(){super(...arguments),this.type=U.BPMNCallActivity}render(e){return[this]}}class rt extends he{constructor(){super(...arguments),this.type=U.BPMNAnnotation}render(e){return[this]}}rt.features={...he.features};class at extends he{constructor(){super(...arguments),this.type=U.BPMNDataObject}render(e){return[this]}}at.features={...he.features,resizable:!1};class lt extends ue{constructor(){super(...arguments),this.type=U.BPMNPool,this.hasSwimlanes=e=>e.length>0&&e.every((e=>e.type===U.BPMNSwimlane))}render(e,t=[],n){this.bounds.width<lt.MIN_WIDTH&&(this.bounds.width=lt.MIN_WIDTH);const o=this.hasSwimlanes(t);if(!o)return[this,...t];const s=t.reduce(((e,t)=>e+t.bounds.height),0),i=t.reverse().map(((e,n)=>(e.type!==U.BPMNSwimlane||(e.bounds.x=lt.HEADER_WIDTH,e.bounds.y=n>0?t[n-1].bounds.y+t[n-1].bounds.height:0,e.bounds.width=this.bounds.width-lt.HEADER_WIDTH,e.resizeFrom=Z.BOTTOMRIGHT),e)));return o&&(this.bounds.height=s<lt.MIN_HEIGHT?lt.MIN_HEIGHT:s),[this,...i]}}lt.MIN_WIDTH=80,lt.MIN_HEIGHT=80,lt.HEADER_WIDTH=40,lt.features={...J.features,droppable:!0,movable:!0,resizable:!0,connectable:!0};class ct extends he{constructor(){super(...arguments),this.type=U.BPMNSwimlane}render(e,t=[]){return this.bounds.height<ct.MIN_HEIGHT&&(this.bounds.height=ct.MIN_HEIGHT),[this,...t]}}ct.DEFAULT_HEIGHT=80,ct.MIN_HEIGHT=80,ct.features={...J.features,droppable:!0,movable:!1,connectable:!1,updatable:!1,resizable:"HEIGHT"};class dt extends ue{constructor(){super(...arguments),this.type=U.BPMNGroup}render(e,t=[]){return[this,...t]}}dt.features={...ue.features,connectable:!1};class ht extends he{constructor(){super(...arguments),this.type=U.BPMNDataStore}render(e){return[this]}}ht.features={...he.features,resizable:!1};const ut={[z.Package]:ve,[z.Class]:we,[z.AbstractClass]:Ce,[z.Interface]:xe,[z.Enumeration]:ke,[z.ClassAttribute]:Ee,[z.ClassMethod]:be,[z.ObjectName]:Ae,[z.ObjectAttribute]:Pe,[z.ObjectMethod]:De,[z.Activity]:pe,[z.ActivityInitialNode]:le,[z.ActivityFinalNode]:ie,[z.ActivityActionNode]:se,[z.ActivityObjectNode]:de,[z.ActivityForkNode]:re,[z.ActivityForkNodeHorizontal]:ae,[z.ActivityMergeNode]:ce,[z.UseCase]:Ne,[z.UseCaseActor]:Le,[z.UseCaseSystem]:Re,[z.Component]:je,[z.Subsystem]:Qe,[z.ComponentInterface]:Se,[z.DeploymentNode]:Te,[z.DeploymentComponent]:He,[z.DeploymentArtifact]:Ie,[z.DeploymentInterface]:Be,[z.PetriNetPlace]:$e,[z.PetriNetTransition]:Oe,[z.ReachabilityGraphMarking]:Ue,[z.CommunicationLinkMessage]:Fe,[z.SyntaxTreeTerminal]:We,[z.SyntaxTreeNonterminal]:Ge,[z.FlowchartTerminal]:qe,[z.FlowchartFunctionCall]:_e,[z.FlowchartProcess]:Ye,[z.FlowchartDecision]:Ve,[z.FlowchartInputOutput]:Ze,[z.ColorLegend]:Xe,[z.BPMNTask]:Ke,[z.BPMNSubprocess]:Je,[z.BPMNTransaction]:st,[z.BPMNCallActivity]:it,[z.BPMNAnnotation]:rt,[z.BPMNStartEvent]:et,[z.BPMNIntermediateEvent]:tt,[z.BPMNEndEvent]:nt,[z.BPMNGateway]:ot,[z.BPMNDataObject]:at,[z.BPMNDataStore]:ht,[z.BPMNPool]:lt,[z.BPMNSwimlane]:ct,[z.BPMNGroup]:dt},pt={...f,...k,...g,...M,...T,...E,...v,...I,...$,...L,...N,...F},mt={[D.ClassDiagram]:f.ClassBidirectional,[D.ObjectDiagram]:k.ObjectLink,[D.ActivityDiagram]:g.ActivityControlFlow,[D.UseCaseDiagram]:M.UseCaseAssociation,[D.CommunicationDiagram]:T.CommunicationLink,[D.ComponentDiagram]:E.ComponentInterfaceProvided,[D.DeploymentDiagram]:v.DeploymentAssociation,[D.PetriNet]:I.PetriNetArc,[D.ReachabilityGraph]:$.ReachabilityGraphArc,[D.SyntaxTree]:L.SyntaxTreeLink,[D.Flowchart]:N.FlowchartFlowline,[D.BPMN]:F.BPMNFlow};var gt;!function(e){e[e.Collinear=0]="Collinear",e[e.Clockwise=1]="Clockwise",e[e.CounterClockwise=2]="CounterClockwise"}(gt||(gt={}));class yt{static computePath(e,t,n){const o=K(e.element)[e.direction].add(e.element.bounds.x,e.element.bounds.y),s=K(t.element)[t.direction].add(t.element.bounds.x,t.element.bounds.y);if(n.isStraight)return o.x===s.x&&o.y===s.y&&(s.x+=1,s.y+=1),[o,s];if(n.isVariable){const n=yt.tryFindStraightPath(e,t);if(null!==n)return n[0].x===n[1].x&&n[0].y===n[1].y&&(n[1].x+=1,n[1].y+=1),n}const i=40,r=Nt(e.element.bounds,i),a=Nt(t.element.bounds,i),l=Nt(e.element.bounds,39),c=Nt(t.element.bounds,39);let d=o.clone();switch(e.direction){case Y.Up:case Y.Topright:case Y.Topleft:d=d.add(0,-40);break;case Y.Right:case Y.Upright:case Y.Downright:d=d.add(i,0);break;case Y.Down:case Y.Bottomright:case Y.Bottomleft:d=d.add(0,i);break;case Y.Left:case Y.Upleft:case Y.Downleft:d=d.add(-40,0)}let h=s.clone();switch(t.direction){case Y.Up:case Y.Topright:case Y.Topleft:h=h.add(0,-40);break;case Y.Right:case Y.Upright:case Y.Downright:h=h.add(i,0);break;case Y.Down:case Y.Bottomright:case Y.Bottomleft:h=h.add(0,i);break;case Y.Left:case Y.Upleft:case Y.Downleft:h=h.add(-40,0)}const u=ft(Pt(r),h),p=ft(Pt(a),u),m=Bt(r,e.direction,d,u),g=Bt(a,t.direction,h,p),y=[o,d],f=[s,h];let C={...d},E={...h};for(;;){if(!Ot(C,E,l)&&!Ot(C,E,c)){const e=Ht(y.slice(-2)),t=Ht(f.slice(-2));if("HORIZONTAL"===e&&"HORIZONTAL"===t){const e=(C.x+E.x)/2;y.push({x:e,y:C.y},{x:e,y:E.y})}else if("VERTICAL"===e&&"VERTICAL"===t){const e=(C.y+E.y)/2;y.push({x:C.x,y:e},{x:E.x,y:e})}else"HORIZONTAL"===e&&"VERTICAL"===t?y.push({x:E.x,y:C.y}):y.push({x:C.x,y:E.y});break}const e=m.shift();if(void 0!==e)y.push(e),C=e;else{const e=g.shift();if(void 0===e)return[o,d,h,s];f.push(e),E=e}}const b=f.reverse();return(v=[...y,...b]).length<=1||(v=bt(v=function(e){if(e.length<4)return e;const t=Mt(kt(e));return xt(e[0],t)}(v=function(e){const t=kt(e);if(t.length<=1)return e;const n=[];for(const e of t){const t=n[n.length-1];t&&(0===t.dx&&0===e.dx||0===t.dy&&0===e.dy)?n[n.length-1]={dx:t.dx+e.dx,dy:t.dy+e.dy}:n.push(e)}return xt(e[0],n)}(v=function(e){const t=[];for(const n of e){const e=t[t.length-1];e&&Tt(n,e)||t.push(n)}return t}(v))))),v;var v}static tryFindStraightPath(e,t){const n=40,o=jt(e.direction),s=jt(t.direction);if(o===Y.Right&&s===Y.Left&&t.element.bounds.x>=e.element.bounds.x+e.element.bounds.width){const o=zt([e.element.bounds.y,e.element.bounds.y+Math.max(n,e.element.bounds.height)],[t.element.bounds.y,t.element.bounds.y+Math.max(n,t.element.bounds.height)]);if(null!==o&&o[1]-o[0]>=n){const n=(o[0]+o[1])/2;return[{x:e.element.bounds.x+e.element.bounds.width,y:n},{x:t.element.bounds.x,y:n}]}}if(o===Y.Left&&s===Y.Right&&e.element.bounds.x>=t.element.bounds.x+t.element.bounds.width){const o=zt([e.element.bounds.y,e.element.bounds.y+Math.max(n,e.element.bounds.height)],[t.element.bounds.y,t.element.bounds.y+Math.max(n,t.element.bounds.height)]);if(null!==o&&o[1]-o[0]>=n){const n=(o[0]+o[1])/2;return[{x:e.element.bounds.x,y:n},{x:t.element.bounds.x+t.element.bounds.width,y:n}]}}if(o===Y.Down&&s===Y.Up&&t.element.bounds.y>=e.element.bounds.y+e.element.bounds.height){const o=zt([e.element.bounds.x,e.element.bounds.x+e.element.bounds.width],[t.element.bounds.x,t.element.bounds.x+t.element.bounds.width]);if(null!==o&&o[1]-o[0]>=n){const n=(o[0]+o[1])/2;return[{x:n,y:e.element.bounds.y+e.element.bounds.height},{x:n,y:t.element.bounds.y}]}}if(o===Y.Up&&s===Y.Down&&e.element.bounds.y>=t.element.bounds.y+t.element.bounds.height){const o=zt([e.element.bounds.x,e.element.bounds.x+e.element.bounds.width],[t.element.bounds.x,t.element.bounds.x+t.element.bounds.width]);if(null!==o&&o[1]-o[0]>=n){const n=(o[0]+o[1])/2;return[{x:n,y:e.element.bounds.y},{x:n,y:t.element.bounds.y+t.element.bounds.height}]}}return null}}function ft(e,t){let n=1/0,o=e[0];for(const s of e){const e=Ct(t,s);e<n&&(n=e,o=s)}return o}function Ct(e,t){const n=Math.abs(e.x-t.x),o=Math.abs(e.y-t.y);return Math.sqrt(n**2+o**2)}function Et(e){let t=0;for(let n=1;n<e.length;n++)t+=Ct(e[n],e[n-1]);return t}function bt(e){for(let t=0;t<e.length-2;t++){const n=e[t],o=e[t+1],s=e[t+2];if(vt(n,o,s)||wt(n,o,s))return bt([...e.slice(0,t+1),...e.slice(t+2)])}return e}function vt(e,t,n){return It(e.y,t.y)&&It(t.y,n.y)&&(e.x>=t.x&&t.x>=n.x||e.x<=t.x&&t.x<=n.x)}function wt(e,t,n){return It(e.x,t.x)&&It(t.x,n.x)&&(e.y<=t.y&&t.y<=n.y||e.y>=t.y&&t.y>=n.y)}function kt(e){const t=[];for(let n=0;n<e.length-1;n++){const o=e[n],s=e[n+1],i=s.x-o.x,r=s.y-o.y;t.push({dx:i,dy:r})}return t}function xt(e,t){const n=[e];let o=e;for(const{dx:e,dy:s}of t)o={x:o.x+e,y:o.y+s},n.push(o);return n}function Mt(e){for(let t=0;t<e.length-3;t++){const n=e[t],o=e[t+1],s=e[t+2],i=e[t+3];if(0===n.dy&&0===o.dx&&0===s.dy&&Math.sign(n.dx)===Math.sign(s.dx)&&Math.sign(o.dy)===Math.sign(i.dy))return Mt([...e.slice(0,t),{dx:n.dx+s.dx,dy:0},{dx:0,dy:o.dy},...e.slice(t+3)]);if(0===n.dx&&0===o.dy&&0===s.dx&&Math.sign(n.dy)===Math.sign(s.dy)&&Math.sign(o.dx)===Math.sign(i.dx))return Mt([...e.slice(0,t),{dx:0,dy:n.dy+s.dy},{dx:o.dx,dy:0},...e.slice(t+3)])}return e}function St(e){return Math.abs(e)<1e-6}function It(e,t){return St(e-t)}function Tt(e,t){const n=Math.abs(e.x-t.x),o=Math.abs(e.y-t.y);return St(n)&&St(o)}function Pt(e){return[Dt(e),At(e),Rt(e),Lt(e)]}function Dt(e){return{x:e.x,y:e.y}}function At(e){return{x:e.x+e.width,y:e.y}}function Lt(e){return{x:e.x,y:e.y+e.height}}function Rt(e){return{x:e.x+e.width,y:e.y+e.height}}function Nt(e,t){return{x:e.x-t,y:e.y-t,width:e.width+2*t,height:e.height+2*t}}function Bt(e,t,n,o){let s,i;const r=Dt(e),a=At(e),l=Lt(e),c=Rt(e);switch(t){case Y.Up:case Y.Topright:case Y.Topleft:s=[a,c,l,r],i=[r,l,c,a];break;case Y.Right:case Y.Upright:case Y.Downright:s=[c,l,r,a],i=[a,r,l,c];break;case Y.Down:case Y.Bottomright:case Y.Bottomleft:s=[l,r,a,c],i=[c,a,r,l];break;case Y.Left:case Y.Upleft:case Y.Downleft:s=[r,a,c,l],i=[l,c,a,r];break;default:throw Error("Unreachable code")}if(null!==o){for(let e=0;e<4;e++)if(Tt(s[e],o)){s=s.slice(0,e+1);break}for(let e=0;e<4;e++)if(Tt(i[e],o)){i=i.slice(0,e+1);break}}return Et([n,...s])<Et([n,...i])?s:i}function Ot(e,t,n){if(function(e,t,n){return e.x>n.x&&e.x<n.x+n.height&&e.y>n.y&&e.y<n.y+n.height}(e,0,n))return!0;const o=Dt(n),s=At(n),i=Lt(n),r=Rt(n);return $t(e,t,o,s)||$t(e,t,s,r)||$t(e,t,o,i)||$t(e,t,i,r)}function $t(e,t,n,o){const s=Ut(e,t,n),i=Ut(e,t,o),r=Ut(n,o,e),a=Ut(n,o,t);return s!==i&&r!==a||!(s!==gt.Collinear||!Ft(e,n,t))||!(i!==gt.Collinear||!Ft(e,o,t))||!(r!==gt.Collinear||!Ft(n,e,o))||!(a!==gt.Collinear||!Ft(n,t,o))}function Ut(e,t,n){const o=(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y);return St(o)?gt.Collinear:o>0?gt.Clockwise:gt.CounterClockwise}function Ft(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function zt(e,t){const[n,o]=e,[s,i]=t,r=Math.max(n,s),a=Math.min(o,i);return r<=a?[r,a]:null}function Ht(e){const[t,n]=e,o=n.x-t.x,s=n.y-t.y;return 0===o&&0!==s?"VERTICAL":0!==o&&0===s?"HORIZONTAL":null}function jt(e){switch(e){case Y.Left:case Y.Upleft:case Y.Downleft:return Y.Left;case Y.Right:case Y.Upright:case Y.Downright:return Y.Right;case Y.Down:case Y.Bottomleft:case Y.Bottomright:return Y.Down;case Y.Up:case Y.Topleft:case Y.Topright:return Y.Up}}class Qt extends J{constructor(e){super(),this.path=[{x:0,y:0},{x:200,y:100}],this.source={direction:Y.Up,element:""},this.target={direction:Y.Up,element:""},q(this,e)}serialize(){return{...super.serialize(),type:this.type,path:this.path,source:this.source,target:this.target,isManuallyLayouted:this.isManuallyLayouted}}deserialize(e,t){e.type in pt&&(super.deserialize(e),this.type=e.type,this.path=e.path,this.source=e.source,this.target=e.target,this.isManuallyLayouted=e.isManuallyLayouted)}render(e,t,n){if(!t||!n)return[this];const{straight:o,variable:s}=this.constructor.features,i=yt.computePath({element:t,direction:this.source.direction},{element:n,direction:this.target.direction},{isStraight:o,isVariable:s}),r=Math.min(...i.map((e=>e.x))),a=Math.min(...i.map((e=>e.y))),l=Math.max(Math.max(...i.map((e=>e.x)))-r,1),c=Math.max(Math.max(...i.map((e=>e.y)))-a,1);return this.bounds={x:r,y:a,width:l,height:c},this.path=i.map((e=>({x:e.x-r,y:e.y-a}))),[this]}cloneRelationship(e){return new(0,this.constructor)({...this,...e,id:V()})}}Qt.features={connectable:!1,droppable:!1,hoverable:!0,movable:!1,reconnectable:!0,resizable:!1,selectable:!0,updatable:!0,straight:!1,variable:!0,alternativePortVisualization:!1},Qt.isUMLRelationship=e=>e.type in pt;class Wt extends he{constructor(e){super(),this.type=D.ClassDiagram,this.ownedRelationships=[],this.bounds={...this.bounds,width:0,height:0},q(this,e)}render(e,t=[]){const n=t.reduce(((e,t)=>({width:Math.max(Math.abs(t.bounds.x),Math.abs(t.bounds.x+t.bounds.width),e.width),height:Math.max(Math.abs(t.bounds.y),Math.abs(t.bounds.y+t.bounds.height),e.height)})),{width:0,height:0});return this.bounds={x:-n.width-40,y:-n.height-40,width:2*n.width+40,height:2*n.height+40},[this]}}class Gt extends Qt{render(e,t,n){if(super.render(e,t,n),this.name){const t=this.bounds;let n=new _(0,0),o="v";const s=this.path.map((e=>new _(e.x,e.y)));let i=s.reduce(((e,t,n,o)=>n+1<o.length?e+o[n+1].subtract(t).length:e),0)/2;for(let e=0;e<s.length-1;e++){const t=s[e+1].subtract(s[e]);if(t.length>i){const r=t.normalize();o=Math.abs(r.x)>Math.abs(r.y)?"h":"v",n=s[e].add(r.scale(i));break}i-=t.length}n=n.add(t.x,t.y);const r=ne.size(e,this.name),a={bounds:{x:"v"===o?n.x+5:n.x-r.width/2,y:n.y-40,width:r.width,height:r.height}};this.bounds=ee([this,a]);const l=t.x-this.bounds.x,c=t.y-this.bounds.y;this.path.forEach((e=>{e.x+=l,e.y+=c}))}return[this]}}var qt=n(2568);const _t=qt.Ay,Vt=qt.AH,Yt={color:{primary:"var(--apollon-primary, #2a8fbd)",secondary:"var(--apollon-secondary, #6c757d)",warningYellow:"var(--apollon-warning-yellow, #ffc800)",background:"var(--apollon-background, #ffffff)",backgroundVariant:"var(--apollon-background-variant, #e5e5e5)",grid:"var(--apollon-grid, rgba(36, 39, 36, 0.1))",primaryContrast:"var(--apollon-primary-contrast, #212529)",gray:"var(--apollon-gray, #e9ecef)",grayAccent:"var(--apollon-gray-variant, #343a40)"},font:{color:"var(--apollon-primary-contrast, #212529)",family:"Helvetica Neue, Helvetica, Arial, sans-serif",size:16},interactive:{normal:"rgba(0, 220, 0, 0.3)",hovered:"rgba(0, 220, 0, 0.15)"}},Zt=()=>Yt,Xt=_t.polyline.attrs((e=>({fillColor:e.fillColor,strokeColor:e.strokeColor,stroke:e.strokeColor||"black",fill:e.fillColor||"white"})))`
  fill: ${e=>e.fillColor||e.theme.color.background};
  stroke: ${e=>e.strokeColor||e.theme.color.primaryContrast};
`,Kt=_t.path.attrs((e=>({fillColor:e.fillColor,strokeColor:e.strokeColor,stroke:e.strokeColor||"black",fill:e.fillColor||"white"})))`
  fill: ${e=>e.fillColor||e.theme.color.background};
  stroke: ${e=>e.strokeColor||e.theme.color.primaryContrast};
`,Jt=_t.path.attrs((e=>({fillColor:e.fillColor,strokeColor:e.strokeColor,stroke:e.strokeColor||"white",fill:e.fillColor||"black"})))`
  fill: ${e=>e.fillColor||e.theme.color.primaryContrast};
  stroke: ${e=>e.strokeColor||e.theme.color.background};
`,en=_t.rect.attrs((e=>({fillColor:e.fillColor,strokeColor:e.strokeColor,stroke:e.strokeColor||"black",fill:e.fillColor||"white"})))`
  fill: ${e=>e.fillColor||e.theme.color.background};
  stroke: ${e=>e.strokeColor||e.theme.color.primaryContrast};
`,tn=_t.rect.attrs((e=>({fillColor:e.fillColor,strokeColor:e.strokeColor,stroke:e.strokeColor||"white",fill:e.fillColor||"black"})))`
  fill: ${e=>e.fillColor||e.theme.color.primaryContrast};
  stroke: ${e=>e.strokeColor||e.theme.color.background};
`,nn=_t.circle.attrs((e=>({fillColor:e.fillColor,strokeColor:e.strokeColor,stroke:e.strokeColor||"black",fill:e.fillColor||"white"})))`
  fill: ${e=>e.fillColor||e.theme.color.background};
  stroke: ${e=>e.strokeColor||e.theme.color.primaryContrast};
`,on=_t.circle.attrs((e=>({fillColor:e.fillColor,strokeColor:e.strokeColor,stroke:e.strokeColor||"white",fill:e.fillColor||"black"})))`
  fill: ${e=>e.fillColor||e.theme.color.primaryContrast};
  stroke: ${e=>e.strokeColor||e.theme.color.background};
`,sn=_t.ellipse.attrs((e=>({fillColor:e.fillColor,strokeColor:e.strokeColor,stroke:e.strokeColor||"black",fill:e.fillColor||"white"})))`
  fill: ${e=>e.fillColor||e.theme.color.background};
  stroke: ${e=>e.strokeColor||e.theme.color.primaryContrast};
`,rn=_t.line.attrs((e=>({strokeColor:e.strokeColor,stroke:e.strokeColor||"black"})))`
  stroke: ${e=>e.strokeColor||e.theme.color.primaryContrast};
`,an=(e,t)=>W.createElement("marker",{id:e,viewBox:"0 0 30 30",markerWidth:22,markerHeight:30,refX:30,refY:15,orient:"auto",markerUnits:"strokeWidth"},W.createElement(Kt,{d:"M0,29 L30,15 L0,1",fillColor:"none",strokeColor:t})),ln=(e,t)=>W.createElement("marker",{id:e,viewBox:"0 0 30 30",markerWidth:"30",markerHeight:"30",refX:"30",refY:"15",orient:"auto",markerUnits:"strokeWidth"},W.createElement(Kt,{d:"M0,15 L15,22 L30,15 L15,8 z",fillColor:t,strokeColor:t})),cn=(e,t)=>W.createElement("marker",{id:e,viewBox:"0 0 30 30",markerWidth:"30",markerHeight:"30",refX:"30",refY:"15",orient:"auto",markerUnits:"strokeWidth"},W.createElement(Jt,{d:"M0,15 L15,22 L30,15 L15,8 z",fillColor:t})),dn=(e,t)=>W.createElement("marker",{id:e,viewBox:"0 0 30 30",markerWidth:"22",markerHeight:"30",refX:"30",refY:"15",orient:"auto",markerUnits:"strokeWidth"},W.createElement(Kt,{d:"M0,1 L0,29 L30,15 z",strokeColor:t})),hn=(e,t)=>{switch(e){case Y.Up:case Y.Topright:case Y.Topleft:return{dx:"TOP"===t?-5:5,textAnchor:"TOP"===t?"end":"start"};case Y.Right:case Y.Upright:case Y.Downright:return{dy:"TOP"===t?-10:21,textAnchor:"start"};case Y.Down:case Y.Bottomright:case Y.Bottomleft:return{dx:"TOP"===t?-5:5,dy:10,textAnchor:"TOP"===t?"end":"start"};case Y.Left:case Y.Upleft:case Y.Downleft:return{dy:"TOP"===t?-10:21,textAnchor:"end"}}},un=(e,t=!1)=>{const n=t?31:8;if(e.length<2)return new _;const o=e[1].subtract(e[0]);return e[0].add(o.normalize().scale(n))},pn=e=>(e=>{switch(e){case f.ClassDependency:case f.ClassUnidirectional:return an;case f.ClassAggregation:return ln;case f.ClassComposition:return cn;case f.ClassInheritance:case f.ClassRealization:return dn}})(e),mn=({element:e})=>{const t=pn(e.type),n=(e=>{switch(e){case f.ClassDependency:case f.ClassRealization:return 7}})(e.type),o=e.path.map((e=>new _(e.x,e.y))),s=un(o),i=un(o.reverse(),!!t),r=`marker-${e.id}`,a=e.textColor?{fill:e.textColor}:{};return W.createElement("g",null,t&&t(r,e.strokeColor),W.createElement(Xt,{points:e.path.map((e=>`${e.x} ${e.y}`)).join(","),strokeColor:e.strokeColor,fillColor:"none",strokeWidth:1,markerEnd:`url(#${r})`,strokeDasharray:n}),W.createElement("text",{x:s.x||0,y:s.y||0,...hn(e.source.direction,"BOTTOM"),pointerEvents:"none",style:{...a}},e.source.multiplicity),W.createElement("text",{x:i.x||0,y:i.y||0,...hn(e.target.direction,"BOTTOM"),pointerEvents:"none",style:{...a}},e.target.multiplicity),W.createElement("text",{x:s.x||0,y:s.y||0,...hn(e.source.direction,"TOP"),pointerEvents:"none",style:{...a}},e.source.role),W.createElement("text",{x:i.x||0,y:i.y||0,...hn(e.target.direction,"TOP"),pointerEvents:"none",style:{...a}},e.target.role))},gn=(e,t,n,o)=>{const s=ne.size(e,n,{textAnchor:o.textAnchor});return{bounds:{x:t.x+("end"===o.textAnchor?-s.width:0)+(o.dx?o.dx:0),y:t.y+(o.dy?o.dy:0),width:s.width,height:s.height}}};class yn extends Qt{constructor(e){super(),this.source={direction:Y.Up,element:"",multiplicity:"",role:""},this.target={direction:Y.Up,element:"",multiplicity:"",role:""},q(this,e)}render(e,t,n){super.render(e,t,n);const o=this.bounds,s=hn(this.source.direction,"BOTTOM"),i=hn(this.target.direction,"BOTTOM"),r=hn(this.source.direction,"TOP"),a=hn(this.target.direction,"TOP"),l=pn(this.type),c=this.path.map((e=>new _(e.x,e.y))),d=un(c).add(this.bounds.x,this.bounds.y),h=un(c.reverse(),!!l).add(this.bounds.x,this.bounds.y),u=[gn(e,d,this.source.multiplicity,s),gn(e,h,this.target.multiplicity,i),gn(e,d,this.source.role,r),gn(e,h,this.target.role,a)];this.bounds=ee([this,...u]);const p=o.x-this.bounds.x,m=o.y-this.bounds.y;return this.path.forEach((e=>{e.x+=p,e.y+=m})),[this]}}class fn extends Qt{}class Cn extends Qt{}Cn.features={...Qt.features,variable:!1};var En;!function(e){e.Semicircle="M 13 -13.5 a 1 1 0 0 0 0 27",e.Threequarterscircle="M 8 -12.5 C -3.5 -7.5 -3.3 7.9 8 12.5",e.Quartercircle="M 2 -7.8 C -1.5 -3 -1.2 3.4 2 7.8"}(En||(En={}));class bn extends Qt{render(e,t,n){super.render(e,t,n);const o=this.bounds,s=this.path[this.path.length-1],i=new _(this.bounds.x,this.bounds.y).add(s.x,s.y),r={bounds:{x:i.x-Math.floor(13.5),y:i.y-Math.floor(13.5),width:27,height:27}};this.bounds=ee([this,r]);const a=o.x-this.bounds.x,l=o.y-this.bounds.y;return this.path.forEach((e=>{e.x+=a,e.y+=l})),[this]}}bn.features={...Qt.features,variable:!1},bn.isUMLInterfaceRequired=e=>bn.isUMLRelationship(e)&&(e.type===v.DeploymentInterfaceRequired||e.type===E.ComponentInterfaceRequired);class vn extends Qt{constructor(){super(...arguments),this.type=M.UseCaseAssociation}}vn.features={...Qt.features,straight:!0};class wn extends Qt{constructor(){super(...arguments),this.type=M.UseCaseExtend}}wn.features={...Qt.features,straight:!0};class kn extends Qt{constructor(){super(...arguments),this.type=M.UseCaseGeneralization}}kn.features={...Qt.features,straight:!0};class xn extends Qt{constructor(){super(...arguments),this.type=M.UseCaseInclude}}xn.features={...Qt.features,straight:!0};class Mn extends Qt{constructor(e){super(e),this.type=I.PetriNetArc,this.name=Mn.defaultMultiplicity,this.name=e&&e.name||this.name}}Mn.features={...Qt.features,straight:!0},Mn.defaultMultiplicity="1";class Sn extends Gt{constructor(e){super(e),this.type=$.ReachabilityGraphArc,this.name=Sn.transition,this.name=e&&e.name||this.name}}Sn.features={...Qt.features},Sn.transition="t";class In extends Qt{constructor(){super(...arguments),this.type=L.SyntaxTreeLink}}In.features={...Qt.features,straight:!0};class Tn extends Gt{constructor(e){super(e),this.type=F.BPMNFlow,this.name="",this.name=e?.name||this.name,this.flowType=e?.flowType||Tn.defaultFlowType}serialize(e){return{...super.serialize(),type:this.type,flowType:this.flowType}}deserialize(e,t){super.deserialize(e,t),this.flowType=e.flowType||Tn.defaultFlowType}}Tn.features={...Qt.features},Tn.defaultFlowType="sequence";const Pn={[pt.ClassAggregation]:class extends yn{constructor(){super(...arguments),this.type=f.ClassAggregation}},[pt.ClassBidirectional]:class extends yn{constructor(){super(...arguments),this.type=f.ClassBidirectional}},[pt.ClassComposition]:class extends yn{constructor(){super(...arguments),this.type=f.ClassComposition}},[pt.ClassDependency]:class extends yn{constructor(){super(...arguments),this.type=f.ClassDependency}},[pt.ClassInheritance]:class extends yn{constructor(){super(...arguments),this.type=f.ClassInheritance}},[pt.ClassRealization]:class extends yn{constructor(){super(...arguments),this.type=f.ClassRealization}},[pt.ClassUnidirectional]:class extends yn{constructor(){super(...arguments),this.type=f.ClassUnidirectional}},[pt.ObjectLink]:class extends Qt{constructor(){super(...arguments),this.type=k.ObjectLink}},[pt.ActivityControlFlow]:class extends Gt{constructor(){super(...arguments),this.type=g.ActivityControlFlow}},[pt.UseCaseAssociation]:vn,[pt.UseCaseExtend]:wn,[pt.UseCaseGeneralization]:kn,[pt.UseCaseInclude]:xn,[pt.CommunicationLink]:class extends Qt{constructor(e){super(),this.type=T.CommunicationLink,this.messages=[],q(this,e)}serialize(){return{...super.serialize(),messages:this.messages.reduce(((e,t)=>({...e,[t.id]:t})),{})}}deserialize(e,t){e.type===T.CommunicationLink&&(super.deserialize(e,t),this.messages=Object.values(e.messages).map((e=>new Fe(e))))}render(e,t,n){super.render(e,t,n);const o=this.bounds,s=this.path.map((e=>new _(e.x,e.y)));let i,r,a=s.reduce(((e,t,n,o)=>n+1<o.length?e+o[n+1].subtract(t).length:e),0)/2;for(let e=0;e<s.length-1;e++){const t=s[e+1].subtract(s[e]);if(t.length>a){const n=t.normalize();i=Math.abs(n.x)>Math.abs(n.y)?n.x>0?Y.Left:Y.Right:n.y>0?Y.Up:Y.Down,r=s[e].add(n.scale(a));break}a-=t.length}if(!i||!r)throw Error(`Could not determine direction or messagePosition for CommunicationLink. \n MessagePosition: ${r} \n Direction: ${i}`);r=r.add(o.x,o.y);const l=this.messages.filter((e=>"source"===e.direction)),c=this.messages.filter((e=>"target"===e.direction)),d=[{bounds:o}];if(l&&l.length>0){const t=this.computeBoundingBoxForMessages(e,r,l,i);d.push({bounds:t})}const h=X(i);if(c&&c.length>0){const t=this.computeBoundingBoxForMessages(e,r,c,h);d.push({bounds:t})}this.bounds=ee(d);const u=o.x-this.bounds.x,p=o.y-this.bounds.y;return this.path.forEach((e=>{e.x+=u,e.y+=p})),this.messages.forEach((e=>{e.bounds.x+=u-o.x,e.bounds.y+=p-o.y})),[this]}computeBoundingBoxForMessages(e,t,n,o){const s=ne.size(e,"",{fontWeight:"bold",fontSize:"120%"});let i=o===Y.Left?t.y-s.height:o===Y.Right?t.y+ne.size(e,n[0].name).height+s.height:t.y;const r=o===Y.Up?t.x+s.width:o===Y.Down?t.x-s.width:t.x;for(const t of n){const n=ne.size(e,t.name);o===Y.Right?(t.bounds.x=r-n.width/2,t.bounds.y=i,t.bounds.width=n.width,t.bounds.height=n.height,i+=n.height):o===Y.Down?(t.bounds.x=r-n.width,t.bounds.y=i,t.bounds.width=n.width,t.bounds.height=n.height,i+=n.height):o===Y.Up?(t.bounds.x=r,t.bounds.y=i,t.bounds.width=n.width,t.bounds.height=n.height,i+=n.height):o===Y.Left&&(t.bounds.x=r-n.width/2,t.bounds.y=i,t.bounds.width=n.width,t.bounds.height=n.height,i-=n.height)}return ee(n)}},[pt.ComponentDependency]:class extends fn{constructor(){super(...arguments),this.type=E.ComponentDependency}},[pt.ComponentInterfaceProvided]:class extends Cn{constructor(){super(...arguments),this.type=E.ComponentInterfaceProvided}},[pt.ComponentInterfaceRequired]:class extends bn{constructor(){super(...arguments),this.type=E.ComponentInterfaceRequired}},[pt.DeploymentAssociation]:class extends Gt{constructor(){super(...arguments),this.type=v.DeploymentAssociation}},[pt.DeploymentDependency]:class extends fn{constructor(){super(...arguments),this.type=v.DeploymentDependency}},[pt.DeploymentInterfaceProvided]:class extends Cn{constructor(){super(...arguments),this.type=v.DeploymentInterfaceProvided}},[pt.DeploymentInterfaceRequired]:class extends bn{constructor(){super(...arguments),this.type=v.DeploymentInterfaceRequired}},[pt.PetriNetArc]:Mn,[pt.ReachabilityGraphArc]:Sn,[pt.SyntaxTreeLink]:In,[pt.FlowchartFlowline]:class extends Qt{constructor(){super(...arguments),this.type=N.FlowchartFlowline}},[pt.BPMNFlow]:Tn};function Dn(e,t){const n=o=>e.includes(o.id)?[o.id]:he.isUMLContainer(o)?o.ownedElements.reduce(((e,o)=>[...e,...n(t[o])]),[]):[];return Object.values(t).filter((e=>!e.owner)).reduce(((e,t)=>[...e,...n(t)]),[])}function An(e,t){const n=[];for(const o of e){const e=t[o];e&&(he.isUMLContainer(e)&&n.push(...An(e.ownedElements,t)),n.push(e.id))}return n}function Ln(e,t){if(!he.isUMLContainer(e))return[e.clone()];const n=[],o=e.clone(),{ownedElements:s}=e;for(const e of s){const s=t.find((t=>t.id===e));if(!s)continue;const[i,...r]=Ln(s,t);i.owner=o.id;const a=o.ownedElements.findIndex((t=>t===e));o.ownedElements[a]=i.id,n.push(i,...r)}return[o,...n]}var Rn;!function(e){e.APPEND="@@element/diagram/APPEND",e.BRING_TO_FRONT="@@element/diagram/BRING_TO_FRONT"}(Rn||(Rn={}));const Nn={isUMLDiagram:e=>e.type in D,get:e=>e&&Nn.isUMLDiagram(e)?new Wt(e):null,append:e=>(t,n)=>{t({type:Rn.APPEND,payload:{ids:Array.isArray(e)?e:[e]},undoable:!1})},bringToFront:e=>(t,n)=>{const o=(Array.isArray(e)?e:[e]).filter((e=>n().diagram.ownedElements.includes(e)));t({type:Rn.BRING_TO_FRONT,payload:{ids:o},undoable:!1})}};var Bn;!function(e){e.APPEND="@@element/container/APPEND",e.REMOVE="@@element/container/REMOVE"}(Bn||(Bn={}));const On={get:e=>e?Nn.isUMLDiagram(e)?Nn.get(e):he.isUMLContainer(e)?new(0,ut[e.type])(e):null:null,append:(e,t)=>(n,o)=>{const s=Array.isArray(e)?e:[e],{elements:i,diagram:r}=o(),a=s.filter((e=>Qt.isUMLRelationship(i[e])));a.length&&n({type:Rn.APPEND,payload:{ids:a},undoable:!1});const l=s.filter((e=>J.isUMLElement(i[e])));l.length&&n({type:Bn.APPEND,payload:{ids:l,owner:t||r.id},undoable:!1})},remove:e=>({type:Bn.REMOVE,payload:{ids:Array.isArray(e)?e:[e]},undoable:!0})};var $n;!function(e){e.CREATE="@@element/CREATE",e.UPDATE="@@element/UPDATE",e.DELETE="@@element/DELETE"}($n||($n={}));const Un={create:(e,t)=>async n=>{const o=Array.isArray(e)?e:[e];n({type:$n.CREATE,payload:{values:o},undoable:!0});const s=o.filter((e=>!e.owner)).map((e=>e.id));s.length&&n(On.append(s,t))},get:e=>e&&J.isUMLElement(e)?new(0,ut[e.type])(e):null,getById:e=>(t,n)=>{const{elements:o}=n();return Un.get(o[e])},update:(e,t)=>({type:$n.UPDATE,payload:{values:(Array.isArray(e)?e:[e]).map((e=>({id:e,...t})))},undoable:!1}),delete:e=>(t,n)=>{const{elements:o,selected:s}=n(),i=Dn(e?Array.isArray(e)?e:[e]:s,o);i.length&&(t(On.remove(i)),t({type:$n.DELETE,payload:{ids:An(i,o)},undoable:!1}))},getAbsolutePosition:e=>(t,n)=>{const{elements:o}=n();let s=o[e],i=new _(s.bounds.x,s.bounds.y);for(;s.owner;)s=o[s.owner],i=i.add(s.bounds.x,s.bounds.y);return i},getChildren:e=>(t,n)=>{const{elements:o}=n(),s=o[e];return s?he.isUMLContainer(s)?s.ownedElements.reduce(((e,n)=>[...e,...t(Un.getChildren(n))]),[s]):[s]:[]}};var Fn,zn,Hn;!function(e){e.START="@@element/connectable/START",e.END="@@element/connectable/END"}(Fn||(Fn={})),function(e){e.START="@@element/reconnectable/START",e.END="@@element/reconnectable/END",e.RECONNECT="@@element/reconnectable/RECONNECT"}(zn||(zn={})),function(e){e.LAYOUT="@@relationship/LAYOUT",e.WAYPOINTLAYOUT="@@relationship/WAYPOINTLAYOUT",e.STARTWAYPOINTSLAYOUT="@@relationship/waypoints/START",e.ENDWAYPOINTSLAYOUT="@@relationship/waypoints/END"}(Hn||(Hn={}));const jn={get:e=>e&&Qt.isUMLRelationship(e)?new(0,Pn[e.type])(e):null,getById:e=>(t,n)=>{const{elements:o}=n();return jn.get(o[e])},getSupportedConnectionsForElements:e=>{const t=Array.isArray(e)?e:[e];return t.length>0?t.reduce(((e,t)=>{const n=ut[t.type].supportedRelationships;return e.filter((e=>n.includes(e)))}),ut[t[0].type].supportedRelationships):[]},layout:(e,t,n)=>({type:Hn.LAYOUT,payload:{id:e,path:t,bounds:n},undoable:!1}),layoutWaypoints:(e,t,n)=>({type:Hn.WAYPOINTLAYOUT,payload:{id:e,path:t,bounds:n},undoable:!1}),flip:e=>(t,n)=>{const{selected:o,elements:s}=n(),i=(e?Array.isArray(e)?e:[e]:o).map((e=>{const t=s[e],n={element:t.target.element,direction:t.target.direction},o={element:t.source.element,direction:t.source.direction};return{id:t.id,source:n,target:o}}));t({type:zn.RECONNECT,payload:{connections:i},undoable:!0})},startWaypointsLayout:(e,t,n)=>o=>{const s=e?Array.isArray(e)?e:[e]:void 0;s&&!s.length||o({type:Hn.STARTWAYPOINTSLAYOUT,payload:{id:e,path:t,bounds:n},undoable:!1})},endWaypointsLayout:e=>t=>{e.length&&t({type:Hn.ENDWAYPOINTSLAYOUT,payload:{id:e},undoable:!1})}},Qn={startConnecting:(e,t)=>(n,o)=>{const s=t?Array.isArray(t)?t:[t]:o().selected.map((e=>n(Un.getById(e)))).filter((e=>null!==e)).filter((e=>ut[e.type].features.connectable)).map((e=>e.id)),i=Array.isArray(e)?e:[e];if(!s.length||1!==i.length&&i.length!==s.length)return;const r=s.map(((e,t)=>({element:e,direction:1===i.length?i[0]:i[t]})));n({type:Fn.START,payload:{ports:r},undoable:!1})},connect:(e,t)=>(n,o)=>{const s=t?Array.isArray(t)?t:[t]:o().connecting,i=Array.isArray(e)?e:[e];if(!i.length||1!==i.length&&i.length!==s.length)return;const r=[];for(const[e,t]of s.entries()){const n=1===i.length?i[0]:i[e];t.element===n.element&&t.direction===n.direction||r.push({source:t,target:n})}const a=r.map((e=>{const t=n(Un.getById(e.source.element)),s=n(Un.getById(e.target.element));let i;if(t&&s){const e=jn.getSupportedConnectionsForElements([t,s]);i=e.length>0?e[0]:mt[o().diagram.type]}else i=mt[o().diagram.type];return new(0,Pn[i])(e)}));r.length&&n(Un.create(a)),t||n({type:Fn.END,payload:{ports:s},undoable:!1})},endConnecting:e=>(t,n)=>{const o=e?Array.isArray(e)?e:[e]:n().connecting;o.length&&t({type:Fn.END,payload:{ports:o},undoable:!1})}};var Wn;!function(e){e.HOVER="@@element/hoverable/HOVER",e.LEAVE="@@element/hoverable/LEAVE"}(Wn||(Wn={}));const Gn={hover:e=>({type:Wn.HOVER,payload:{ids:Array.isArray(e)?e:[e]},undoable:!1}),leave:e=>({type:Wn.LEAVE,payload:{ids:Array.isArray(e)?e:[e]},undoable:!1})};var qn;!function(e){e.SELECT="@@element/interactable/SELECT",e.DESELECT="@@element/interactable/DESELECT"}(qn||(qn={}));const _n={makeInteractive:e=>({type:qn.SELECT,payload:{ids:[e]},undoable:!1}),unmakeInteractive:e=>({type:qn.DESELECT,payload:{ids:[e]},undoable:!1})};var Vn,Yn;!function(e){e.START="@@element/movable/START",e.END="@@element/movable/END"}(Vn||(Vn={})),function(e){e.MOVE="@@element/movable/MOVE"}(Yn||(Yn={}));const Zn={startMoving:e=>(t,n)=>{const{elements:o,selected:s}=n(),i=e?Array.isArray(e)?e:[e]:Dn(s,o),r=[],a={...ut,...Pn};for(const e of i)a[o[e].type].features.movable&&r.push(e);r.length&&(t(Nn.bringToFront(i)),t({type:Vn.START,payload:{ids:r},undoable:!0}))},move:(e,t)=>(n,o)=>{const s=t?Array.isArray(t)?t:[t]:o().moving;s.length&&n({type:Yn.MOVE,payload:{ids:s,delta:e},undoable:!1})},endMoving:(e,t=!1)=>(n,o)=>{const s=e?Array.isArray(e)?e:[e]:o().moving;s.length&&n({type:Vn.END,payload:{ids:s,keyboard:t},undoable:!1})}};var Xn,Kn;!function(e){e.START="@@element/resizable/START",e.END="@@element/resizable/END"}(Xn||(Xn={})),function(e){e.RESIZE="@@element/resizable/RESIZE"}(Kn||(Kn={}));const Jn={startResizing:e=>(t,n)=>{const o=e?Array.isArray(e)?e:[e]:[];o.length&&t({type:Xn.START,payload:{ids:o},undoable:!0})},resize:(e,t,n)=>(o,s)=>{const i=n?Array.isArray(n)?n:[n]:[];i.length&&o({type:Kn.RESIZE,payload:{ids:i,delta:e,resizeFrom:t},undoable:!1})},endResizing:e=>(t,n)=>{const o=e?Array.isArray(e)?e:[e]:[];o.length&&t({type:Xn.END,payload:{ids:o},undoable:!1})}};var eo,to,no,oo,so;!function(e){e.SELECT="@@element/selectable/SELECT",e.DESELECT="@@element/selectable/DESELECT"}(eo||(eo={})),function(e){e.en="en",e.de="de"}(to||(to={})),function(e){e.Modelling="Modelling",e.Exporting="Exporting",e.Assessment="Assessment"}(no||(no={})),function(e){e.Modelling="Modelling",e.Exporting="Exporting",e.Highlight="Highlight"}(oo||(oo={})),function(e){e.CHANGE_VIEW="@@element/CHANGE_VIEW",e.SET_ZOOM_FACTOR="@@element/SET_ZOOM_FACTOR",e.SET_SELECTION_BOX="@@element/SET_SELECTION_BOX_ACTIVE"}(so||(so={}));const io={select:(e,t)=>(n,o)=>{const s=e?Array.isArray(e)?e:[e]:Object.keys(o().elements);return s.length||n({type:so.SET_SELECTION_BOX,payload:{selectionBoxActive:!1},undoable:!1}),n({type:eo.SELECT,payload:{ids:s,overwrite:t},undoable:!1})},deselect:e=>(t,n)=>{const o=e?Array.isArray(e)?e:[e]:n().selected;if(o.length)return t({type:eo.DESELECT,payload:{ids:o},undoable:!1})}};var ro,ao;!function(e){e.SELECTION_CHANGE="@@element/remote-selection/CHANGE",e.PRUNE_SELECTORS="@@element/remote-selection/PRUNE_SELECTORS"}(ro||(ro={})),function(e){e.SELECT="@@element/remote-selection/SELECT",e.DESELECT="@@element/remote-selection/DESELECT"}(ao||(ao={}));const lo={remoteSelectionChange:(e,t)=>({type:ro.SELECTION_CHANGE,payload:{selector:e,changes:t},undoable:!1}),remoteSelect:(e,t)=>lo.remoteSelectionChange(e,t.map((e=>({type:ao.SELECT,id:e})))),remoteDeselect:(e,t)=>lo.remoteSelectionChange(e,t.map((e=>({type:ao.DESELECT,id:e})))),remoteSelectDeselect:(e,t,n)=>lo.remoteSelectionChange(e,[...t.map((e=>({type:ao.SELECT,id:e}))),...n.map((e=>({type:ao.DESELECT,id:e})))]),pruneRemoteSelectors:e=>({type:ro.PRUNE_SELECTORS,payload:{allowedSelectors:e},undoable:!1})};var co;!function(e){e.START="@@element/updatable/START",e.END="@@element/updatable/END",e.ENDALL="@@element/updatable/ENDALL"}(co||(co={}));const ho={updateStart:e=>(t,n)=>{if(n().updating.length)return null;t({type:co.START,payload:{ids:Array.isArray(e)?e:[e]},undoable:!0})},updateEnd:e=>({type:co.END,payload:{ids:Array.isArray(e)?e:[e]},undoable:!1}),updateEndAll:()=>({type:co.ENDALL,payload:{},undoable:!1})},uo={...Un,...Gn,...io,...lo,...Zn,...Jn,...Qn,..._n,...ho};function po(e){return null!=e}const mo={startReconnecting:(e,t)=>(n,o)=>{const s=t?Array.isArray(t)?t:[t]:o().selected.map((e=>n(jn.getById(e)))).filter((e=>null!==e&&Qt.isUMLRelationship(e))).map((e=>e.id));s.length&&n({type:zn.START,payload:{ids:s,endpoint:e},undoable:!0})},reconnect:e=>(t,n)=>{const{reconnecting:o,elements:s}=n(),i=Object.keys(o).map((t=>{const n=s[t],i=o[t],r="source"===i?"target":"source",a={[i]:n[i],[r]:{...n[r],...e}};return a.source.element===a.target.element&&a.source.direction===a.target.direction?null:{id:t,...a}})).filter(po);i.length&&t({type:zn.RECONNECT,payload:{connections:i},undoable:!1})},endReconnecting:e=>(t,n)=>{const o=e?Array.isArray(e)?e:[e]:Object.keys(n().reconnecting);o.length&&t({type:zn.END,payload:{ids:o},undoable:!1})}},go={...jn,...mo};function yo(e){return e.version.startsWith("2.")}function fo(e){return e.type===pt.CommunicationLink}function Co(e){return fo(e)?{...e,messages:e.messages.reduce(((e,t)=>({...e,[t.id]:t})),{})}:e}function Eo(e){return Object.entries(e).filter((([,e])=>e)).map((([e])=>e))}function bo(e){return e.reduce(((e,t)=>({...e,[t]:!0})),{})}class vo{static fromModel(e){const t=function(e){return yo(e)?function(e){const t=Array.isArray(e.elements)?e.elements:[],n=Array.isArray(e.relationships)?e.relationships:[],o=Array.isArray(e.assessments)?e.assessments:[],s=e.interactive||{elements:[],relationships:[]};return{...e,version:"3.0.0",elements:t.reduce(((e,t)=>({...e,[t.id]:t})),{}),relationships:n.map(Co).reduce(((e,t)=>({...e,[t.id]:t})),{}),assessments:o.reduce(((e,t)=>({...e,[t.modelElementId]:t})),{}),interactive:{elements:s.elements.reduce(((e,t)=>({...e,[t]:!0})),{}),relationships:s.relationships.reduce(((e,t)=>({...e,[t]:!0})),{})}}}(e):e}(e),n=t.elements,o=t.relationships,s=e=>{const t=new ut[e.type],o=he.isUMLContainer(t)?Object.values(n).filter((t=>t.owner===e.id)).map((e=>{const t=n[e.owner];return{...e,bounds:{...e.bounds,x:e.bounds.x-t.bounds.x,y:e.bounds.y-t.bounds.y}}})):[];return t.deserialize(e,o),[t,...o.reduce(((e,t)=>[...e,...s(t)]),[])]},i=Object.values(n).filter((e=>!e.owner)).reduce(((e,t)=>[...e,...s(t)]),[]),r=Object.values(o).map((e=>{const t=new Pn[e.type];return t.deserialize(e),t})),a=new Wt;return a.type=t.type,a.ownedRelationships=Object.values(t.relationships).map((e=>e.id)),{diagram:a,interactive:[...Eo(t.interactive.elements),...Eo(t.interactive.relationships)],elements:[...i,...r].reduce(((e,t)=>({...e,[t.id]:{...t}})),{}),assessments:(Object.values(t.assessments)||[]).reduce(((e,t)=>({...e,[t.modelElementId]:{score:t.score,feedback:t.feedback,label:t.label,labelColor:t.labelColor,correctionStatus:t.correctionStatus,dropInfo:t.dropInfo}})),{})}}static toModel(e){const t=Object.values(e.elements).map((e=>uo.get(e))).reduce(((e,t)=>({...e,...t&&{[t.id]:t}})),{}),n=Object.values(e.elements).filter((e=>Qt.isUMLRelationship(e))).map((e=>go.get(e))),o=e=>{const n=he.isUMLContainer(e)?e.ownedElements.map((e=>t[e])):[],s={[e.id]:e.serialize(n)};for(const t of n){const n=o(t);Object.values(n).forEach((t=>{t.bounds.x+=e.bounds.x,t.bounds.y+=e.bounds.y})),Object.assign(s,n)}return s},s=Object.values(t).filter((e=>!e.owner)).reduce(((e,t)=>({...e,...o(t)})),{}),i=(Object.values(s),n.map((e=>e.serialize()))),r={elements:bo(e.interactive.filter((t=>J.isUMLElement(e.elements[t])))),relationships:bo(e.interactive.filter((t=>Qt.isUMLRelationship(e.elements[t]))))},a=Object.fromEntries(Object.entries(e.assessments).map((([t,n])=>[t,{modelElementId:t,elementType:e.elements[t].type,score:e.assessments[t].score,feedback:e.assessments[t].feedback,label:e.assessments[t].label,labelColor:e.assessments[t].labelColor,correctionStatus:e.assessments[t].correctionStatus,dropInfo:e.assessments[t].dropInfo}])));return{version:"3.0.0",type:e.diagram.type,size:{width:e.diagram.bounds.width,height:e.diagram.bounds.height},interactive:r,elements:s,relationships:Object.fromEntries(i.map((e=>[e.id,e]))),assessments:a}}}var wo=n(9733),ko=n(961);const{Consumer:xo,Provider:Mo}=W.createContext({onDragStart:e=>new Promise(((e,t)=>t())),onDragEnd:e=>e=>{}});function So(e){return function(t){return W.createElement(xo,null,(n=>W.createElement(e,{...t,...n})))}}const Io=So;class To extends W.Component{componentDidMount(){(0,ko.findDOMNode)(this).addEventListener("pointerup",this.props.onDragEnd(this.props.owner))}componentWillUnmount(){(0,ko.findDOMNode)(this).removeEventListener("pointerup",this.props.onDragEnd(this.props.owner))}render(){return this.props.children}}const Po=Io(To);var Do=n(1829);const{Consumer:Ao,Provider:Lo}=(0,W.createContext)(null),Ro=e=>(0,W.forwardRef)(((t,n)=>W.createElement(Ao,null,(o=>W.createElement(e,{ref:n,...t,...o}))))),No=(0,wo.Ng)(((e,t)=>({ports:K(uo.get(e.elements[t.port.element]))})),{end:uo.endConnecting,getAbsolutePosition:uo.getAbsolutePosition}),Bo=_t.polyline`
  stroke: ${e=>e.theme.color.primaryContrast};
  fill: 'none';
  pointer-events: 'none';
`;class Oo extends W.Component{render(){const{port:e,ports:t}=this.props,{x:n,y:o}=this.props.getAbsolutePosition(e.element),s={...t[e.direction]},i=[new _(n+s.x,o+s.y),this.props.target].map((e=>`${e.x} ${e.y}`)).join(", ");return W.createElement(Bo,{points:i,"pointer-events":"none",stroke:"black",fill:"none",strokeDasharray:"5,5"})}}const $o=No(Oo);var Uo=n(5574),Fo=n.n(Uo);const zo=(0,Do.Zz)(Ro,(0,wo.Ng)((e=>({connecting:[...e.connecting,...Object.keys(e.reconnecting).map((t=>e.elements[t][e.reconnecting[t]]))],zoomFactor:e.editor.zoomFactor})),{endConnecting:uo.endConnecting,endReconnecting:go.endReconnecting})),Ho={position:null};class jo extends W.Component{constructor(){super(...arguments),this.state=Ho,this.onPointerMove=e=>{const{zoomFactor:t=1}=this.props,n=this.props.canvas.origin();let o;o=e instanceof PointerEvent?new _(e.clientX-n.x,e.clientY-n.y).scale(1/t):new _(e.targetTouches[0].clientX-n.x,e.targetTouches[0].clientY-n.y).scale(1/t),this.setState({position:o})},this.onPointerUp=e=>{Fo()({tablet:!0})?document.removeEventListener("touchend",this.onPointerMove):document.removeEventListener("pointermove",this.onPointerMove),this.setState(Ho),this.props.endConnecting(),this.props.endReconnecting()}}componentDidUpdate(e){this.props.connecting.length&&e.connecting!==this.props.connecting&&(Fo()({tablet:!0})?(document.addEventListener("touchmove",this.onPointerMove),document.addEventListener("touchend",this.onPointerUp,{once:!0})):(document.addEventListener("pointermove",this.onPointerMove),document.addEventListener("pointerup",this.onPointerUp,{once:!0})))}componentWillUnmount(){Fo()({tablet:!0})?(document.removeEventListener("touchmove",this.onPointerMove),document.removeEventListener("touchend",this.onPointerUp)):(document.removeEventListener("pointermove",this.onPointerMove),document.removeEventListener("pointerup",this.onPointerUp))}render(){const{connecting:e}=this.props,{position:t}=this.state;return e.length&&t?e.map(((e,n)=>W.createElement($o,{key:n,port:e,target:t}))):null}}const Qo=zo(jo);class Wo{constructor(e=[new _,new _]){this.path=e}get length(){return this.path.map((e=>new _(e.x,e.y))).reduce(((e,t,n,o)=>n+1<o.length?e+o[n+1].subtract(t).length:e),0)}position(e=0){for(let t=0;t<this.path.length-1;t++){const n=new _(this.path[t+1].x,this.path[t+1].y),o=new _(this.path[t].x,this.path[t].y),s=n.subtract(o);if(s.length>e){const t=s.normalize();return o.add(t.scale(e))}e-=s.length}return new _}}const Go=_t.svg`
  height: 1em;
  vertical-align: middle;
  width: 1em;
`,qo=e=>W.createElement(Go,{width:"16px",height:"16px",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",...e}),_o=e=>W.createElement(qo,{viewBox:"0 0 192 512",...e},W.createElement("path",{d:"M176 432c0 44.112-35.888 80-80 80s-80-35.888-80-80 35.888-80 80-80 80 35.888 80 80zM25.26 25.199l13.6 272C39.499 309.972 50.041 320 62.83 320h66.34c12.789 0 23.331-10.028 23.97-22.801l13.6-272C167.425 11.49 156.496 0 142.77 0H49.23C35.504 0 24.575 11.49 25.26 25.199z"})),Vo=_t.circle.attrs((e=>({r:16,fillOpacity:.8,fill:e.theme.color.gray})))``,Yo=_t.polygon.attrs((e=>({points:"-10,8 0,-10 10,8",fill:e.theme.color.warningYellow})))``,Zo={x:-12,y:-12,width:24,height:24},Xo=_t((e=>W.createElement(qo,{viewBox:"0 0 512 512",...e},W.createElement("path",{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"})))).attrs(Zo)`
  fill: green;
`,Ko=_t((e=>W.createElement(qo,{viewBox:"0 0 352 512",...e},W.createElement("path",{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"})))).attrs(Zo)`
  fill: red;
`,Jo=_t(_o).attrs(Zo)`
  fill: blue;
`,es=_t(_o).attrs({x:-6,y:-5,width:12,height:12})`
  fill: black;
`;var ts;!function(e){e.ASSESS="@@element/ASSESS",e.DELETE="@@assessment/DELETE"}(ts||(ts={}));class ns{}ns.assess=(e,t,n)=>{const o={...t};return"DROPPED"!==n&&o.dropInfo&&delete o.dropInfo,{type:ts.ASSESS,payload:{element:e,assessment:o},undoable:!1}},ns.delete=e=>({type:ts.DELETE,payload:{element:e},undoable:!1}),ns.getById=e=>t=>e[t]||null;const os=(0,wo.Ng)(((e,t)=>{const n=e.elements[t.id];return{assessment:e.assessments[t.id],bounds:n.bounds,path:Qt.isUMLRelationship(n)?n.path:void 0,readonly:e.editor.readonly}}),{select:uo.select,deselect:uo.deselect,assess:ns.assess,updateStart:uo.updateStart}),ss=e=>{class t extends W.Component{constructor(){super(...arguments),this.onDragOver=e=>{e.preventDefault(),e.stopPropagation(),this.props.select(this.props.id)},this.onDragLeave=()=>{this.props.deselect(this.props.id)},this.onDrop=e=>{if(e.preventDefault(),this.props.deselect(this.props.id),e.stopPropagation(),e.dataTransfer){const t=e.dataTransfer.getData("text/plain");if(!t)return void console.warn("Could not get artemis sgi element from drop element");let n;try{n=JSON.parse(t)}catch(e){return void console.error("Could not parse artemis sgi",e)}const o="Do you want to remove the link to the assessment instruction?",s="Assessment Instruction: "+n.instructionDescription,i="This feedback is associated with the assessment instruction. You can provide additional feedback for this submission element. Student will see combined feedback during the review.",{id:r,assessment:a}=this.props,l=n.credits,c={instruction:n,removeMessage:o,tooltipMessage:s,feedbackHint:i};this.props.assess(r,{...a,score:l,dropInfo:c},"DROPPED"),this.props.updateStart(r)}}}componentDidMount(){if(!this.props.readonly){const e=(0,ko.findDOMNode)(this);e.addEventListener("dragover",this.onDragOver.bind(this)),e.addEventListener("dragleave",this.onDragLeave.bind(this)),e.addEventListener("drop",this.onDrop.bind(this))}}componentWillUnmount(){const e=(0,ko.findDOMNode)(this);e.removeEventListener("dragover",this.onDragOver),e.removeEventListener("dragleave",this.onDragLeave),e.removeEventListener("drop",this.onDrop)}render(){const{assessment:t,assess:n,select:o,deselect:s,updateStart:i,bounds:r,path:a,readonly:l,...c}=this.props;let d,h;if(a){const e=new Wo(a);d=e.position(e.length/2),h=e.position(e.length/2-48)}else d=new _(r.width,0),h=new _(d.x-48,d.y);return W.createElement(e,{...c},t&&t.correctionStatus&&"INCORRECT"===t.correctionStatus.status&&W.createElement("g",{transform:`translate(${h.x} ${h.y})`,pointerEvents:"none"},W.createElement(W.Fragment,null,W.createElement(Vo,null),W.createElement(Yo,null),W.createElement(es,null))),t&&W.createElement("g",{transform:`translate(${d.x} ${d.y})`,pointerEvents:"none"},0===t.score&&!!t.feedback&&W.createElement(W.Fragment,null,W.createElement(Vo,null),W.createElement(Jo,null)),t.score>0&&W.createElement(W.Fragment,null,W.createElement(Vo,null),W.createElement(Xo,null)),t.score<0&&W.createElement(W.Fragment,null,W.createElement(Vo,null),W.createElement(Ko,null))))}}return os(t)},is=({children:e,fill:t,x:n="50%",y:o="50%",dominantBaseline:s="middle",textAnchor:i="middle",fontWeight:r="bold",pointerEvents:a="none",noX:l=!1,noY:c=!1,...d})=>{const h={};return l||(h.x=n),c||(h.y=o),W.createElement("text",{...h,style:t?{fill:t}:{},dominantBaseline:s,textAnchor:i,fontWeight:r,pointerEvents:a,...d},e)},rs=({element:e,children:t,fillColor:n})=>W.createElement("g",null,W.createElement(en,{fillColor:n||e.fillColor,strokeColor:"none",width:"100%",height:e.stereotype?50:40}),W.createElement(en,{y:e.stereotype?50:40,width:"100%",height:e.bounds.height-(e.stereotype?50:40),strokeColor:"none"}),e.stereotype?W.createElement("svg",{height:50},W.createElement(is,{fill:e.textColor},W.createElement("tspan",{x:"50%",dy:-8,textAnchor:"middle",fontSize:"85%"},`${e.stereotype}`),W.createElement("tspan",{x:"50%",dy:18,textAnchor:"middle",fontStyle:e.italic?"italic":void 0,textDecoration:e.underline?"underline":void 0},e.name))):W.createElement("svg",{height:40},W.createElement(is,{fill:e.textColor,fontStyle:e.italic?"italic":void 0,textDecoration:e.underline?"underline":void 0},e.name)),t,W.createElement(en,{width:"100%",height:"100%",strokeColor:e.strokeColor,fillColor:"none","pointer-events":"none"}),e.hasAttributes&&W.createElement(Kt,{d:`M 0 ${e.headerHeight} H ${e.bounds.width}`,strokeColor:e.strokeColor}),e.hasMethods&&W.createElement(Kt,{d:`M 0 ${e.deviderPosition} H ${e.bounds.width}`,strokeColor:e.strokeColor})),as=({element:e,fillColor:t})=>W.createElement("g",null,W.createElement(en,{fillColor:t||e.fillColor,strokeColor:"none",width:"100%",height:"100%"}),W.createElement(is,{x:10,fill:e.textColor,fontWeight:"normal",textAnchor:"start"},e.name)),ls=Object.freeze({x:0,y:0,dx:0,dy:0,angle:0,width:void 0,height:void 0,lineHeight:16,capHeight:11,scaleToFit:!1,textAnchor:"middle",verticalAnchor:"middle"});class cs extends W.Component{constructor(){var e;super(...arguments),this.state={wordsByLines:[{words:(e=this.props).children?e.children.toString().split(/\s+/):[],width:0}]},this.spaceWidth=0,this.wordsWithComputedWidth=[],this.shouldCalculateWidth=e=>e.children!==this.props.children||e.style!==this.props.style||e.width!==this.props.width||e.height!==this.props.height,this.calculateWordWidths=e=>{try{return{wordsWithComputedWidth:(e.children?e.children.toString().split(/\s+/):[]).map((t=>({word:t,width:this.getStringWidth(t,e.style)}))),spaceWidth:this.getStringWidth("",e.style)}}catch(e){return null}}}componentDidMount(){this.updateWordsByLines(this.props,!0)}componentDidUpdate(e){const t=this.shouldCalculateWidth(e);t&&this.updateWordsByLines(this.props,t)}getStringWidth(e,t){try{const n=document.createElement("div");return n.innerHTML=e,Object.assign(n.style,t),this.calculateStringWidth(n,(e=>e.clientWidth+2))}catch(e){return 0}}calculateStringWidth(e,t){e.style.visibility="hidden",e.style.position="absolute",document.body.appendChild(e);const n=t(e);return e.parentNode.removeChild(e),n}updateWordsByLines(e,t){if(e.width||e.scaleToFit){if(t){const t=this.calculateWordWidths(e);if(!t)return void this.updateWordsWithoutCalculate(e);{const{wordsWithComputedWidth:e,spaceWidth:n}=t;this.wordsWithComputedWidth=e,this.spaceWidth=n}}const n=this.calculateWordsByLines(this.wordsWithComputedWidth,this.spaceWidth,e.width);this.setState({wordsByLines:n})}else this.updateWordsWithoutCalculate(e)}updateWordsWithoutCalculate(e){const t=e.children?e.children.toString().split(/\s+/):[];this.setState({wordsByLines:[{words:t,width:0}]})}calculateWordsByLines(e,t,n){const{scaleToFit:o}=this.props;return e.reduce(((e,{word:s,width:i})=>{const r=e[e.length-1];if(r&&(!n||o||r.width+i+t<n))r.words.push(s),r.width+=i+t;else{const t={words:[s],width:i};e.push(t)}return e}),[])}render(){const{x:e,y:t,dx:n,dy:o,textAnchor:s,verticalAnchor:i,scaleToFit:r,angle:a,lineHeight:l,capHeight:c,fill:d,...h}=this.props,{wordsByLines:u}=this.state,p=e+n,m=t+o;let g;switch(i){case"start":g=c;break;case"middle":g=(u.length-1)/2*-l+c/2;break;default:g=u.length-1*-l}const y=[];if(r&&u.length){const e=u[0].width,t=(this.props.width||0)/e,n=t,o=p-t*p,s=m-n*m;y.push(`matrix(${t}, 0, 0, ${n}, ${o}, ${s})`)}return a&&y.push(`rotate(${a}, ${p}, ${m})`),y.length&&(h.transform=y.join(" ")),W.createElement("text",{style:d?{fill:d}:{},x:p,y:m,textAnchor:s,...h,pointerEvents:"none"},u.map(((e,t)=>W.createElement("tspan",{x:p,dy:0===t?g:l,key:t},e.words.join(" ")))))}}cs.defaultProps=ls;const ds=(0,Do.Zz)(qt.SL,(0,wo.Ng)(((e,t)=>({interactive:e.interactive.includes(t.element.id),interactable:e.editor.view===oo.Exporting||e.editor.view===oo.Highlight}))))((({element:e,interactive:t,interactable:n,theme:o})=>W.createElement("g",null,W.createElement(nn,{cx:"50%",cy:"50%",r:Math.min(e.bounds.width,e.bounds.height)/2-2.5,strokeColor:n&&t?o.interactive.normal:e.fillColor,strokeWidth:5}),W.createElement(on,{cx:"50%",cy:"50%",r:Math.min(e.bounds.width,e.bounds.height)/2-7.5,strokeColor:"none",fillColor:t&&n?o.interactive.normal:e.fillColor,fillOpacity:1})))),hs=(0,Do.Zz)(qt.SL,(0,wo.Ng)(((e,t)=>({interactive:e.interactive.includes(t.element.id),interactable:e.editor.view===oo.Exporting||e.editor.view===oo.Highlight}))))((({element:e,interactive:t,interactable:n,theme:o})=>W.createElement("g",null,W.createElement(tn,{width:e.bounds.width,height:e.bounds.height,strokeColor:"none",fillColor:t&&n?o.interactive.normal:e.fillColor,fillOpacity:1})))),us=(0,Do.Zz)(qt.SL,(0,wo.Ng)(((e,t)=>({interactive:e.interactive.includes(t.element.id),interactable:e.editor.view===oo.Exporting||e.editor.view===oo.Highlight}))))((({element:e,interactive:t,interactable:n,theme:o})=>W.createElement("g",null,W.createElement(tn,{width:e.bounds.width,height:e.bounds.height,strokeColor:"none",fillColor:t&&n?o.interactive.normal:e.fillColor,fillOpacity:1})))),ps=(0,Do.Zz)(qt.SL,(0,wo.Ng)(((e,t)=>({interactive:e.interactive.includes(t.element.id),interactable:e.editor.view===oo.Exporting||e.editor.view===oo.Highlight}))))((({element:e,interactive:t,interactable:n,theme:o})=>W.createElement("g",null,W.createElement(on,{cx:"50%",cy:"50%",r:Math.min(e.bounds.width,e.bounds.height)/2,strokeColor:"none",fillColor:t&&n?o.interactive.normal:e.fillColor,fillOpacity:1})))),ms=({x:e,y:t,fill:n,textCentered:o=!1,messages:s,directionIcon:i})=>{const r=o?{textAnchor:"middle"}:{};return W.createElement(is,{x:e,y:t,fontSize:"85%",textAnchor:"start",dominantBaseline:"auto",fontWeight:"normal",fill:n},W.createElement("tspan",{fontWeight:"bold",fontSize:"120%",...r},s.length?i:""),s.map(((e,t)=>W.createElement("tspan",{key:t,x:e.bounds.x,y:e.bounds.y},e.name))))},gs=({id:e,color:t,d:n})=>W.createElement("g",null,W.createElement("marker",{id:`marker-${e}`,viewBox:"0 0 30 30",markerWidth:"22",markerHeight:"30",refX:"30",refY:"15",orient:"auto",markerUnits:"strokeWidth"},W.createElement(Kt,{d:"M0,29 L30,15 L0,1",fillColor:"none",strokeColor:t})),W.createElement(Kt,{d:n,strokeDasharray:7,markerEnd:`url(#marker-${e})`,strokeColor:t})),ys=({id:e,color:t,d:n})=>W.createElement("g",null,W.createElement("marker",{id:`marker-${e}`,viewBox:"0 0 30 30",markerWidth:"22",markerHeight:"30",refX:"30",refY:"15",orient:"auto",markerUnits:"strokeWidth"},W.createElement(Kt,{d:"M0,29 L30,15 L0,1",fillColor:"none",strokeColor:t})),W.createElement(Kt,{d:n,strokeColor:t,strokeDasharray:7,markerEnd:`url(#marker-${e})`})),fs=({element:e,fillColor:t})=>W.createElement("g",null,W.createElement(nn,{cx:"50%",cy:"50%",r:10,strokeColor:e.strokeColor,strokeWidth:2,fillColor:t||e.fillColor}),W.createElement(is,{x:25,noY:!0,dominantBaseline:"auto",textAnchor:"start",fill:e.textColor},e.name)),Cs=({element:e})=>W.createElement("g",null,W.createElement(Xt,{points:e.path.map((e=>`${e.x} ${e.y}`)).join(","),strokeColor:e.strokeColor,fillColor:"none"})),Es=(0,wo.Ng)(((e,t)=>{const n=e.diagram.ownedRelationships.map((t=>e.elements[t])).filter((e=>bn.isUMLInterfaceRequired(e))).map((e=>e));return{hasOppositeRequiredInterface:n.filter((e=>e.id!==t.element.id)).some((e=>e.target.element===t.element.target.element&&e.target.direction.valueOf()===X(t.element.target.direction).valueOf())),currentRequiredInterfaces:n.filter((e=>e.target.element===t.element.target.element)),currentAllInterfaces:e.diagram.ownedRelationships.map((t=>e.elements[t])).filter((e=>e.target.element===t.element.target.element))}}),{})((e=>{const{element:t,hasOppositeRequiredInterface:n,currentRequiredInterfaces:o,currentAllInterfaces:s}=e;let i;switch(t.target.direction){case Y.Up:i=new _(0,-3);break;case Y.Down:i=new _(0,3);break;case Y.Right:i=new _(3,0);break;case Y.Left:i=new _(-3,0)}return W.createElement("g",null,W.createElement("marker",{id:`marker-${t.id}`,viewBox:"0 0 27 27",markerWidth:27,markerHeight:27,refX:"0",refY:"0",orient:"auto",markerUnits:"strokeWidth"},W.createElement(Kt,{d:(()=>{let e="";switch(o.length){case 1:e=s.length===o.length?En.Semicircle:En.Threequarterscircle;break;case 2:e=n?En.Threequarterscircle:En.Quartercircle;break;default:e=En.Quartercircle}return e})(),fillColor:"none",strokeColor:t.strokeColor,strokeWidth:2})),W.createElement(Xt,{points:t.path.map(((e,n)=>(n===t.path.length-1&&(e=new _(e.x,e.y).add(i)),`${e.x} ${e.y}`))).join(","),strokeColor:t.strokeColor,fillColor:"none",strokeWidth:1,markerEnd:`url(#marker-${t.id})`}))})),bs=({element:e})=>W.createElement("g",null,W.createElement("marker",{id:`marker-${e.id}`,viewBox:"0 0 30 30",markerWidth:"22",markerHeight:"30",refX:"30",refY:"15",orient:"auto",markerUnits:"strokeWidth"},W.createElement(Kt,{d:"M0,29 L30,15 L0,1",fillColor:"none",strokeColor:e.strokeColor})),W.createElement(Xt,{points:e.path.map((e=>`${e.x} ${e.y}`)).join(","),strokeColor:e.strokeColor,fillColor:"none",strokeWidth:1,strokeDasharray:7,markerEnd:`url(#marker-${e.id})`})),vs=(e,t)=>e<=2?t/2:t/(1+1/Math.sin(Math.PI/e)),ws=({element:e,children:t,fillColor:n})=>W.createElement("g",{"data-cy":"uml-component"},W.createElement(en,{width:"100%",height:"100%",strokeColor:e.strokeColor,fillColor:n||e.fillColor}),W.createElement("g",{transform:`translate(${e.bounds.width-31}, 7)`},W.createElement(Kt,{d:"M 4.8 0 L 24 0 L 24 24 L 4.8 24 L 4.8 19.2 L 0 19.2 L 0 14.4 L 4.8 14.4 L 4.8 9.6 L 0 9.6 L 0 4.8 L 4.8 4.8 Z",fillColor:n||e.fillColor,strokeColor:e.strokeColor,strokeWidth:"1.2",strokeMiterlimit:"10"}),W.createElement(Kt,{d:"M 4.8 4.8 L 9.6 4.8 L 9.6 9.6 L 4.8 9.6 M 4.8 14.4 L 9.6 14.4 L 9.6 19.2 L 4.8 19.2",fillColor:"none",strokeColor:e.strokeColor,strokeWidth:"1.2",strokeMiterlimit:"10"})),W.createElement(is,{fill:e.textColor},e.stereotype&&e.displayStereotype&&W.createElement("tspan",{x:"50%",dy:-8,textAnchor:"middle",fontSize:"85%"},`${e.stereotype}`),W.createElement("tspan",{x:"50%",dy:e.stereotype&&e.displayStereotype?18:0,textAnchor:"middle"},e.name)),t),ks=({element:e,children:t})=>W.createElement("g",null,t,W.createElement(cs,{x:e.bounds.width/2,y:e.bounds.height/2,width:e.bounds.width,height:e.bounds.height,fontWeight:"bold",fill:e.textColor,lineHeight:16,capHeight:11},e.name)),xs=e=>W.createElement("svg",{...e,height:20,width:20},W.createElement(Xt,{points:"0 3, 0 17, 20 17, 20 3, 10 11, 0 3, 20 3",strokeLinecap:"round",strokeLinejoin:"round",fillColor:"transparent"})),Ms=e=>W.createElement("svg",{...e,height:20,width:20},W.createElement(Xt,{points:"0.2 3, 19.8 3, 10 11, 0.2 3",strokeLinecap:"round",strokeLinejoin:"round",fillColor:"currentColor"}),W.createElement(Xt,{points:"0 5.5, 0 17, 20 17, 20 5.5, 10 13.5, 0 5.5",strokeLinecap:"round",strokeLinejoin:"round",fillColor:"currentColor"})),Ss=e=>W.createElement("svg",{...e,height:20,width:20},W.createElement(en,{height:16,width:16,x:2,y:2,strokeLinejoin:"round",fillColor:"transparent"}),W.createElement(Xt,{points:"6 6, 12 6",strokeLinecap:"round",strokeLinejoin:"round"}),W.createElement(Xt,{points:"6 10, 14 10",strokeLinecap:"round",strokeLinejoin:"round"}),W.createElement(Xt,{points:"6 14, 10 14",strokeLinecap:"round",strokeLinejoin:"round"})),Is=e=>W.createElement("svg",{...e,height:20,width:20},W.createElement(en,{height:16,width:16,x:2,y:2,strokeLinejoin:"round",fillColor:"transparent"}),W.createElement(en,{height:4,width:16,x:2,y:2,strokeLinejoin:"round",fillColor:"currentColor"}),W.createElement(Xt,{points:"2 10, 18 10",strokeLinecap:"round",strokeLinejoin:"round"}),W.createElement(Xt,{points:"2 14, 18 14",strokeLinecap:"round",strokeLinejoin:"round"}),W.createElement(Xt,{points:"6 2, 6 18",strokeLinecap:"round",strokeLinejoin:"round"})),Ts=e=>W.createElement("svg",{...e,height:20,width:20},W.createElement(Kt,{d:"M5 1.5C5 2.5 5 8 5 8M5 1.5C5 0.499993 7 0.500007 7 1.5M5 1.5C5 1.5 5 4.00001 5 3.00001C5 2 3 1.93337 3 3.00001C3 4.06664 3 10 3 10C3 10 3 8.25001 3 7.25001C3 6.25 1 6.25 1 7.25001C1 8.25001 1 12 1 12L3 14V16H9V14L11 12V8.56252C11 8.56252 11 5 11 4C11 3 9 3 9 4C9 5 9 3.00001 9 3.00001M7 1.5C7 2.49999 7 8 7 8M7 1.5C7 1.5 7 4.00001 7 3.00001C7 2.00001 9 2.00001 9 3.00001M9 3.00001V8",strokeLinejoin:"round",fillColor:"transparent"})),Ps=e=>W.createElement("svg",{...e,height:20,width:20},W.createElement(nn,{cx:"10",cy:"4",r:4,fillColor:"transparent"}),W.createElement(Xt,{points:"4 16, 4 11, 16 11, 16 16",fillColor:"transparent"})),Ds=e=>W.createElement("svg",{...e,height:14,width:14},W.createElement(Xt,{points:"3 3, 11 3",strokeLinecap:"round",strokeLinejoin:"round",strokeColor:e.stroke,fillColor:"currentColor"}),W.createElement(Xt,{points:"3 7, 11 7",strokeLinecap:"round",strokeLinejoin:"round",strokeColor:e.stroke,fillColor:"currentColor"}),W.createElement(Xt,{points:"3 11, 11 11",strokeLinecap:"round",strokeLinejoin:"round",strokeColor:e.stroke,fillColor:"currentColor"})),As=e=>W.createElement("svg",{...e,height:14,width:14},W.createElement(Kt,{d:"M7,3 A 4 4 30 1 1 3.535 5",strokeColor:e.stroke,fillColor:"transparent",strokeLinejoin:"round",strokeLinecap:"round"}),W.createElement(Kt,{d:"M9.5,1.5 L7,3 L8,6",strokeColor:e.stroke,fillColor:"transparent",strokeLinejoin:"round",strokeLinecap:"round"})),Ls=e=>W.createElement("svg",{...e,height:14,width:14},W.createElement(Xt,{points:"3 3, 3 11",strokeLinecap:"round",strokeLinejoin:"round",strokeColor:e.stroke,fillColor:"currentColor"}),W.createElement(Xt,{points:"7 3, 7 11",strokeLinecap:"round",strokeLinejoin:"round",strokeColor:e.stroke,fillColor:"currentColor"}),W.createElement(Xt,{points:"11 3, 11 11",strokeLinecap:"round",strokeLinejoin:"round",strokeColor:e.stroke,fillColor:"currentColor"})),Rs=e=>W.createElement("svg",{...e,height:20,width:20},W.createElement(nn,{cx:"50%",cy:"50%",r:10,fillColor:"transparent"}),W.createElement(Xt,{points:"10 4, 10 10, 13 13",strokeLinecap:"round",strokeLinejoin:"round"})),Ns=e=>W.createElement("svg",{...e,height:20,width:20},W.createElement(Xt,{points:"10 3, 3 15, 17 15, 10 3",strokeLinecap:"round",strokeLinejoin:"round",fillColor:"transparent"})),Bs=e=>W.createElement("svg",{...e,height:20,width:20},W.createElement(en,{height:16,width:16,x:2,y:2,strokeLinejoin:"round",fillColor:"transparent"}),W.createElement(Xt,{points:"6 7, 14 7",strokeLinecap:"round",strokeLinejoin:"round"}),W.createElement(Xt,{points:"6 13, 14 13",strokeLinecap:"round",strokeLinejoin:"round"})),Os=e=>W.createElement("svg",{...e,height:20,width:20},W.createElement(Xt,{points:"10 3, 4 15, 10 12, 16 15, 10 3",strokeLinecap:"round",strokeLinejoin:"round",fillColor:"currentColor",fillRule:"evenodd"})),$s=e=>W.createElement("svg",{...e,height:20,width:20},W.createElement(Xt,{points:"3 7, 13 7, 13 4, 18 10, 13 16, 13 13, 3 13, 3 7",strokeLinecap:"round",strokeLinejoin:"round",fillColor:"transparent"})),Us=e=>W.createElement("svg",{...e,height:20,width:20},W.createElement(Xt,{points:"3 7, 13 7, 13 4, 18 10, 13 16, 13 13, 3 13, 3 7",strokeLinecap:"round",strokeLinejoin:"round",fillColor:"currentColor",fillRule:"evenodd"})),Fs=e=>W.createElement("svg",{...e,height:20,width:20},W.createElement(Xt,{points:"3 10, 9 6, 9 14, 3 10",strokeLinecap:"round",strokeLinejoin:"round",fillColor:"currentColor",fillRule:"evenodd"}),W.createElement(Xt,{points:"10 10, 16 6, 16 14, 10 10",strokeLinecap:"round",strokeLinejoin:"round",fillColor:"currentColor",fillRule:"evenodd"})),zs=e=>W.createElement("svg",{...e,height:20,width:20},W.createElement(Xt,{points:"10 3, 3 15, 17 15, 10 3",strokeLinecap:"round",strokeLinejoin:"round",fillColor:"currentColor",fillRule:"evenodd"})),Hs=e=>W.createElement("svg",{...e,height:20,width:20},W.createElement(nn,{cx:"50%",cy:"50%",r:10,fillColor:"currentColor"})),js=e=>W.createElement("svg",{...e,height:20,width:20},W.createElement(Xt,{points:"3 16, 6 4, 13 11, 17 4, 14 16, 7 10, 3 16",strokeLinecap:"round",strokeLinejoin:"round",fillColor:"currentColor"})),Qs=({element:e,fillColor:t})=>W.createElement("g",null,W.createElement(Xt,{points:`${e.bounds.width/2} 0, ${e.bounds.width} ${e.bounds.height/2}, ${e.bounds.width/2} ${e.bounds.height}, 0 ${e.bounds.height/2}, ${e.bounds.width/2} 0`,strokeColor:e.strokeColor,fillColor:t||e.fillColor}),W.createElement(nn,{cx:e.bounds.width/2,cy:e.bounds.height/2,r:Math.min(e.bounds.width,e.bounds.height)/2-9,strokeColor:e.strokeColor,fillColor:"transparent"}),W.createElement(nn,{cx:e.bounds.width/2,cy:e.bounds.height/2,r:Math.min(e.bounds.width,e.bounds.height)/2-12,strokeColor:e.strokeColor,fillColor:"transparent"}),W.createElement(Kt,{d:[`M${e.bounds.width/2}, ${e.bounds.height/2-4}`,`L${e.bounds.width/2+3.5}, ${e.bounds.height/2-1}`,`L${e.bounds.width/2+2} ${e.bounds.height/2+3.5}`,`L${e.bounds.width/2-2} ${e.bounds.height/2+3.5}`,`L${e.bounds.width/2-3.5} ${e.bounds.height/2-1}`,`L${e.bounds.width/2} ${e.bounds.height/2-4}`].join(" ")+" z",strokeColor:e.strokeColor,fillColor:"transparent"}),W.createElement(cs,{x:e.bounds.width/2,y:e.bounds.height+20,width:e.bounds.width,height:e.bounds.height,fill:e.textColor,lineHeight:16,capHeight:11,verticalAnchor:"start"},e.name)),Ws=({element:e,fillColor:t})=>W.createElement("g",null,W.createElement(Xt,{points:`${e.bounds.width/2} 0, ${e.bounds.width} ${e.bounds.height/2}, ${e.bounds.width/2} ${e.bounds.height}, 0 ${e.bounds.height/2}, ${e.bounds.width/2} 0`,strokeColor:e.strokeColor,fillColor:t||e.fillColor}),W.createElement(Xt,{points:`13 13, ${e.bounds.width-13} ${e.bounds.height-13}`,strokeColor:e.strokeColor,fillColor:"transparent"}),W.createElement(Xt,{points:`13 ${e.bounds.height-13}, ${e.bounds.width-13} 13`,strokeColor:e.strokeColor,fillColor:"transparent"}),W.createElement(cs,{x:e.bounds.width/2,y:e.bounds.height+20,width:2*e.bounds.width,height:e.bounds.height,fill:e.textColor,lineHeight:16,capHeight:11,verticalAnchor:"start"},e.name)),Gs=({element:e,fillColor:t})=>W.createElement("g",null,W.createElement(Xt,{points:`${e.bounds.width/2} 0, ${e.bounds.width} ${e.bounds.height/2}, ${e.bounds.width/2} ${e.bounds.height}, 0 ${e.bounds.height/2}, ${e.bounds.width/2} 0`,strokeColor:e.strokeColor,fillColor:t||e.fillColor}),W.createElement(nn,{cx:e.bounds.width/2,cy:e.bounds.height/2,r:Math.min(e.bounds.width,e.bounds.height)/2-12,strokeColor:e.strokeColor,fillColor:"transparent"}),W.createElement(cs,{x:e.bounds.width/2,y:e.bounds.height+20,width:2*e.bounds.width,height:e.bounds.height,fill:e.textColor,lineHeight:16,capHeight:11,verticalAnchor:"start"},e.name)),qs=({element:e,fillColor:t})=>W.createElement("g",null,W.createElement(Xt,{points:`${e.bounds.width/2} 0, ${e.bounds.width} ${e.bounds.height/2}, ${e.bounds.width/2} ${e.bounds.height}, 0 ${e.bounds.height/2}, ${e.bounds.width/2} 0`,strokeColor:e.strokeColor,fillColor:t||e.fillColor}),W.createElement(Xt,{points:`${e.bounds.width/2} 10, ${e.bounds.width/2} ${e.bounds.height-10}`,strokeColor:e.strokeColor,fillColor:"transparent"}),W.createElement(Xt,{points:`10 ${e.bounds.height/2}, ${e.bounds.width-10} ${e.bounds.height/2}`,strokeColor:e.strokeColor,fillColor:"transparent"}),W.createElement(cs,{x:e.bounds.width/2,y:e.bounds.height+20,width:2*e.bounds.width,height:e.bounds.height,fill:e.textColor,lineHeight:16,capHeight:11,verticalAnchor:"start"},e.name)),_s=({element:e,fillColor:t})=>W.createElement("g",null,W.createElement(Xt,{points:`${e.bounds.width/2} 0, ${e.bounds.width} ${e.bounds.height/2}, ${e.bounds.width/2} ${e.bounds.height}, 0 ${e.bounds.height/2}, ${e.bounds.width/2} 0`,strokeColor:e.strokeColor,fillColor:t||e.fillColor}),W.createElement(Xt,{points:`13 13, ${e.bounds.width-13} ${e.bounds.height-13}`,strokeColor:e.strokeColor,fillColor:"transparent"}),W.createElement(Xt,{points:`13 ${e.bounds.height-13}, ${e.bounds.width-13} 13`,strokeColor:e.strokeColor,fillColor:"transparent"}),W.createElement(Xt,{points:`${e.bounds.width/2} 10, ${e.bounds.width/2} ${e.bounds.height-10}`,strokeColor:e.strokeColor,fillColor:"transparent"}),W.createElement(Xt,{points:`10 ${e.bounds.height/2}, ${e.bounds.width-10} ${e.bounds.height/2}`,strokeColor:e.strokeColor,fillColor:"transparent"}),W.createElement(cs,{x:e.bounds.width/2,y:e.bounds.height+20,width:2*e.bounds.width,height:e.bounds.height,fill:e.textColor,lineHeight:16,capHeight:11,verticalAnchor:"start"},e.name)),Vs=(0,Do.Zz)(qt.SL,(0,wo.Ng)(((e,t)=>({hovered:e.hovered.includes(t.element.id),interactive:e.interactive.includes(t.element.id),interactable:e.editor.view===oo.Exporting||e.editor.view===oo.Highlight}))))((({element:e,strokeColor:t,textColor:n,interactive:o,interactable:s,hovered:i,theme:r})=>W.createElement("g",null,W.createElement(en,{rx:10,ry:10,width:e.bounds.width,height:e.bounds.height,strokeColor:"transparent",fillColor:s&&o?r.interactive.normal:s&&i?r.interactive.hovered:"transparent"}),W.createElement(Kt,{d:`M20,0 L10,0 A 10 10 280 0 0 0 10 L0,${e.bounds.height-10} A 10 10 180 0 0 10 ${e.bounds.height} L20, ${e.bounds.height}`,strokeColor:t||e.strokeColor,fillColor:"transparent"}),W.createElement(cs,{x:e.bounds.width/2,y:e.bounds.height/2,width:e.bounds.width,height:e.bounds.height,fontWeight:"bold",fill:n||e.textColor,lineHeight:16,capHeight:11},e.name)))),Ys=(0,Do.Zz)(qt.SL,(0,wo.Ng)(((e,t)=>({hovered:e.hovered.includes(t.element.id),interactive:e.interactive.includes(t.element.id),interactable:e.editor.view===oo.Exporting||e.editor.view===oo.Highlight}))))((({element:e,strokeColor:t,textColor:n,children:o,interactive:s,interactable:i,hovered:r,theme:a})=>W.createElement("g",null,W.createElement(en,{rx:10,ry:10,width:"100%",height:"100%",strokeColor:t||e.strokeColor,fillColor:i&&s?a.interactive.normal:i&&r?a.interactive.hovered:"transparent",strokeDasharray:"4"}),W.createElement(cs,{x:e.bounds.width/2,y:e.bounds.height/2,width:e.bounds.width,height:e.bounds.height,fontWeight:"bold",fill:n||e.textColor,lineHeight:16,capHeight:11},e.name),o))),Zs={[z.Package]:({element:e,children:t,fillColor:n})=>W.createElement("g",null,W.createElement(Kt,{d:"M 0 10 V 0 H 40 V 10",strokeColor:e.strokeColor,fillColor:n||e.fillColor}),W.createElement(en,{y:10,width:"100%",height:e.bounds.height-10,strokeColor:e.strokeColor,fillColor:n||e.fillColor}),W.createElement("text",{x:"50%",y:20,dy:10,textAnchor:"middle",fontWeight:"bold",pointerEvents:"none",style:e.textColor?{fill:e.textColor}:{}},e.name),t),[z.Class]:rs,[z.AbstractClass]:rs,[z.Interface]:rs,[z.Enumeration]:rs,[z.ClassAttribute]:as,[z.ClassMethod]:as,[z.ObjectName]:rs,[z.ObjectAttribute]:as,[z.ObjectMethod]:as,[z.Activity]:({element:e,children:t,fillColor:n})=>W.createElement("g",null,W.createElement(en,{rx:10,ry:10,width:"100%",height:"100%",strokeColor:e.strokeColor,fillColor:n||e.fillColor}),W.createElement(is,{y:20,fill:e.textColor},e.name),t),[z.ActivityActionNode]:({element:e,fillColor:t})=>W.createElement("g",null,W.createElement(en,{rx:10,ry:10,width:"100%",height:"100%",strokeColor:e.strokeColor,fillColor:t||e.fillColor}),W.createElement(cs,{x:e.bounds.width/2,y:e.bounds.height/2,width:e.bounds.width,height:e.bounds.height,fontWeight:"bold",fill:e.textColor},e.name)),[z.ActivityFinalNode]:ds,[z.ActivityForkNode]:hs,[z.ActivityForkNodeHorizontal]:us,[z.ActivityInitialNode]:ps,[z.ActivityMergeNode]:({element:e,fillColor:t})=>W.createElement("g",null,W.createElement(Xt,{points:`${e.bounds.width/2} 0, ${e.bounds.width} ${e.bounds.height/2}, ${e.bounds.width/2} ${e.bounds.height}, 0 ${e.bounds.height/2}, ${e.bounds.width/2} 0`,strokeColor:e.strokeColor,fillColor:t||e.fillColor}),W.createElement(cs,{x:e.bounds.width/2,y:e.bounds.height/2,width:e.bounds.width,height:e.bounds.height,fontWeight:"bold",fill:e.textColor},e.name)),[z.ActivityObjectNode]:({element:e,fillColor:t})=>W.createElement("g",null,W.createElement(en,{width:"100%",height:"100%",fillColor:t||e.fillColor,strokeColor:e.strokeColor}),W.createElement(cs,{x:e.bounds.width/2,y:e.bounds.height/2,width:e.bounds.width,height:e.bounds.height,fontWeight:"bold",fill:e.textColor},e.name)),[z.UseCase]:({element:e,fillColor:t})=>W.createElement("g",null,W.createElement(sn,{cx:"50%",cy:"50%",rx:"50%",ry:"50%",strokeColor:e.strokeColor,fillColor:t||e.fillColor}),W.createElement(is,{fill:e.textColor},e.name)),[z.UseCaseActor]:({element:e,fillColor:t})=>W.createElement("g",null,W.createElement("rect",{width:"100%",height:"100%",fill:"none"}),W.createElement("g",{stroke:e.strokeColor||"black",strokeWidth:2},W.createElement(nn,{cx:te(1,40,!0),cy:te(1,25,!0),r:te(1,15,!0),fillColor:t||e.fillColor,strokeColor:e.fillColor}),W.createElement(rn,{x1:te(1,40),y1:te(1,40),x2:te(1,40),y2:te(1,75),strokeColor:e.fillColor}),W.createElement(rn,{x1:te(1,10),y1:50,x2:te(1,65),y2:50,strokeColor:e.fillColor}),W.createElement(rn,{x1:te(1,40),y1:te(1,75),x2:te(1,10),y2:te(1,110),strokeColor:e.fillColor}),W.createElement(rn,{x1:te(1,40),y1:te(1,75),x2:te(1,65),y2:te(1,110),strokeColor:e.fillColor})),W.createElement(is,{fill:e.textColor,x:te(1,40),y:te(1,130)},e.name)),[z.UseCaseSystem]:({element:e,children:t,fillColor:n})=>W.createElement("g",null,W.createElement(en,{width:"100%",height:"100%",fillColor:n||e.fillColor,strokeColor:e.strokeColor}),W.createElement(is,{fill:e.textColor,y:16},e.name),t),[z.Component]:ws,[z.Subsystem]:({element:e,children:t,fillColor:n})=>W.createElement("g",{"data-cy":"uml-subsystem"},W.createElement(en,{width:"100%",height:"100%",strokeColor:e.strokeColor,fillColor:n||e.fillColor}),W.createElement("g",{transform:`translate(${e.bounds.width-31}, 7)`},W.createElement(Kt,{d:"M 4.8 0 L 24 0 L 24 24 L 4.8 24 L 4.8 19.2 L 0 19.2 L 0 14.4 L 4.8 14.4 L 4.8 9.6 L 0 9.6 L 0 4.8 L 4.8 4.8 Z",fillColor:n||e.fillColor,strokeColor:e.strokeColor,strokeWidth:"1.2",strokeMiterlimit:"10"}),W.createElement(Kt,{d:"M 4.8 4.8 L 9.6 4.8 L 9.6 9.6 L 4.8 9.6 M 4.8 14.4 L 9.6 14.4 L 9.6 19.2 L 4.8 19.2",fillColor:"none",strokeColor:e.strokeColor,strokeWidth:"1.2",strokeMiterlimit:"10"})),W.createElement(is,{fill:e.textColor,y:"25px"},e.stereotype&&e.displayStereotype&&W.createElement("tspan",{x:"50%",dy:-8,textAnchor:"middle",fontSize:"85%"},`${e.stereotype}`),W.createElement("tspan",{x:"50%",dy:e.stereotype&&e.displayStereotype?18:0,textAnchor:"middle"},e.name)),t),[z.ComponentInterface]:fs,[z.DeploymentNode]:({element:e,children:t,fillColor:n})=>W.createElement("g",null,W.createElement("g",null,W.createElement(Kt,{d:`M 0 8 l 8 -8 H ${e.bounds.width} l -8 8 Z`,strokeColor:e.strokeColor,fillColor:n||e.fillColor}),W.createElement(Kt,{d:`M ${e.bounds.width} 0 V ${e.bounds.height-8} l -8 8 V 8 Z`,strokeColor:e.strokeColor,fillColor:n||e.fillColor}),W.createElement(en,{x:"0",y:8,width:e.bounds.width-8,height:e.bounds.height-9,strokeColor:e.strokeColor,fillColor:n||e.fillColor})),W.createElement(is,{y:30,fill:e.textColor},e.stereotype&&e.displayStereotype&&W.createElement("tspan",{x:"50%",dy:-8,textAnchor:"middle",fontSize:"85%"},`${e.stereotype}`),W.createElement("tspan",{x:"50%",dy:e.stereotype&&e.displayStereotype?18:0,textDecoration:"underline",textAnchor:"middle"},e.name)),t),[z.DeploymentComponent]:ws,[z.DeploymentArtifact]:({element:e,fillColor:t})=>W.createElement("g",null,W.createElement(en,{width:"100%",height:"100%",strokeColor:e.strokeColor,fillColor:t||e.fillColor}),W.createElement(is,{y:28,dominantBaseline:"auto",fill:e.textColor},e.name),W.createElement("g",{transform:`translate(${e.bounds.width-26}, 7)`},W.createElement(Kt,{d:"M 0 0 L 13 0 L 19.2 7.25 L 19.2 24 L 0 24 L 0 0 Z",fillColor:t||e.fillColor,strokeColor:e.strokeColor,strokeWidth:"1.2",strokeMiterlimit:"10"}),W.createElement(Kt,{d:"M 13 0 L 13 7.25 L 19.2 7.25",fillColor:"none",strokeColor:e.strokeColor,strokeWidth:"1.2",strokeMiterlimit:"10"}))),[z.DeploymentInterface]:fs,[z.PetriNetTransition]:({element:e,fillColor:t})=>W.createElement("g",null,W.createElement(is,{y:-15,fill:e.textColor},e.name),W.createElement(en,{width:e.bounds.width,height:e.bounds.height,strokeColor:e.strokeColor,fillColor:t||e.fillColor,strokeWidth:1,fillOpacity:1})),[z.PetriNetPlace]:({element:e,fillColor:t})=>{const n=Math.min(e.bounds.width,e.bounds.height)/2,o=e.amountOfTokens>0&&e.amountOfTokens>5,s=e.capacity!==$e.defaultCapacity;let i,r=[];if(e.amountOfTokens>0&&!o){const t=n-5;r=((e,t)=>{const n=[];if(1===e)n.push(new _(0,0));else{const o=2*Math.PI/e,s=t+2.5*e/5-vs(5,t);for(let t=0;t<e;t++){const e=t*o+.5*Math.PI;n.push(new _(Math.cos(e)*s,Math.sin(e)*s))}}return n})(e.amountOfTokens,t),i=vs(5,t)}return W.createElement("g",null,W.createElement(nn,{cx:"50%",cy:"50%",r:n,strokeColor:e.strokeColor,strokeWidth:1,fillColor:t||e.fillColor,fillOpacity:1}),!o&&r.map(((t,o)=>W.createElement(on,{key:o,cx:n+t.x,cy:n+t.y,r:i,strokeColor:"none",fillColor:e.strokeColor,fillOpacity:1}))),o&&W.createElement(is,{fill:e.strokeColor},e.amountOfTokens),s&&W.createElement("text",{x:"95%",y:5,pointerEvents:"none",style:e.textColor?{fill:e.textColor}:{}},"C=",e.capacity),W.createElement(is,{fill:e.textColor,y:e.bounds.height+15},e.name))},[z.ReachabilityGraphMarking]:({element:e,fillColor:t})=>W.createElement("g",null,W.createElement(en,{rx:10,ry:10,width:"100%",height:"100%",strokeColor:e.strokeColor,fillColor:t||e.fillColor}),W.createElement(cs,{x:e.bounds.width/2,y:e.bounds.height/2,width:e.bounds.width,height:e.bounds.height,fontWeight:"bold",fill:e.textColor,lineHeight:16,capHeight:11},e.name),e.isInitialMarking&&W.createElement("g",null,W.createElement("marker",{id:`marker-${e.id}`,viewBox:"0 0 30 30",markerWidth:22,markerHeight:30,refX:30,refY:15,orient:"auto",markerUnits:"strokeWidth"},W.createElement(Kt,{d:"M0,29 L30,15 L0,1",fillColor:"none",strokeColor:e.strokeColor})),W.createElement(Xt,{points:"-50,-50 3,3",strokeColor:e.strokeColor,fillColor:"none",strokeWidth:1,markerEnd:`url(#marker-${e.id})`}))),[z.CommunicationLinkMessage]:as,[z.SyntaxTreeTerminal]:({element:e,fillColor:t})=>W.createElement("g",null,W.createElement(en,{width:"100%",height:"100%",strokeColor:e.strokeColor,fillColor:t||e.fillColor}),W.createElement(cs,{x:e.bounds.width/2,y:e.bounds.height/2,width:e.bounds.width,height:e.bounds.height,fontWeight:"bold",fill:e.textColor,lineHeight:16,capHeight:11},e.name)),[z.SyntaxTreeNonterminal]:({element:e,fillColor:t})=>W.createElement("g",null,W.createElement(en,{rx:10,ry:10,width:"100%",height:"100%",strokeColor:e.strokeColor,fillColor:t||e.fillColor}),W.createElement(cs,{x:e.bounds.width/2,y:e.bounds.height/2,width:e.bounds.width,height:e.bounds.height,fontWeight:"bold",fill:e.textColor,lineHeight:16,capHeight:11},e.name)),[z.FlowchartTerminal]:({element:e,fillColor:t})=>W.createElement(ks,{element:e},W.createElement(en,{fillColor:t||e.fillColor,rx:10,ry:10,width:"100%",height:"100%",strokeColor:e.strokeColor})),[z.FlowchartDecision]:({element:e,fillColor:t})=>W.createElement(ks,{element:e},W.createElement(Xt,{points:`${e.bounds.width/2} 0, ${e.bounds.width} ${e.bounds.height/2}, ${e.bounds.width/2} ${e.bounds.height}, 0 ${e.bounds.height/2}, ${e.bounds.width/2} 0`,strokeColor:e.strokeColor,fillColor:t||e.fillColor})),[z.FlowchartProcess]:({element:e,fillColor:t})=>W.createElement(ks,{element:e},W.createElement(en,{width:"100%",height:"100%",strokeColor:e.strokeColor,fillColor:t||e.fillColor})),[z.FlowchartInputOutput]:({element:e,fillColor:t})=>W.createElement(ks,{element:e},W.createElement(Xt,{points:`${te(1.1,e.bounds.width)} 0, ${te(.9,e.bounds.width)} ${e.bounds.height}, ${te(-.1,e.bounds.width)} ${e.bounds.height}, ${te(.1,e.bounds.width)} 0, ${te(1.1,e.bounds.width)} 0`,strokeColor:e.strokeColor,fillColor:t||e.fillColor})),[z.FlowchartFunctionCall]:({element:e,fillColor:t})=>W.createElement(ks,{element:e},W.createElement(en,{fillColor:t||e.fillColor,width:10,height:"100%",strokeColor:e.strokeColor,x:"0"}),W.createElement(en,{width:e.bounds.width-20,height:"100%",strokeColor:e.strokeColor,x:10,fillColor:t||e.fillColor}),W.createElement(en,{width:10,height:"100%",strokeColor:e.strokeColor,x:e.bounds.width-10,fillColor:t||e.fillColor})),[z.ColorLegend]:({element:e,fillColor:t})=>W.createElement("g",null,W.createElement(Kt,{d:`M 0 0 L ${e.bounds.width-15} 0 L ${e.bounds.width} 15 L ${e.bounds.width} ${e.bounds.height} L 0 ${e.bounds.height} L 0 0 Z`,fillColor:t||e.fillColor,strokeColor:e.strokeColor,strokeWidth:"1.2",strokeMiterlimit:"10"}),W.createElement(Kt,{d:`M ${e.bounds.width-15} 0 L ${e.bounds.width-15} 15 L ${e.bounds.width} 15`,fillColor:"none",strokeColor:e.strokeColor,strokeWidth:"1.2",strokeMiterlimit:"10"}),W.createElement(cs,{x:e.bounds.width/2,y:e.bounds.height/2,width:e.bounds.width,height:e.bounds.height,fontWeight:"bold",fill:e.textColor},e.name)),[z.BPMNTask]:({element:e,fillColor:t,strokeColor:n,textColor:o})=>W.createElement("g",null,W.createElement(en,{rx:10,ry:10,width:"100%",height:"100%",fillColor:t||e.fillColor,strokeColor:n||e.strokeColor}),W.createElement(cs,{x:e.bounds.width/2,y:e.bounds.height/2,width:e.bounds.width,height:e.bounds.height,fontWeight:"bold",fill:o||e.textColor,lineHeight:16,capHeight:11},e.name),((e,t={})=>{switch(e){case"default":default:return null;case"user":return W.createElement(Ps,{...t});case"send":return W.createElement(Ms,{...t});case"receive":return W.createElement(xs,{...t});case"manual":return W.createElement(Ts,{...t});case"business-rule":return W.createElement(Is,{...t});case"script":return W.createElement(Ss,{...t})}})(e.taskType,{x:10,y:10}),((e,t={})=>{switch(e){case"none":default:return null;case"parallel multi instance":return W.createElement(Ls,{...t});case"sequential multi instance":return W.createElement(Ds,{...t});case"loop":return W.createElement(As,{...t})}})(e.marker,{x:e.bounds.width/2-7,y:e.bounds.height-16})),[z.BPMNSubprocess]:({element:e,fillColor:t,strokeColor:n,textColor:o})=>W.createElement("g",null,W.createElement(en,{rx:10,ry:10,width:"100%",height:"100%",fillColor:t||e.fillColor,strokeColor:n||e.strokeColor}),W.createElement(en,{x:e.bounds.width/2-7,y:e.bounds.height-14,width:14,height:14,fillColor:"transparent",strokeColor:e.strokeColor}),W.createElement(Xt,{points:`${e.bounds.width/2-4} ${e.bounds.height-7}, ${e.bounds.width/2+4} ${e.bounds.height-7}`,strokeColor:n||e.strokeColor,strokeLinejoin:"round",strokeLinecap:"round"}),W.createElement(Xt,{points:`${e.bounds.width/2} ${e.bounds.height-11}, ${e.bounds.width/2} ${e.bounds.height-3}`,strokeColor:n||e.strokeColor,strokeLinejoin:"round",strokeLinecap:"round"}),W.createElement(cs,{x:e.bounds.width/2,y:e.bounds.height/2,width:e.bounds.width,height:e.bounds.height,fontWeight:"bold",fill:o||e.textColor,lineHeight:16,capHeight:11},e.name)),[z.BPMNTransaction]:({element:e,fillColor:t,strokeColor:n,textColor:o})=>W.createElement("g",null,W.createElement(en,{rx:10,ry:10,width:e.bounds.width,height:e.bounds.height,fillColor:t||e.fillColor,strokeColor:n||e.strokeColor}),W.createElement(en,{rx:7,ry:7,x:3,y:3,width:e.bounds.width-6,height:e.bounds.height-6,fillColor:t||e.fillColor,strokeColor:n||e.strokeColor}),W.createElement(cs,{x:e.bounds.width/2,y:e.bounds.height/2,width:e.bounds.width,height:e.bounds.height,fontWeight:"bold",fill:o||e.textColor,lineHeight:16,capHeight:11},e.name)),[z.BPMNCallActivity]:({element:e,fillColor:t,strokeColor:n,textColor:o})=>W.createElement("g",null,W.createElement(en,{rx:10,ry:10,width:e.bounds.width,height:e.bounds.height,strokeColor:n||e.strokeColor,strokeWidth:3,fillColor:t||e.fillColor}),W.createElement(cs,{x:e.bounds.width/2,y:e.bounds.height/2,width:e.bounds.width,height:e.bounds.height,fontWeight:"bold",fill:o||e.textColor,lineHeight:16,capHeight:11},e.name)),[z.BPMNAnnotation]:Vs,[z.BPMNStartEvent]:({element:e,fillColor:t,strokeColor:n,textColor:o})=>W.createElement("g",null,W.createElement(nn,{cx:"50%",cy:"50%",r:Math.min(e.bounds.width,e.bounds.height)/2,fillColor:t||e.fillColor||"transparent",strokeColor:n||e.strokeColor}),W.createElement(cs,{x:e.bounds.width/2,y:e.bounds.height+20,width:2*e.bounds.width,fill:o||e.textColor,lineHeight:16,capHeight:11,verticalAnchor:"start"},e.name),((e,t={})=>{switch(e){case"default":default:return null;case"message":return W.createElement(xs,{...t});case"timer":return W.createElement(Rs,{...t});case"conditional":return W.createElement(Bs,{...t});case"signal":return W.createElement(Ns,{...t})}})(e.eventType,{x:e.bounds.width/2-10,y:e.bounds.height/2-10})),[z.BPMNIntermediateEvent]:({element:e,fillColor:t,strokeColor:n,textColor:o})=>W.createElement("g",null,W.createElement(nn,{cx:"50%",cy:"50%",r:Math.min(e.bounds.width,e.bounds.height)/2-.5,fillColor:t||e.fillColor||"transparent",strokeColor:n||e.strokeColor}),W.createElement(nn,{cx:"50%",cy:"50%",r:Math.min(e.bounds.width,e.bounds.height)/2-3.5,fillColor:t||e.fillColor||"transparent",strokeColor:n||e.strokeColor}),W.createElement(cs,{x:e.bounds.width/2,y:e.bounds.height+20,width:2*e.bounds.width,fill:o||e.textColor,lineHeight:16,capHeight:11,verticalAnchor:"start"},e.name),((e,t={})=>{switch(e){case"default":default:return null;case"message-catch":return W.createElement(xs,{...t});case"message-throw":return W.createElement(Ms,{...t});case"timer-catch":return W.createElement(Rs,{...t});case"escalation-throw":return W.createElement(Os,{...t});case"conditional-catch":return W.createElement(Bs,{...t});case"link-catch":return W.createElement($s,{...t});case"link-throw":return W.createElement(Us,{...t});case"compensation-throw":return W.createElement(Fs,{...t});case"signal-catch":return W.createElement(Ns,{...t});case"signal-throw":return W.createElement(zs,{...t})}})(e.eventType,{x:e.bounds.width/2-10,y:e.bounds.height/2-10})),[z.BPMNEndEvent]:({element:e,fillColor:t,strokeColor:n,textColor:o})=>W.createElement("g",null,W.createElement(nn,{cx:"50%",cy:"50%",r:Math.min(e.bounds.width,e.bounds.height)/2-1.5,strokeWidth:3,fillColor:t||e.fillColor,strokeColor:n||e.strokeColor}),W.createElement(cs,{x:e.bounds.width/2,y:e.bounds.height+20,fill:o||e.textColor,width:2*e.bounds.width,lineHeight:16,capHeight:11,verticalAnchor:"start"},e.name),((e,t={})=>{switch(e){case"default":default:return null;case"message":return W.createElement(Ms,{...t});case"escalation":return W.createElement(Os,{...t});case"error":return W.createElement(js,{...t});case"compensation":return W.createElement(Fs,{...t});case"signal":return W.createElement(zs,{...t});case"terminate":return W.createElement(Hs,{...t})}})(e.eventType,{x:e.bounds.width/2-10,y:e.bounds.height/2-10})),[z.BPMNGateway]:e=>{let t=Ws;switch(e.element.gatewayType){case"complex":t=_s;break;case"event-based":t=Qs;break;case"exclusive":t=Ws;break;case"inclusive":t=Gs;break;case"parallel":t=qs}return W.createElement("g",null,W.createElement(t,{...e}))},[z.BPMNDataObject]:({element:e,fillColor:t,strokeColor:n,textColor:o})=>W.createElement("g",null,W.createElement(Xt,{points:`0 0, 0 ${e.bounds.height}, ${e.bounds.width} ${e.bounds.height}, ${e.bounds.width} 15, ${e.bounds.width-15} 0, ${e.bounds.width-15} 15, ${e.bounds.width} 15, ${e.bounds.width-15} 0, 0 0`,strokeColor:n||e.strokeColor,fillColor:t||e.fillColor}),W.createElement(cs,{x:e.bounds.width/2,y:e.bounds.height+20,width:2*e.bounds.width,fill:o||e.textColor,lineHeight:16,capHeight:11,verticalAnchor:"start"},e.name)),[z.BPMNDataStore]:({element:e,fillColor:t,strokeColor:n,textColor:o})=>W.createElement("g",null,W.createElement(Kt,{d:`M 0 10 L 0 ${e.bounds.height-10} A ${e.bounds.width/2} 10 0 0 0 ${e.bounds.width} ${e.bounds.height-10} L ${e.bounds.width} 10 A ${e.bounds.width/2} 10 180 0 0 0 10`,strokeColor:n||e.strokeColor,fillColor:t||e.fillColor}),W.createElement(Kt,{d:`M 0 30 A ${e.bounds.width/2} 10 0 0 0 ${e.bounds.width} 30`,strokeColor:n||e.strokeColor,fillColor:"transparent"}),W.createElement(Kt,{d:`M 0 20 A ${e.bounds.width/2} 10 0 0 0 ${e.bounds.width} 20`,strokeColor:n||e.strokeColor,fillColor:"transparent"}),W.createElement(Kt,{d:`M 0 10 A ${e.bounds.width/2} 10 0 0 0 ${e.bounds.width} 10`,strokeColor:n||e.strokeColor,fillColor:"transparent"}),W.createElement(cs,{x:e.bounds.width/2,y:e.bounds.height+20,width:2*e.bounds.width,fill:o||e.textColor,lineHeight:16,capHeight:11,verticalAnchor:"start"},e.name)),[z.BPMNPool]:({element:e,fillColor:t,strokeColor:n,textColor:o,children:s})=>W.createElement("g",null,W.createElement(en,{y:0,width:lt.HEADER_WIDTH,height:e.bounds.height,strokeColor:n||e.strokeColor,fillColor:t||e.fillColor}),W.createElement(en,{y:0,x:lt.HEADER_WIDTH,width:e.bounds.width-lt.HEADER_WIDTH,height:e.bounds.height,strokeColor:n||e.strokeColor,fillColor:t||e.fillColor}),W.createElement(cs,{y:20,x:-e.bounds.height/2,textAnchor:"middle",alignmentBaseline:"middle",transform:"rotate(270)",fontWeight:"bold",pointerEvents:"none",fill:o||e.textColor},e.name),s),[z.BPMNSwimlane]:({element:e,fillColor:t,textColor:n,children:o})=>W.createElement("g",null,W.createElement(en,{width:e.bounds.width,height:e.bounds.height,fillColor:t||e.fillColor}),W.createElement(cs,{y:20,x:-e.bounds.height/2,transform:"rotate(270)",textAnchor:"middle",alignmentBaseline:"middle",pointerEvents:"none",fill:n||e.textColor},e.name),o),[z.BPMNGroup]:Ys,[pt.ClassAggregation]:mn,[pt.ClassBidirectional]:mn,[pt.ClassComposition]:mn,[pt.ClassDependency]:mn,[pt.ClassInheritance]:mn,[pt.ClassRealization]:mn,[pt.ClassUnidirectional]:mn,[pt.ObjectLink]:({element:e})=>W.createElement("g",null,W.createElement(Xt,{points:e.path.map((e=>`${e.x} ${e.y}`)).join(","),strokeColor:e.strokeColor,fillColor:"none",strokeWidth:1})),[pt.ActivityControlFlow]:({element:e})=>{let t={x:0,y:0},n="v";const o=e.path.map((e=>new _(e.x,e.y)));let s=o.reduce(((e,t,n,o)=>n+1<o.length?e+o[n+1].subtract(t).length:e),0)/2;for(let e=0;e<o.length-1;e++){const i=o[e+1].subtract(o[e]);if(i.length>s){const r=i.normalize();n=Math.abs(r.x)>Math.abs(r.y)?"h":"v",t=o[e].add(r.scale(s));break}s-=i.length}const i=e.textColor?{fill:e.textColor}:{};return W.createElement("g",null,W.createElement("marker",{id:`marker-${e.id}`,viewBox:"0 0 30 30",markerWidth:"22",markerHeight:"30",refX:"30",refY:"15",orient:"auto",markerUnits:"strokeWidth"},W.createElement(Kt,{d:"M0,29 L30,15 L0,1",fillColor:"none",strokeColor:e.strokeColor})),W.createElement(Xt,{points:e.path.map((e=>`${e.x} ${e.y}`)).join(","),strokeColor:e.strokeColor,fillColor:"none",strokeWidth:1,markerEnd:`url(#marker-${e.id})`}),W.createElement("text",{x:t.x,y:t.y,...(e=>{switch(e){case"v":return{dx:5,dominantBaseline:"middle",textAnchor:"start"};case"h":return{dy:-5,dominantBaseline:"text-after-edge",textAnchor:"middle"}}})(n),pointerEvents:"none",style:{...i}},e.name))},[pt.UseCaseAssociation]:({element:e})=>{const[t,n]=e.path.map((e=>new _(e.x,e.y))),o=n.subtract(t),s=o.normalize(),i=t.add(s.scale(.5*o.length));return W.createElement("g",null,W.createElement("path",{id:`textpath-${e.id}`,d:`\n        M ${t.x} ${t.y-10}\n        L ${n.x} ${n.y-10}\n    `}),W.createElement(is,{dy:"20px",noX:!0,noY:!0,fill:e.textColor,transform:s.x<0?`\n            translate(${i.x}, ${i.y})\n            rotate(180)\n            translate(${-i.x}, ${-i.y})\n          `:void 0},W.createElement("textPath",{xlinkHref:`#textpath-${e.id}`,startOffset:"50%"},e.name)),W.createElement(Xt,{points:e.path.map((e=>`${e.x} ${e.y}`)).join(","),strokeColor:e.strokeColor,fillColor:"none",strokeWidth:1}))},[pt.UseCaseExtend]:({element:e})=>{const[t,n]=e.path.map((e=>new _(e.x,e.y))),o=n.subtract(t);if(o.length<=100)return W.createElement(gs,{id:e.id,color:e.strokeColor,d:`M ${t.x} ${t.y} L ${n.x} ${n.y}`});const s=o.normalize(),i=t.add(s.scale(.5*o.length)),r=t.add(s.scale(.5*o.length-40)),a=n.subtract(s.scale(.5*o.length-40));return W.createElement("g",null,W.createElement(gs,{color:e.strokeColor,id:e.id,d:`\n          M ${t.x} ${t.y} L ${r.x} ${r.y}\n          M ${a.x} ${a.y} L ${n.x} ${n.y}\n        `}),W.createElement("path",{id:`textpath-${e.id}`,d:`\n          M ${r.x} ${r.y}\n          L ${a.x} ${a.y}\n        `}),W.createElement(is,{noX:!0,noY:!0,fill:e.textColor,transform:s.x<0?`\n              translate(${i.x}, ${i.y})\n              rotate(180)\n              translate(${-i.x}, ${-i.y})\n            `:void 0},W.createElement("textPath",{xlinkHref:`#textpath-${e.id}`,startOffset:"50%"},"extend")))},[pt.UseCaseGeneralization]:({element:e})=>W.createElement("g",null,W.createElement("marker",{id:`marker-${e.id}`,viewBox:"0 0 30 30",markerWidth:"22",markerHeight:"30",refX:"30",refY:"15",orient:"auto",markerUnits:"strokeWidth"},W.createElement(Kt,{d:"M0,1 L0,29 L30,15 z",strokeColor:e.strokeColor})),W.createElement(Xt,{points:e.path.map((e=>`${e.x} ${e.y}`)).join(","),strokeColor:e.strokeColor,fillColor:"none",strokeWidth:1,markerEnd:`url(#marker-${e.id})`})),[pt.UseCaseInclude]:({element:e})=>{const[t,n]=e.path.map((e=>new _(e.x,e.y))),o=n.subtract(t);if(o.length<=100)return W.createElement(ys,{id:e.id,color:e.strokeColor,d:`M ${t.x} ${t.y} L ${n.x} ${n.y}`});const s=o.normalize(),i=t.add(s.scale(.5*o.length)),r=t.add(s.scale(.5*o.length-40)),a=n.subtract(s.scale(.5*o.length-40));return W.createElement("g",null,W.createElement(ys,{id:e.id,color:e.strokeColor,d:`\n          M ${t.x} ${t.y} L ${r.x} ${r.y}\n          M ${a.x} ${a.y} L ${n.x} ${n.y}\n        `}),W.createElement("path",{id:`textpath-${e.id}`,d:`\n          M ${r.x} ${r.y}\n          L ${a.x} ${a.y}\n        `}),W.createElement(is,{noX:!0,noY:!0,fill:e.textColor,transform:s.x<0?`\n              translate(${i.x}, ${i.y})\n              rotate(180)\n              translate(${-i.x}, ${-i.y})\n            `:void 0},W.createElement("textPath",{xlinkHref:`#textpath-${e.id}`,startOffset:"50%"},"include")))},[pt.CommunicationLink]:({element:e})=>{const t=e.messages.filter((e=>"source"===e.direction)),n=e.messages.filter((e=>"target"===e.direction));let o={x:0,y:0},s=Y.Left;const i=e.path.map((e=>new _(e.x,e.y)));let r=i.reduce(((e,t,n,o)=>n+1<o.length?e+o[n+1].subtract(t).length:e),0)/2;for(let e=0;e<i.length-1;e++){const t=i[e+1].subtract(i[e]);if(t.length>r){const n=t.normalize();s=Math.abs(n.x)>Math.abs(n.y)?n.x>0?Y.Left:Y.Right:n.y>0?Y.Up:Y.Down,o=i[e].add(n.scale(r));break}r-=t.length}return W.createElement("g",null,{[Y.Up]:W.createElement(W.Fragment,null,W.createElement(ms,{x:o.x+8,y:o.y,fill:e.textColor,directionIcon:"",messages:t}),W.createElement(ms,{x:o.x-16,y:o.y,fill:e.textColor,directionIcon:"",messages:n})),[Y.Right]:W.createElement(W.Fragment,null,W.createElement(ms,{x:o.x,y:o.y,fill:e.textColor,directionIcon:"",messages:n,textCentered:!0}),W.createElement(ms,{x:o.x,y:o.y+16,fill:e.textColor,directionIcon:"",messages:t,textCentered:!0})),[Y.Down]:W.createElement(W.Fragment,null,W.createElement(ms,{x:o.x+8,y:o.y,fill:e.textColor,directionIcon:"",messages:n}),W.createElement(ms,{x:o.x-16,y:o.y,fill:e.textColor,directionIcon:"",messages:t})),[Y.Left]:W.createElement(W.Fragment,null,W.createElement(ms,{x:o.x,y:o.y,fill:e.textColor,directionIcon:"",messages:t,textCentered:!0}),W.createElement(ms,{x:o.x,y:o.y+16,fill:e.textColor,directionIcon:"",messages:n,textCentered:!0}))}[s],W.createElement(Xt,{points:e.path.map((e=>`${e.x} ${e.y}`)).join(","),strokeColor:e.strokeColor,fillColor:"none",strokeWidth:1}))},[pt.ComponentInterfaceProvided]:Cs,[pt.ComponentInterfaceRequired]:Es,[pt.ComponentDependency]:bs,[pt.DeploymentAssociation]:({element:e})=>{let t={x:0,y:0},n="v";const o=e.path.map((e=>new _(e.x,e.y)));let s=o.reduce(((e,t,n,o)=>n+1<o.length?e+o[n+1].subtract(t).length:e),0)/2;for(let e=0;e<o.length-1;e++){const i=o[e+1].subtract(o[e]);if(i.length>s){const r=i.normalize();n=Math.abs(r.x)>Math.abs(r.y)?"h":"v",t=o[e].add(r.scale(s));break}s-=i.length}return W.createElement("g",null,W.createElement(Xt,{points:e.path.map((e=>`${e.x} ${e.y}`)).join(","),strokeColor:e.strokeColor,fillColor:"none",strokeWidth:1}),W.createElement(is,{fill:e.textColor,x:t.x,y:t.y,...(e=>{switch(e){case"v":return{dx:5,dominantBaseline:"middle",textAnchor:"start"};case"h":return{dy:-5,dominantBaseline:"text-after-edge",textAnchor:"middle"}}})(n),pointerEvents:"none"},e.name))},[pt.DeploymentDependency]:bs,[pt.DeploymentInterfaceProvided]:Cs,[pt.DeploymentInterfaceRequired]:Es,[pt.PetriNetArc]:({element:e})=>{const[t,n]=e.path.map((e=>new _(e.x,e.y))),o=n.subtract(t),s=o.normalize(),i=t.add(s.scale(.5*o.length)),r=e.name!==Mn.defaultMultiplicity;return W.createElement("g",null,W.createElement("marker",{id:`marker-${e.id}`,viewBox:"0 0 30 30",markerWidth:"22",markerHeight:"30",refX:"30",refY:"15",orient:"auto",markerUnits:"strokeWidth"},W.createElement(Jt,{d:"M0,1 L0,29 L30,15 z",fill:e.strokeColor})),W.createElement("path",{id:`textpath-${e.id}`,d:`\n        M ${t.x} ${t.y-10}\n        L ${n.x} ${n.y-10}\n    `}),r&&W.createElement(is,{dy:"20px",noX:!0,noY:!0,fill:e.textColor,transform:s.x<0?`\n            translate(${i.x}, ${i.y})\n            rotate(180)\n            translate(${-i.x}, ${-i.y})\n          `:void 0},W.createElement("textPath",{xlinkHref:`#textpath-${e.id}`,startOffset:"50%"},e.name)),W.createElement(Xt,{points:e.path.map((e=>`${e.x} ${e.y}`)).join(","),strokeColor:e.strokeColor,fillColor:"none",strokeWidth:1,markerEnd:`url(#marker-${e.id})`}))},[pt.ReachabilityGraphArc]:({element:e})=>{let t={x:0,y:0},n="v";const o=e.path.map((e=>new _(e.x,e.y)));let s=o.reduce(((e,t,n,o)=>n+1<o.length?e+o[n+1].subtract(t).length:e),0)/2;for(let e=0;e<o.length-1;e++){const i=o[e+1].subtract(o[e]);if(i.length>s){const r=i.normalize();n=Math.abs(r.x)>Math.abs(r.y)?"h":"v",t=o[e].add(r.scale(s));break}s-=i.length}const i=e.textColor?{fill:e.textColor}:{};return W.createElement("g",null,W.createElement("marker",{id:`marker-${e.id}`,viewBox:"0 0 30 30",markerWidth:22,markerHeight:30,refX:30,refY:15,orient:"auto",markerUnits:"strokeWidth"},W.createElement(Kt,{d:"M0,29 L30,15 L0,1",fillColor:"none",strokeColor:e.strokeColor})),W.createElement(Xt,{points:e.path.map((e=>`${e.x} ${e.y}`)).join(","),strokeColor:e.strokeColor,fillColor:"none",strokeWidth:1,markerEnd:`url(#marker-${e.id})`}),W.createElement("text",{x:t.x,y:t.y,...(e=>{switch(e){case"v":return{dx:5,dominantBaseline:"middle",textAnchor:"start"};case"h":return{dy:-5,dominantBaseline:"text-after-edge",textAnchor:"middle"}}})(n),pointerEvents:"none",style:{...i}},e.name))},[pt.SyntaxTreeLink]:({element:e})=>W.createElement("g",null,W.createElement(Xt,{points:e.path.map((e=>`${e.x} ${e.y}`)).join(","),strokeColor:e.strokeColor,fillColor:"none",strokeWidth:1})),[pt.FlowchartFlowline]:({element:e})=>{let t={x:0,y:0},n="v";const o=e.path.map((e=>new _(e.x,e.y)));let s=o.reduce(((e,t,n,o)=>n+1<o.length?e+o[n+1].subtract(t).length:e),0)/2;for(let e=0;e<o.length-1;e++){const i=o[e+1].subtract(o[e]);if(i.length>s){const r=i.normalize();n=Math.abs(r.x)>Math.abs(r.y)?"h":"v",t=o[e].add(r.scale(s));break}s-=i.length}const i=e.textColor?{fill:e.textColor}:{};return W.createElement("g",null,W.createElement("marker",{id:`marker-${e.id}`,viewBox:"0 0 30 30",markerWidth:"22",markerHeight:"30",refX:"30",refY:"15",orient:"auto",markerUnits:"strokeWidth"},W.createElement(Kt,{d:"M0,29 L30,15 L0,1",fillColor:"none",strokeColor:e.strokeColor})),W.createElement(Xt,{points:e.path.map((e=>`${e.x} ${e.y}`)).join(","),strokeColor:e.strokeColor,fillColor:"none",strokeWidth:1,markerEnd:`url(#marker-${e.id})`}),W.createElement("text",{x:t.x,y:t.y,...(e=>{switch(e){case"v":return{dx:5,dominantBaseline:"middle",textAnchor:"start"};case"h":return{dy:-5,dominantBaseline:"text-after-edge",textAnchor:"middle"}}})(n),pointerEvents:"none",style:{...i}},e.name))},[pt.BPMNFlow]:({element:e})=>{let t={x:0,y:0},n="vertical";const o=e.path.map((e=>new _(e.x,e.y)));let s=o.reduce(((e,t,n,o)=>n+1<o.length?e+o[n+1].subtract(t).length:e),0)/2;for(let e=0;e<o.length-1;e++){const i=o[e+1].subtract(o[e]);if(i.length>s){const r=i.normalize();n=Math.abs(r.x)>Math.abs(r.y)?"horizontal":"vertical",t=o[e].add(r.scale(s));break}s-=i.length}return W.createElement("g",null,"message"===e.flowType&&W.createElement("marker",{id:`marker-start-${e.id}`,viewBox:"0 0 10 10",markerWidth:10,markerHeight:10,refX:0,refY:0,orient:"auto",markerUnits:"strokeWidth"},W.createElement(nn,{cx:"0%",cy:"0%",r:5,strokeColor:e.fillColor,strokeWidth:1})),("sequence"===e.flowType||"message"===e.flowType)&&W.createElement("marker",{id:`marker-end-${e.id}`,viewBox:"0 0 10 5",markerWidth:10,markerHeight:10,refX:11,refY:5,orient:"auto",markerUnits:"strokeWidth"},W.createElement(Kt,{d:"M0,0 L10,5 L0,10, L0,0 z",fillRule:"evenodd",fillColor:"strokeColor",strokeLinejoin:"round"})),"data association"===e.flowType&&W.createElement("marker",{id:`marker-end-${e.id}`,viewBox:"0 0 10 5",markerWidth:10,markerHeight:10,refX:11,refY:5,orient:"auto",markerUnits:"strokeWidth"},W.createElement(Kt,{d:"M5,0 L10,5 L5,10",fillRule:"evenodd",strokeLinejoin:"round",strokeLinecap:"round",fillColor:"transparent"})),W.createElement(Xt,{points:e.path.map((e=>`${e.x} ${e.y}`)).join(","),strokeColor:e.strokeColor,fillColor:"none",strokeWidth:1,markerStart:"message"===e.flowType?`url(#marker-start-${e.id})`:void 0,markerEnd:"association"!==e.flowType?`url(#marker-end-${e.id})`:void 0,strokeDasharray:"sequence"!==e.flowType?4:void 0}),W.createElement("text",{x:t.x,y:t.y,...(e=>{switch(e){case"vertical":return{dx:5,dominantBaseline:"middle",textAnchor:"start"};case"horizontal":return{dy:-5,dominantBaseline:"text-after-edge",textAnchor:"middle"}}})(n),pointerEvents:"none",style:{fill:e.textColor}},e.name))}},Xs=(0,Do.Zz)(qt.SL,(0,wo.Ng)(((e,t)=>({hovered:e.hovered[0]===t.id,selected:e.selected.includes(t.id),remoteSelectors:e.remoteSelection[t.id]||[],moving:e.moving.includes(t.id),interactive:e.interactive.includes(t.id),interactable:e.editor.view===oo.Exporting||e.editor.view===oo.Highlight,element:e.elements[t.id],zoomFactor:e.editor.zoomFactor,selectionBoxActive:e.editor.selectionBoxActive})),{}));class Ks extends W.Component{render(){const{hovered:e,selected:t,remoteSelectors:n,moving:o,interactive:s,interactable:i,element:r,child:a,children:l,theme:c,zoomFactor:d,selectionBoxActive:h,...u}=this.props;let p=null;he.isUMLContainer(r)&&a&&(p=r.ownedElements.map((e=>W.createElement(a,{key:e,id:e}))));const m=Zs[r.type],g=i&&s?c.interactive.normal:i&&e?c.interactive.hovered:r.highlight?r.highlight:r.fillColor?r.fillColor:c.color.background;return W.createElement("svg",{...u,...r.bounds,pointerEvents:o?"none":void 0,fillOpacity:o?.7:void 0,fill:g},W.createElement(m,{fillColor:g,element:uo.get(r)},p),l,!i&&(e||t)&&W.createElement("rect",{x:-2.5,y:-2.5,width:r.bounds.width+5,height:r.bounds.height+5,fill:"none",stroke:"#0064ff",strokeOpacity:"0.2",strokeWidth:5,pointerEvents:"none"}),n.length>0&&W.createElement("g",null,n.map(((e,t)=>{const n="translate("+(r.bounds.width+5)+" "+32*t+")";return W.createElement("g",{key:e.name+"_"+e.color,id:e.name+"_"+e.color},W.createElement("rect",{x:-2.5,y:-2.5,width:r.bounds.width+5,height:r.bounds.height+5,fill:"none",stroke:e.color,strokeOpacity:"0.2",strokeWidth:5,pointerEvents:"none"}),W.createElement("g",{transform:n,pointerEvents:"none"},W.createElement("rect",{fillOpacity:"0.2",rx:"10",x:"-40",y:"-20",width:"85px",height:"30px",fill:e.color}),W.createElement("text",null,W.createElement("tspan",{textAnchor:"middle"},e.name.length<8?e.name:e.name.substring(0,6)+".."))))}))))}}const Js=Xs(Ks);function ei(e){if(e.changedTouches.length>0){const t=document.elementFromPoint(e.changedTouches[e.changedTouches.length-1].clientX,e.changedTouches[e.changedTouches.length-1].clientY);if(!t)return;const n=new PointerEvent("pointerup",{cancelable:!0,bubbles:!0,screenX:e.changedTouches[e.changedTouches.length-1].pageX,screenY:e.changedTouches[e.changedTouches.length-1].pageY,clientX:e.changedTouches[e.changedTouches.length-1].clientX,clientY:e.changedTouches[e.changedTouches.length-1].clientY});t.dispatchEvent(n)}}function ti(e){return{clientX:e instanceof PointerEvent?e.clientX:e.touches[0].clientX,clientY:e instanceof PointerEvent?e.clientY:e.touches[0].clientY}}const ni={offset:new _,handlerIndex:0,path:[{x:0,y:0}]},oi=(0,Do.Zz)(qt.SL,(0,wo.Ng)(((e,t)=>({hovered:e.hovered[0]===t.id,selected:e.selected.includes(t.id),remoteSelectors:e.remoteSelection[t.id]||[],interactive:e.interactive.includes(t.id),interactable:e.editor.view===oo.Exporting||e.editor.view===oo.Highlight,reconnecting:!!e.reconnecting[t.id],disabled:!!Object.keys(e.reconnecting).length||!!Object.keys(e.connecting).length,relationship:e.elements[t.id],mode:e.editor.mode,readonly:e.editor.readonly||!1,selectionBoxActive:e.editor.selectionBoxActive})),{startwaypointslayout:go.startWaypointsLayout,endwaypointslayout:go.endWaypointsLayout}));class si extends W.Component{constructor(){super(...arguments),this.state=ni,this.onPointerDown=(e,t,n)=>{this.setState({handlerIndex:t,offset:new _(e.clientX-n.mpX,e.clientY-n.mpY)}),document.addEventListener("pointermove",this.onPointerMove),document.addEventListener("pointerup",this.onPointerUp,{once:!0})},this.onPointerMove=e=>{const t=this.state.handlerIndex,n=t%2?"horizontal":"vertical",o=ti(e),s=o.clientX-this.state.offset.x,i=o.clientY-this.state.offset.y;this.updateRelationshipPoints(n,t,s,i)},this.onPointerUp=e=>{this.props.endwaypointslayout(this.props.id),e.currentTarget.removeEventListener("pointermove",this.onPointerMove)},this.updateRelationshipPoints=(e,t,n,o)=>{const s=t+1,i=Number(s)+1,r=this.props.relationship.source.direction;switch(e){case"horizontal":r===Y.Up||r===Y.Down?this.updateXCoordinate(s,i,n,o):this.updateYCoordinate(s,i,n,o);break;case"vertical":r===Y.Up||r===Y.Down?this.updateYCoordinate(s,i,n,o):this.updateXCoordinate(s,i,n,o)}const a=[new _];this.props.relationship.path.forEach((e=>{a.push(new _(e.x,e.y))}));const l=function(e){if(0===e.length)return{x:0,y:0,width:0,height:0};const t=e[0];let n=t.x,o=t.y,s=t.x,i=t.y;for(const t of e)t.x<n&&(n=t.x),t.y<o&&(o=t.y),t.x>s&&(s=t.x),t.y>i&&(i=t.y);return{x:n,y:o,width:s-n,height:i-o}}(a);l.x=this.props.relationship.bounds.x,l.y=this.props.relationship.bounds.y,l.width=20*Math.ceil(l.width/20),l.height=20*Math.ceil(l.height/20),this.setState({path:this.props.relationship.path}),this.props.startwaypointslayout(this.props.id,this.props.relationship.path,l)},this.updateXCoordinate=(e,t,n,o)=>{this.props.relationship.path[e].x=n,this.props.relationship.path[t].x=n},this.updateYCoordinate=(e,t,n,o)=>{this.props.relationship.path[e].y=o,this.props.relationship.path[t].y=o}}render(){const{hovered:e,selected:t,remoteSelectors:n,interactive:o,interactable:s,reconnecting:i,disabled:r,relationship:a,children:l,theme:c,mode:d,readonly:h,startwaypointslayout:u,endwaypointslayout:p,selectionBoxActive:m,...g}=this.props,y=d===no.Assessment?35:15,f=Zs[a.type],C=a.path.map((e=>`${e.x} ${e.y}`)).join(","),E=[];a.path.map(((e,t)=>{const n=(a.path[t].x+a.path[t+1]?.x)/2,o=(a.path[t].y+a.path[t+1]?.y)/2;isNaN(n)||isNaN(o)||E.push({mpX:n,mpY:o})})),E.pop(),E.shift();const b=s&&o?c.interactive.normal:s&&e?c.interactive.hovered:e||t?"rgba(0, 100, 255, 0.2)":a.highlight?a.highlight:"rgba(0, 100, 255, 0)";return W.createElement("svg",{...g,...a.bounds,visibility:i?"hidden":void 0,pointerEvents:r?"none":"stroke"},W.createElement("polyline",{points:C,stroke:b,fill:"none",strokeWidth:y}),n.length>0&&n.map((e=>W.createElement("polyline",{key:e.name,points:C,stroke:e.color,strokeOpacity:"0.2",strokeWidth:y,fill:"none"}))),W.createElement(f,{element:go.get(a)}),l,E.map(((e,t)=>W.createElement("circle",{visibility:m||o||s||h?"hidden":void 0,pointerEvents:m||o||s||h?"none":"all",style:{cursor:"grab"},key:g.id+"_"+e.mpX+"_"+e.mpY,cx:e.mpX,cy:e.mpY,r:"15",onPointerDown:n=>{this.onPointerDown(n,t,e)},fill:b}))))}}const ii=oi(si),ri=(0,wo.Ng)(((e,t)=>({hovered:e.hovered[0]===t.id,selected:e.selected.includes(t.id),connecting:!!e.connecting.length,reconnecting:!!Object.keys(e.reconnecting).length,element:e.elements[t.id],type:e.elements[t.id].type})),{start:uo.startConnecting,connect:uo.connect,reconnect:go.reconnect}),ai=_t((e=>{const{alternativePortVisualization:t,...n}=e;return t?W.createElement("svg",{...n},W.createElement("path",{d:"M 2.5 0 v -10 h -5 v 10 Z"}),W.createElement("path",{d:"M -15 -25 a 15 15 0 0 1 30 0 a 15 15 0 0 1 -30 0"})):W.createElement("svg",{...n},W.createElement("path",{d:"M -20 0 A 10 10 0 0 1 20 0"}))})).attrs((({direction:e,ports:t})=>({fill:"#0064ff",fillOpacity:.2,x:`${t[e].x}px`,y:`${t[e].y}px`,rotate:e===Y.Up||e===Y.Topright||e===Y.Topleft?0:e===Y.Right||e===Y.Upright||e===Y.Downright?90:e===Y.Down||e===Y.Bottomright||e===Y.Bottomleft?180:-90})))`
  cursor: crosshair;
  pointer-events: all;

  path {
    transform: rotate(${e=>e.rotate}deg);
  }
`,li=e=>{class t extends W.Component{constructor(){super(...arguments),this.elementOnPointerUp=e=>{const t=(0,ko.findDOMNode)(this);if(!(e instanceof PointerEvent))return void ei(e);let n;if(e.target instanceof SVGElement&&null!=e.target.parentElement&&e.target.parentElement.hasAttribute("direction")&&(n=e.target.parentElement.getAttribute("direction")),null==n){const o=t.getBoundingClientRect(),s={x:(e.clientX-o.left)/o.width,y:(e.clientY-o.top)/o.height},i={[Y.Up]:new _(.5,0),[Y.Right]:new _(1,.5),[Y.Down]:new _(.5,1),[Y.Left]:new _(0,.5),[Y.Upright]:new _(1,.25),[Y.Downright]:new _(1,.75),[Y.Upleft]:new _(0,.25),[Y.Downleft]:new _(0,.75),[Y.Topright]:new _(.75,0),[Y.Bottomright]:new _(.75,1),[Y.Topleft]:new _(.25,0),[Y.Bottomleft]:new _(.25,1)},r=K(this.props.element),a=Object.entries(r).map((([e,t])=>({key:e,distance:Math.sqrt(Math.pow(i[e].x-s.x,2)+Math.pow(i[e].y-s.y,2))}))),l=Math.min(...a.map((e=>e.distance)));n=a.filter((e=>l===e.distance))[0].key}this.props.connecting&&this.props.connect({element:this.props.id,direction:n}),this.props.reconnecting&&!e.defaultPrevented&&(this.props.reconnect({element:this.props.id,direction:n}),e.preventDefault())},this.onPointerDown=e=>{const t=e.currentTarget.getAttribute("direction"),n=e.currentTarget.parentElement.getAttribute("id");this.props.start(t,n)},this.onPointerUp=e=>{const t=e.currentTarget.getAttribute("direction");this.props.connecting&&this.props.connect({element:this.props.id,direction:t}),this.props.reconnecting&&this.props.reconnect({element:this.props.id,direction:t})}}componentDidMount(){const e=(0,ko.findDOMNode)(this);e.addEventListener("pointerup",this.elementOnPointerUp.bind(this)),Fo()({tablet:!0})&&e.addEventListener("touchend",this.elementOnPointerUp.bind(this))}componentWillUnmount(){const e=(0,ko.findDOMNode)(this);e.removeEventListener("pointerup",this.elementOnPointerUp),Fo()({tablet:!0})&&e.removeEventListener("touchend",this.elementOnPointerUp)}render(){const{hovered:t,selected:n,connecting:o,reconnecting:s,start:i,connect:r,reconnect:a,type:l,element:c,...d}=this.props,h={...ut,...Pn}[l].features,u=K(c);return W.createElement(e,{...d},d.children,(t||n||o||s)&&W.createElement(W.Fragment,null,"ActivityForkNode"!==this.props.type&&W.createElement(ai,{ports:u,direction:Y.Up,onPointerDown:this.onPointerDown,onPointerUp:this.onPointerUp,alternativePortVisualization:h.alternativePortVisualization}),"ActivityForkNodeHorizontal"!==this.props.type&&W.createElement(ai,{ports:u,direction:Y.Right,onPointerDown:this.onPointerDown,onPointerUp:this.onPointerUp,alternativePortVisualization:h.alternativePortVisualization}),"ActivityForkNode"!==this.props.type&&W.createElement(ai,{ports:u,direction:Y.Down,onPointerDown:this.onPointerDown,onPointerUp:this.onPointerUp,alternativePortVisualization:h.alternativePortVisualization}),"ActivityForkNodeHorizontal"!==this.props.type&&W.createElement(ai,{ports:u,direction:Y.Left,onPointerDown:this.onPointerDown,onPointerUp:this.onPointerUp,alternativePortVisualization:h.alternativePortVisualization}),"ActivityForkNode"===this.props.type&&this.props.element.bounds.height>120&&W.createElement(W.Fragment,null,W.createElement(ai,{ports:u,direction:Y.Upright,onPointerDown:this.onPointerDown,onPointerUp:this.onPointerUp,alternativePortVisualization:h.alternativePortVisualization}),W.createElement(ai,{ports:u,direction:Y.Upleft,onPointerDown:this.onPointerDown,onPointerUp:this.onPointerUp,alternativePortVisualization:h.alternativePortVisualization}),W.createElement(ai,{ports:u,direction:Y.Downright,onPointerDown:this.onPointerDown,onPointerUp:this.onPointerUp,alternativePortVisualization:h.alternativePortVisualization}),W.createElement(ai,{ports:u,direction:Y.Downleft,onPointerDown:this.onPointerDown,onPointerUp:this.onPointerUp,alternativePortVisualization:h.alternativePortVisualization})),"ActivityForkNodeHorizontal"===this.props.type&&this.props.element.bounds.width>120&&W.createElement(W.Fragment,null,W.createElement(ai,{ports:u,direction:Y.Topright,onPointerDown:this.onPointerDown,onPointerUp:this.onPointerUp,alternativePortVisualization:h.alternativePortVisualization}),W.createElement(ai,{ports:u,direction:Y.Topleft,onPointerDown:this.onPointerDown,onPointerUp:this.onPointerUp,alternativePortVisualization:h.alternativePortVisualization}),W.createElement(ai,{ports:u,direction:Y.Bottomright,onPointerDown:this.onPointerDown,onPointerUp:this.onPointerUp,alternativePortVisualization:h.alternativePortVisualization}),W.createElement(ai,{ports:u,direction:Y.Bottomleft,onPointerDown:this.onPointerDown,onPointerUp:this.onPointerUp,alternativePortVisualization:h.alternativePortVisualization}))))}}return ri(t)},ci=e=>class extends W.Component{render(){return W.createElement(Po,{owner:this.props.id},W.createElement(e,{...this.props}))}},di=(0,wo.Ng)(((e,t)=>({cannotBeHovered:e.editor.selectionBoxActive||e.moving.length>0&&!he.isUMLContainer(e.elements[t.id])})),{hover:uo.hover,leave:uo.leave}),hi=e=>{class t extends W.Component{constructor(){super(...arguments),this.enter=e=>{this.props.cannotBeHovered||this.props.hover(this.props.id),e.stopPropagation()},this.leave=e=>{this.props.cannotBeHovered||this.props.leave(this.props.id),e.stopPropagation()}}componentDidMount(){const e=(0,ko.findDOMNode)(this);e.addEventListener("pointerenter",this.enter),e.addEventListener("pointerleave",this.leave)}componentWillUnmount(){const e=(0,ko.findDOMNode)(this);e.removeEventListener("pointerenter",this.enter),e.removeEventListener("pointerleave",this.leave)}render(){const{hover:t,leave:n,cannotBeHovered:o,...s}=this.props;return W.createElement(e,{...s})}}return di(t)},ui=(0,wo.Ng)(((e,t)=>({hovered:e.hovered[0]===t.id,selected:e.interactive.includes(t.id)})),{select:uo.makeInteractive,deselect:uo.unmakeInteractive}),pi=e=>{class t extends W.Component{constructor(){super(...arguments),this.select=e=>{e.which&&1!==e.which||!this.props.hovered||(this.props.selected?this.props.deselect(this.props.id):this.props.select(this.props.id))}}componentDidMount(){(0,ko.findDOMNode)(this).addEventListener("pointerdown",this.select)}componentWillUnmount(){(0,ko.findDOMNode)(this).removeEventListener("pointerdown",this.select)}render(){const{hovered:t,selected:n,select:o,deselect:s,...i}=this.props;return W.createElement(e,{...i})}}return ui(t)};function mi(e,t=0){let n;return function(...o){const s=this;clearTimeout(n),n=window.setTimeout((()=>e.apply(s,o)),t>0?t:300)}}const gi={offset:new _},yi=(0,wo.Ng)(((e,t)=>({movable:e.selected.includes(t.id)&&!e.resizing.includes(t.id)&&!e.connecting.length,moving:e.moving.includes(t.id),zoomFactor:e.editor.zoomFactor,selectionBoxActive:e.editor.selectionBoxActive})),{start:uo.startMoving,move:uo.move,end:uo.endMoving}),fi=e=>{class t extends W.Component{constructor(){super(...arguments),this.state=gi,this.moveWindow={x:0,y:0},this.move=(e,t)=>{const{zoomFactor:n=1}=this.props;e=10*Math.round(e/10),t=10*Math.round(t/10),0===e&&0===t||(this.setState((o=>({offset:o.offset.add(e*n,t*n)}))),this.moveWindow={x:this.moveWindow.x+e,y:this.moveWindow.y+t},this.debouncedMove(this.moveWindow))},this.debouncedMove=mi((()=>{this.props.move(this.moveWindow),this.moveWindow={x:0,y:0}}),2),this.onPointerDown=e=>{const{zoomFactor:t=1}=this.props;if(e.which&&1!==e.which)return;const n=ti(e);this.setState({offset:new _(n.clientX,n.clientY)}),Fo()({tablet:!0})?(document.addEventListener("touchmove",this.onPointerMove),document.addEventListener("touchend",this.onPointerUp,{once:!0})):(document.addEventListener("pointermove",this.onPointerMove),document.addEventListener("pointerup",this.onPointerUp,{once:!0})),setTimeout((()=>!this.props.movable&&this.onPointerUp()),0)},this.onPointerMove=e=>{const{zoomFactor:t=1}=this.props,n=ti(e),o=(n.clientX-this.state.offset.x)/t,s=(n.clientY-this.state.offset.y)/t;this.props.moving?this.move(o,s):(Math.abs(o)>5||Math.abs(s)>5)&&this.props.start()},this.onPointerUp=()=>{Fo()({tablet:!0})?document.removeEventListener("touchmove",this.onPointerMove):document.removeEventListener("pointermove",this.onPointerMove),this.props.moving&&(this.setState(gi),this.props.end())}}componentDidMount(){const e=(0,ko.findDOMNode)(this);e.style.cursor="move";const t=e.firstChild;Fo()({tablet:!0})?t.addEventListener("touchstart",this.onPointerDown):t.addEventListener("pointerdown",this.onPointerDown)}componentDidUpdate(e,t,n){const o=(0,ko.findDOMNode)(this);this.props.selectionBoxActive?o.style.cursor="default":o.style.cursor="move"}componentWillUnmount(){const e=(0,ko.findDOMNode)(this).firstChild;Fo()({tablet:!0})?(e.removeEventListener("touchstart",this.onPointerDown),document.removeEventListener("touchmove",this.onPointerMove),document.removeEventListener("touchend",this.onPointerUp)):(e.removeEventListener("pointerdown",this.onPointerDown),document.removeEventListener("pointermove",this.onPointerMove),document.removeEventListener("pointerup",this.onPointerUp))}render(){const{movable:t,zoomFactor:n,start:o,move:s,end:i,...r}=this.props;return W.createElement(e,{...r})}}return yi(t)},Ci={offset:new _,endpoint:null},Ei=(0,wo.Ng)(((e,t)=>({path:e.elements[t.id].path,reconnecting:!!e.reconnecting[t.id],disabled:!!Object.keys(e.reconnecting).length||!!Object.keys(e.connecting).length,selectionBoxActive:e.editor.selectionBoxActive})),{start:go.startReconnecting,reconnect:go.reconnect}),bi=_t.line.attrs({strokeWidth:15,strokeOpacity:0,stroke:"black"})`
  cursor: move;
`,vi=e=>{class t extends W.Component{constructor(){super(...arguments),this.state=Ci,this.onPointerDown=e=>{if(e.nativeEvent.which&&1!==e.nativeEvent.which)return;const t=e.currentTarget.dataset.endpoint;this.setState({endpoint:t,offset:new _(e.clientX,e.clientY)}),Fo()({tablet:!0})?(document.addEventListener("touchmove",this.onPointerMove),document.addEventListener("touchend",this.onPointerUp,{once:!0}),document.addEventListener("pointerup",this.onPointerUp,{once:!0})):(document.addEventListener("pointermove",this.onPointerMove),document.addEventListener("pointerup",this.onPointerUp,{once:!0}))},this.onPointerMove=e=>{const t=ti(e),n=t.clientX-this.state.offset.x,o=t.clientY-this.state.offset.y,{endpoint:s}=this.state;!this.props.reconnecting&&s&&(Math.abs(n)>5||Math.abs(o)>5)&&this.props.start(s)},this.onPointerUp=e=>{e instanceof PointerEvent?(Fo()({tablet:!0})?document.removeEventListener("touchmove",this.onPointerMove):document.removeEventListener("pointermove",this.onPointerMove),this.cancel()):ei(e)},this.cancel=()=>{this.props.reconnecting&&this.setState(Ci)},this.composePath=e=>{const t=new Wo(e),n=Math.min(t.length/2,40);return[e[0],t.position(n)]}}componentWillUnmount(){Fo()({tablet:!0})?(document.removeEventListener("touchmove",this.onPointerMove),document.removeEventListener("touchend",this.onPointerUp),document.removeEventListener("pointerup",this.onPointerUp)):(document.removeEventListener("pointermove",this.onPointerMove),document.removeEventListener("pointerup",this.onPointerUp)),this.cancel()}render(){const{path:t,reconnecting:n,start:o,reconnect:s,disabled:i,selectionBoxActive:r,...a}=this.props,l=this.composePath(t),c=this.composePath([...t].reverse());return W.createElement(e,{...a},a.children,W.createElement(bi,{x1:l[0].x,y1:l[0].y,x2:l[1].x,y2:l[1].y,onPointerDown:this.onPointerDown,"data-endpoint":"target",pointerEvents:r||i?"none":"all"}),W.createElement(bi,{x1:c[0].x,y1:c[0].y,x2:c[1].x,y2:c[1].y,onPointerDown:this.onPointerDown,"data-endpoint":"source",pointerEvents:r||i?"none":"all"}))}}return Ei(t)},wi={resizing:!1,offset:new _},ki=(0,wo.Ng)((e=>({zoomFactor:e.editor.zoomFactor,selectionBoxActive:e.editor.selectionBoxActive})),{start:uo.startResizing,resize:uo.resize,end:uo.endResizing}),xi={width:15,height:15,transform:"translate(-10, -10)",fill:"none"},Mi=_t.rect.attrs({x:"100%",y:"100%",...xi})`
  cursor: nwse-resize;
`,Si=_t.rect.attrs({x:"0%",y:"0%",...xi})`
  cursor: nwse-resize;
`,Ii=_t.rect.attrs({x:"100%",y:"0%",...xi})`
  cursor: nesw-resize;
`,Ti=_t.rect.attrs({x:"0%",y:"100%",...xi})`
  cursor: nesw-resize;
`,Pi=e=>t=>{class n extends W.Component{constructor(){super(...arguments),this.state=wi,this.resize=(t,n,o)=>{t=10*Math.round(t/10),n=10*Math.round(n/10),e&&e.preventX&&(t=0),e&&e.preventY&&(n=0),0===t&&0===n||(this.setState((e=>({offset:e.offset.add(t,n)}))),this.props.resize({width:t,height:n},o,this.props.id))},this.onPointerDown=(e,t)=>{if(e.nativeEvent.which&&1!==e.nativeEvent.which)return;let n=new _;switch(t){case Z.BOTTOMRIGHT:n=new _(e.clientX,e.clientY);break;case Z.TOPLEFT:n=new _(-e.clientX,-e.clientY);break;case Z.TOPRIGHT:n=new _(e.clientX,-e.clientY);break;case Z.BOTTOMLEFT:n=new _(-e.clientX,e.clientY)}this.setState({resizing:!0,offset:n.scale(1/this.props.zoomFactor)}),this.props.start(this.props.id);const o=e.currentTarget;o.setPointerCapture(e.pointerId),o.addEventListener("pointermove",this.onPointerMove),o.setAttribute("resizeFrom",t),o.addEventListener("pointerup",this.onPointerUp,{once:!0})},this.onPointerMove=e=>{const t=e.currentTarget.getAttribute("resizeFrom");let n=0,o=0;switch(t){case Z.BOTTOMRIGHT:n=e.clientX/this.props.zoomFactor-this.state.offset.x,o=e.clientY/this.props.zoomFactor-this.state.offset.y;break;case Z.TOPLEFT:n=-e.clientX/this.props.zoomFactor-this.state.offset.x,o=-e.clientY/this.props.zoomFactor-this.state.offset.y;break;case Z.TOPRIGHT:n=e.clientX/this.props.zoomFactor-this.state.offset.x,o=-e.clientY/this.props.zoomFactor-this.state.offset.y;break;case Z.BOTTOMLEFT:n=-e.clientX/this.props.zoomFactor-this.state.offset.x,o=e.clientY/this.props.zoomFactor-this.state.offset.y}this.resize(n,o,t),e.stopPropagation()},this.onPointerUp=e=>{const t=e.currentTarget;t&&(t.releasePointerCapture(e.pointerId),t.removeEventListener("pointermove",this.onPointerMove),this.setState(wi),this.props.end(this.props.id),e.stopPropagation())}}componentWillUnmount(){document.removeEventListener("pointermove",this.onPointerMove),document.removeEventListener("pointerup",this.onPointerUp)}render(){const{start:e,resize:n,end:o,selectionBoxActive:s,...i}=this.props;return W.createElement(t,{...i},i.children,W.createElement(Mi,{onPointerDown:e=>{this.onPointerDown(e,Z.BOTTOMRIGHT)},pointerEvents:s?"none":"all"}),W.createElement(Si,{onPointerDown:e=>{this.onPointerDown(e,Z.TOPLEFT)},pointerEvents:s?"none":"all"}),W.createElement(Ii,{onPointerDown:e=>{this.onPointerDown(e,Z.TOPRIGHT)},pointerEvents:s?"none":"all"}),W.createElement(Ti,{onPointerDown:e=>{this.onPointerDown(e,Z.BOTTOMLEFT)},pointerEvents:s?"none":"all"}))}}return ki(n)},Di=(0,wo.Ng)(((e,t)=>({hovered:e.hovered[0]===t.id,selected:e.selected.includes(t.id)})),{select:uo.select,deselect:uo.deselect}),Ai=e=>{class t extends W.Component{constructor(){super(...arguments),this.select=e=>{e.which&&1!==e.which||!this.props.hovered||(e.shiftKey&&this.props.selected?this.props.deselect(this.props.id):this.props.selected||(e.shiftKey||this.props.deselect(),this.props.select(this.props.id)))}}componentDidMount(){(0,ko.findDOMNode)(this).addEventListener("pointerdown",this.select)}componentWillUnmount(){(0,ko.findDOMNode)(this).removeEventListener("pointerdown",this.select)}render(){const{hovered:t,selected:n,select:o,deselect:s,...i}=this.props;return W.createElement(e,{...i})}}return Di(t)},Li=_t.g.attrs((e=>({...e})))`
  transition: all 180ms ease-in-out;
  pointer-events: all;

  path {
    pointer-events: all;
    fill: var(--apollon-primary-contrast);
  }
  rect {
    pointer-events: all;
    fill: var(--apollon-background);
    stroke: var(--apollon-gray);
  }
  :hover {
    transform: translate(0px, -30px);
  }
  :active {
    transform: translate(0px, -30px);
  }
  :hover rect {
    fill: var(--apollon-gray);
    stroke: var(--apollon-gray-variant);
  }
  :active rect {
    fill: var(--apollon-gray);
    stroke: var(--apollon-gray-variant);
  }
`,Ri=({children:e,...t})=>W.createElement(Li,{...t},W.createElement("rect",{height:30,width:30,rx:"0.25rem",ry:"0.25rem"}),e),Ni=e=>W.createElement("svg",{...e,height:20,width:20},W.createElement("path",{d:"M2.39999 13.6H3.53999L11.36 5.77999L10.22 4.63999L2.39999 12.46V13.6ZM0.799988 15.2V11.8L11.36 1.25999C11.52 1.11332 11.6967 0.999988 11.89 0.919988C12.0833 0.839988 12.2867 0.799988 12.5 0.799988C12.7133 0.799988 12.92 0.839988 13.12 0.919988C13.32 0.999988 13.4933 1.11999 13.64 1.27999L14.74 2.39999C14.9 2.54665 15.0167 2.71999 15.09 2.91999C15.1633 3.11999 15.2 3.31999 15.2 3.51999C15.2 3.73332 15.1633 3.93665 15.09 4.12999C15.0167 4.32332 14.9 4.49999 14.74 4.65999L4.19999 15.2H0.799988ZM10.78 5.21999L10.22 4.63999L11.36 5.77999L10.78 5.21999Z"})),Bi=e=>W.createElement("svg",{...e,height:20,width:20},W.createElement("path",{d:"M4.66666 14C4.29999 14 3.9861 13.8694 3.72499 13.6083C3.46388 13.3472 3.33332 13.0333 3.33332 12.6667V4H2.66666V2.66667H5.99999V2H9.99999V2.66667H13.3333V4H12.6667V12.6667C12.6667 13.0333 12.5361 13.3472 12.275 13.6083C12.0139 13.8694 11.7 14 11.3333 14H4.66666ZM11.3333 4H4.66666V12.6667H11.3333V4ZM5.99999 11.3333H7.33332V5.33333H5.99999V11.3333ZM8.66666 11.3333H9.99999V5.33333H8.66666V11.3333Z"})),Oi={},$i=(0,wo.Ng)(((e,t)=>({hovered:e.hovered[0]===t.id,selected:e.selected.includes(t.id)})),{updateStart:uo.updateStart,deleteElement:uo.delete,getElementById:uo.getById,getRelationshipById:go.getById}),Ui=e=>{class t extends W.Component{constructor(){super(...arguments),this.state=Oi,this.onStartUpdate=()=>{this.props.updateStart(this.props.id)},this.onDelete=()=>{this.props.deleteElement(this.props.id)}}componentDidMount(){(0,ko.findDOMNode)(this).addEventListener("dblclick",this.onStartUpdate)}componentWillUnmount(){(0,ko.findDOMNode)(this).removeEventListener("dblclick",this.onStartUpdate)}findRightmostPoint(e){let t;for(const n of e)(void 0===t||n.x>t.x)&&(t=n);return t}getContextActionBaseCoordinates(e){if(!Qt.isUMLRelationship(e))return{x:e.bounds.width,y:-30};const t=e,n=this.findRightmostPoint(t.path);return{x:(n?.x??0)-40,y:(n?.y??0)-30}}render(){const{updateStart:t,deleteElement:n,getElementById:o,getRelationshipById:s,hovered:i,selected:r,...a}=this.props,l=o(a.id),c=s(a.id),d=this.getContextActionBaseCoordinates(l||c);return W.createElement(e,{...a},W.createElement(Ri,{style:{opacity:r?1:0,transform:`translate(${d.x}px, ${r?d.y-10:d.y}px)`},onClick:this.onStartUpdate},W.createElement(Ni,{x:7,y:7})),W.createElement(Ri,{style:{opacity:r?1:0,transform:`translate(${d.x}px, ${r?d.y-50:d.y}px)`},onClick:this.onDelete},W.createElement(Bi,{x:7,y:7})))}}return $i(t)},Fi=(0,wo.Ng)(((e,t)=>({features:e.editor.features,type:e.elements[t.id].type,readonly:e.editor.readonly,view:e.editor.view,mode:e.editor.mode}))),zi=e=>{const t={...ut,...Pn}[e.type].features,n=e.type in pt?ii:Js,o=[];if(e.mode===no.Assessment)o.push(ss,Ui,Ai,hi);else if(e.readonly)o.push(Ai,hi);else if(e.view===oo.Exporting||e.view===oo.Highlight)o.push(pi,hi);else if(e.view===oo.Modelling){if(e.features.hoverable&&t.hoverable&&o.push(hi),t.reconnectable&&o.push(vi),e.features.selectable&&t.selectable&&o.push(Ai),e.features.movable&&t.movable&&o.push(fi),e.features.resizable&&t.resizable){const e={preventY:"WIDTH"===t.resizable,preventX:"HEIGHT"===t.resizable};o.push(Pi(e))}e.features.connectable&&t.connectable&&o.push(li),e.features.updatable&&t.updatable&&o.push(Ui),e.features.droppable&&t.droppable&&o.push(ci)}return{component:(0,Do.Zz)(...o.reverse())(n)}};class Hi extends W.Component{constructor(){super(...arguments),this.state=zi(this.props)}componentDidUpdate(e){e!==this.props&&this.setState(zi(this.props))}render(){const{component:e}=this.state;return W.createElement(e,{id:this.props.id,child:ji})}}const ji=Fi(Hi),Qi=_t.svg.attrs({tabIndex:-1})`
  position: ${({isStatic:e})=>e?"static":"absolute"};
  top: 0;
  left: 0;
  min-width: 100%;
  min-height: 100%;
  outline: none;
  overflow: visible;
  transform-origin: center center;
  fill: white;
`,Wi=(0,wo.Ng)((e=>({diagram:e.diagram,isStatic:e.editor.readonly,elements:e.elements})),null,null,{forwardRef:!0});class Gi extends W.Component{constructor(){super(...arguments),this.layer=(0,W.createRef)(),this.origin=()=>{if(!this.layer.current)return new _;const e=this.layer.current.getBoundingClientRect();return new _(e.left+e.width/2,e.top+e.height/2)},this.snap=e=>{const t=this.origin();return e.subtract(t).round().add(t)}}render(){const{elements:e,diagram:t,isStatic:n}=this.props;let o=0,s=0;if(n){for(const t of Object.values(e))if(Qt.isUMLRelationship(t))for(const e of t.path)e.x<o&&(o=e.x),e.y<s&&(s=e.y);o=Math.abs(Math.round(o)),s=Math.abs(Math.round(s))}return W.createElement(Po,null,W.createElement(Qi,{id:"modeling-editor-canvas",width:t.bounds.width+o,height:t.bounds.height+s,isStatic:n,ref:this.layer,"data-cy":"modeling-editor-canvas"},W.createElement("g",{style:{transformOrigin:"top left",transform:"translate("+o/2+"px,"+s/2+"px)"}},this.layer.current&&W.createElement("svg",{x:"50%",y:"50%"},t.ownedElements.map((e=>W.createElement(ji,{key:e,id:e}))),t.ownedRelationships.map((e=>W.createElement(ji,{key:e,id:e}))),W.createElement(Qo,null)))))}}const qi=Wi(Gi);class _i{}_i.changeView=e=>({type:so.CHANGE_VIEW,payload:{view:e},undoable:!1}),_i.setZoomFactor=e=>({type:so.SET_ZOOM_FACTOR,payload:{zoomFactor:e},undoable:!1}),_i.setSelectionBoxActive=e=>({type:so.SET_SELECTION_BOX,payload:{selectionBoxActive:e},undoable:!1});const Vi=(e,t,n)=>Math.max(t,Math.min(e,n)),Yi=_t.button`
  background: var(--apollon-background);
  color: var(--apollon-primary-contrast);
  border: 1px solid var(--apollon-gray);
  margin: 0;
  outline: none;
  border-radius: 0.25rem;
  width: 2.25em;
  height: 2.25em;
  display: flex;
  align-items: center;
  justify-content: center;

  :hover {
    background-color: var(--apollon-gray);
    border-color: var(--apollon-gray-variant);
  }

  :active {
    background-color: var(--apollon-gray);
    border-color: var(--apollon-gray-variant);
  }
`,Zi=e=>{const{min:t=.5,max:n=5,step:o=.5,value:s,onChange:i,style:r}=e;return W.createElement("div",{style:{display:"flex",flexDirection:"column",position:"absolute",right:"0.75em",bottom:"0.75em",...r}},W.createElement(Yi,{style:{marginBottom:"0.5em"},onClick:()=>i(Vi(s+o,t,n))},"+"),W.createElement(Yi,{onClick:()=>i(Vi(s-o,t,n))},"-"))},Xi=_t.div`
  display: block;
  overflow: auto;

  position: relative;
  min-height: inherit;
  max-height: inherit;

  width: ${e=>Vi(100/e.scale,100,200)}%;
  height: ${e=>Vi(100/e.scale,100,200)}%;

  -ms-overflow-style: -ms-autohiding-scrollbar;
  border: ${1}px solid ${e=>e.theme.color.gray};
  background-position: calc(50% + ${24.5}px)
    calc(50% + ${24.5}px);
  background-size:
    ${50}px ${50}px,
    ${50}px ${50}px,
    ${10}px ${10}px,
    ${10}px ${10}px;
  background-image: linear-gradient(to right, ${e=>e.theme.color.grid} 1px, transparent 1px),
    linear-gradient(to bottom, ${e=>e.theme.color.grid} 1px, transparent 1px),
    linear-gradient(to right, ${e=>e.theme.color.gray} 1px, transparent 1px),
    linear-gradient(to bottom, ${e=>e.theme.color.gray} 1px, transparent 1px);
  background-repeat: repeat;
  background-attachment: local;
  transition:
    transform 500ms,
    width 500ms,
    height 500ms;
  transform-origin: top left;
  transform: scale(${e=>e.scale??1});
`,Ki=(0,wo.Ng)((e=>({moving:[...e.moving],connecting:e.connecting.length>0,reconnecting:Object.keys(e.reconnecting).length>0,scale:e.editor.zoomFactor})),{move:uo.move,setZoomFactor:_i.setZoomFactor}),Ji=100;class er extends W.Component{constructor(){super(...arguments),this.state={scrollingDisabled:!1,gestureStartZoomFactor:1,isMobile:Fo()({tablet:!0})},this.editor=(0,W.createRef)(),this.zoomContainer=(0,W.createRef)(),this.customScrolling=e=>{const{scale:t=1}=this.props;if(this.editor.current){const n=this.editor.current.getBoundingClientRect(),o=e.touches[e.touches.length-1],s=o.clientX*t<n.x+Ji?-5:o.clientX*t>n.x+n.width-Ji?5:0,i=o.clientY*t<n.y+Ji?-5:o.clientY*t>n.y+n.height-Ji?5:0;this.editor.current.scrollBy(s,i),this.props.moving&&this.props.move({x:s,y:i},this.props.moving)}e.preventDefault(),e.stopPropagation()},this.activateScrolling=e=>{e&&(e.style.overflow="auto",document.body.style.overflowY="auto",e.style.overscrollBehavior="auto",this.setState({scrollingDisabled:!1}))},this.deactivateScrolling=e=>{e&&(e.style.overflow="hidden",document.body.style.overflowY="hidden",e.style.overscrollBehavior="none",this.setState({scrollingDisabled:!0}))}}componentDidMount(){window.addEventListener("wheel",(e=>{e.ctrlKey&&e.preventDefault()}),{passive:!1})}componentDidUpdate(e,t,n){if(this.state.isMobile&&this.editor.current){const{moving:e,connecting:t,reconnecting:n}=this.props,o=e.length>0||t||n;o&&!this.state.scrollingDisabled?this.deactivateScrolling(this.editor.current):!o&&this.state.scrollingDisabled&&this.activateScrolling(this.editor.current)}}render(){const{moving:e,connecting:t,reconnecting:n,scale:o=1,...s}=this.props;return this.state.isMobile?W.createElement("div",{ref:this.zoomContainer,style:{width:"100%",overflow:o>1?"auto":"hidden"}},W.createElement(Xi,{ref:this.editor,...s,onTouchMove:this.customScrolling,scale:o}),W.createElement(Zi,{value:o,onChange:e=>this.props.setZoomFactor(e),min:.5,max:5,step:.2})):W.createElement("div",{ref:this.zoomContainer,style:{width:"100%",overflow:o>1?"auto":"hidden"}},W.createElement(Xi,{ref:this.editor,...s,scale:o}),W.createElement(Zi,{value:o,onChange:e=>this.props.setZoomFactor(e),min:.5,max:5,step:.2}))}}const tr=Ki(er);var nr,or;!function(e){e.COPY="@@copy/COPY",e.PASTE="@@copy/PASTE"}(nr||(nr={}));class sr{static transformElementsForCopy(e){const t=e.filter((t=>!t.owner||e.every((e=>e.id!==t.owner)))),n={};return{copiedElements:t.reduce(((t,o)=>{o.owner=null,o.bounds.x=o.bounds.x+10*sr.pasteCounter,o.bounds.y=o.bounds.y+10*sr.pasteCounter;const s=Ln(o,e);return n[o.id]=s[0].id,t.concat(...s)}),[]).map((e=>({...e}))),cloneMap:n}}static transformRelationshipsForCopy(e,t){return e.filter((t=>!t.owner||e.every((e=>e.id!==t.owner)))).reduce(((e,n)=>{n.owner=null,n.bounds.x=n.bounds.x+10*sr.pasteCounter,n.bounds.y=n.bounds.y+10*sr.pasteCounter,n.source.element=t[n.source.element],n.target.element=t[n.target.element];const o=n.path.map((e=>({x:e.x+10,y:e.y+10})));n.path=[o[0],o[1],...o.slice(2)];const s=[n.cloneRelationship()];return e.concat(...s)}),[]).map((e=>({...e})))}}sr.pasteCounter=0,sr.copy=e=>(t,n)=>{sr.pasteCounter=0;const{elements:o,selected:s}=n(),i=An(e?Array.isArray(e)?e:[e]:s,n().elements),r=i.map((e=>uo.get(o[e]))).filter(po);return n().editor.enableCopyPasteToClipboard?void navigator.clipboard.writeText(JSON.stringify(r)):t({type:nr.COPY,payload:i,undoable:!1})},sr.paste=()=>(e,t)=>{if(sr.pasteCounter++,t().editor.enableCopyPasteToClipboard)navigator.clipboard.readText().then((e=>{const n=JSON.parse(e),o=t().diagram.type,s=n.map((e=>uo.get(e))).filter(po).filter((e=>e.type in H[o]));return sr.transformElementsForCopy(s)})).then((({copiedElements:n})=>{e(uo.create(n)),e(uo.deselect()),e(uo.select(Dn(n.map((e=>e.id)),t().elements)))}));else{const{copy:n}=t();e({type:nr.PASTE,payload:{},undoable:!1});const{elements:o}=t(),s=n.map((e=>uo.get(o[e]))).filter(po),i=n.map((e=>go.get(o[e]))).filter(po).filter((e=>e.source&&e.target&&n.includes(e.source.element)&&n.includes(e.target.element))),{copiedElements:r,cloneMap:a}=sr.transformElementsForCopy(s);e(uo.create(r)),e(uo.deselect());const l=sr.transformRelationshipsForCopy(i,a);e(uo.create(l)),e(uo.select(Dn([...r,...l].map((e=>e.id)),t().elements)))}},function(e){e.UNDO="@@undo/UNDO",e.REDO="@@undo/REDO"}(or||(or={}));class ir{}ir.undo=()=>({type:or.UNDO,payload:{},undoable:!1}),ir.redo=()=>({type:or.REDO,payload:{},undoable:!1});const rr=(0,Do.Zz)(Ro,(0,wo.Ng)((e=>({readonly:e.editor.readonly,mode:e.editor.mode})),{undo:ir.undo,redo:ir.redo,copy:sr.copy,paste:sr.paste,select:uo.select,deselect:uo.deselect,startMoving:uo.startMoving,move:uo.move,endMoving:uo.endMoving,delete:uo.delete}));class ar extends W.Component{constructor(){super(...arguments),this.pointerDown=e=>{e.target!==e.currentTarget||e.shiftKey||this.props.deselect()},this.keyDown=e=>{switch(e.key){case"ArrowUp":e.preventDefault(),e.repeat||this.props.startMoving(),this.props.move({x:0,y:-10});break;case"ArrowRight":e.preventDefault(),e.repeat||this.props.startMoving(),this.props.move({x:10,y:0});break;case"ArrowDown":e.preventDefault(),e.repeat||this.props.startMoving(),this.props.move({x:0,y:10});break;case"ArrowLeft":e.preventDefault(),e.repeat||this.props.startMoving(),this.props.move({x:-10,y:0});break;case"Backspace":case"Delete":e.preventDefault(),this.props.delete();break;case"Escape":e.preventDefault(),this.props.deselect()}if(e.metaKey||e.ctrlKey)switch(e.key){case"a":e.preventDefault(),this.props.select();break;case"c":e.preventDefault(),this.props.copy();break;case"v":e.preventDefault(),this.props.paste();break;case"z":e.preventDefault(),e.shiftKey?this.props.redo():this.props.undo()}},this.keyUp=e=>{switch(e.key){case"ArrowUp":case"ArrowRight":case"ArrowDown":case"ArrowLeft":this.props.endMoving(void 0,!0)}}}componentDidMount(){const{layer:e}=this.props.canvas;this.props.readonly||this.props.mode===no.Assessment||(e.addEventListener("keydown",this.keyDown),e.addEventListener("keyup",this.keyUp)),e.addEventListener("pointerdown",this.pointerDown)}render(){return null}}const lr=rr(ar),cr=_t.div.attrs((({position:e})=>({style:{transform:`translate(${e.x}px, ${e.y}px)`}})))`
  position: absolute;
  top: 0;
  left: 0;
  will-change: transform;
  pointer-events: none;
  margin: -5px;
  font-family: ${e=>e.theme.font.family}, sans-serif;
  font-size: ${e=>e.theme.font.size}px;

  svg {
    fill-opacity: 0.7;
  }
  text {
    fill: black;
    fill-opacity: 0.7;
  }
`,{Consumer:dr,Provider:hr}=(0,W.createContext)(null),ur=e=>(0,W.forwardRef)(((t,n)=>W.createElement(dr,null,(o=>W.createElement(e,{ref:n,...t,...o}))))),pr={dragging:!1,offset:new _,position:new _,resolve:null,reject:null},mr=(0,Do.Zz)(Ro,ur,(0,wo.Ng)((e=>({zoomFactor:e.editor.zoomFactor}))));class gr extends W.Component{constructor(){super(...arguments),this.state=pr,this.ghost=(0,W.createRef)(),this.onDragStart=e=>{const t=e.currentTarget,n=t.getBoundingClientRect(),o=this.props.root.getBoundingClientRect();let s,i;return e instanceof PointerEvent?(s=new _(e.pageX-(n.left-o.x),e.pageY-(n.top-o.y)),i=new _(10*Math.round((e.pageX-s.x)/10),10*Math.round((e.pageY-s.y)/10))):(s=new _(e.targetTouches[0].pageX-(n.left-o.x),e.targetTouches[0].pageY-(n.top-o.y)),i=new _(10*Math.round((e.targetTouches[0].pageX-s.x)/10),10*Math.round((e.targetTouches[0].pageY-s.y)/10))),Fo()({tablet:!0})?(document.addEventListener("touchmove",this.onPointerMove),document.addEventListener("touchend",this.cancel,{once:!0})):(document.addEventListener("pointermove",this.onPointerMove),document.addEventListener("pointerup",this.cancel,{once:!0})),new Promise(((e,n)=>this.setState({dragging:!0,offset:s,position:i,resolve:e,reject:n},(()=>{this.ghost.current.append(t.cloneNode(!0))}))))},this.onPointerMove=e=>{let t;t=e instanceof PointerEvent?new _(e.pageX-this.state.offset.x,e.pageY-this.state.offset.y):new _(e.targetTouches[0].pageX-this.state.offset.x,e.targetTouches[0].pageY-this.state.offset.y),t.x=10*Math.round(t.x/10),t.y=10*Math.round(t.y/10),this.setState({position:t})},this.onDragEnd=e=>t=>{const{zoomFactor:n=1}=this.props;if(!this.state.dragging)return;const o={owner:e,position:this.state.position.subtract(this.props.canvas.origin().subtract(this.props.root.getBoundingClientRect().x,this.props.root.getBoundingClientRect().y))};o.position.x=10*Math.round(o.position.x/n/10),o.position.y=10*Math.round(o.position.y/n/10),this.state.resolve&&this.state.resolve(o)},this.cancel=()=>{this.state.reject&&this.state.reject(),Fo()({tablet:!0})?document.removeEventListener("touchmove",this.onPointerMove):document.removeEventListener("pointermove",this.onPointerMove),this.setState(pr)}}render(){const e={onDragStart:this.onDragStart,onDragEnd:this.onDragEnd},{dragging:t,position:n}=this.state;return W.createElement(Mo,{value:e},this.props.children,(0,ko.createPortal)(t&&W.createElement(cr,{ref:this.ghost,position:n}),this.props.root))}}const yr=mr(gr),fr=JSON.parse('{"views":{"modelling":"Modellierung","exporting":"Interaktiv","highlight":"Zeige interaktive Elemente"},"sidebar":{"classAttribute":"+ attribut: Typ","classMethod":"+ methode()","enumAttribute":"Fall","objectAttribute":"attribut = Wert"},"popup":{"attributes":"Attribute","methods":"Methoden","relationship":"Beziehung","association":"Assoziation","multiplicity":"Multiziplitt","role":"Rolle","messages":"Nachrichten","condition":"Bedingungen","tokens":"Tokens","capacity":"Kapazitt"},"assessment":{"assessment":"Bewertung fr","score":"Punkte","feedback":"Feedback","feedbackPlaceholder":"Du kannst hier Feedback abgeben...","additionalFeedbackPlaceholder":"Du kannst hier zustzliches Feedback abgeben..."},"packages":{"ClassDiagram":{"Package":"Paket","Class":"Klasse","AbstractClass":"Abstrakt","Interface":"Schnittstelle","Enumeration":"Aufzhlung","ClassAttribute":"Attribut","ClassMethod":"Methode","ClassAggregation":"Aggregation","ClassBidirectional":"Assoziation (bidirektional)","ClassComposition":"Komposition","ClassDependency":"Abhngigkeit","ClassInheritance":"Vererbung","ClassRealization":"Realisierung","ClassUnidirectional":"Assoziation (unidirektional)"},"ObjectDiagram":{"ObjectName":"Objekt","ObjectAttribute":"Attribut","ObjectMethod":"Methode","ObjectLink":"Beziehung"},"ActivityDiagram":{"Activity":"Aktivitt","ActivityActionNode":"Aktion","ActivityFinalNode":"Endknoten","ActivityForkNode":"Verzweigungsknoten","ActivityInitialNode":"Startknoten","ActivityMergeNode":"Bedingung","ActivityObjectNode":"Objekt","ActivityControlFlow":"Kontrollfluss"},"UseCaseDiagram":{"UseCase":"Anwendungsfall","UseCaseActor":"Akteur","UseCaseSystem":"System","UseCaseAssociation":"Assoziation","UseCaseExtend":"Extend","UseCaseGeneralization":"Generalisierung","UseCaseInclude":"Include"},"CommunicationDiagram":{"ObjectName":"Objekt","ObjectAttribute":"Attribut","ObjectMethod":"Methode","CommunicationLink":"Kommunikation"},"ComponentDiagram":{"Component":"Komponente","Subsystem":"Teilsystem","ComponentDependency":"Abhngigkeit","ComponentInterface":"Schnittstelle","ComponentInterfaceProvided":"Bereitgestellte Schnittstelle","ComponentInterfaceRequired":"Verwendete Schnittstelle"},"DeploymentDiagram":{"DeploymentNode":"Knoten","DeploymentComponent":"Komponente","DeploymentArtifact":"Artefakt","DeploymentInterface":"Schnittstelle","DeploymentInterfaceProvided":"Bereitgestellte Schnittstelle","DeploymentInterfaceRequired":"Verwendete Schnittstelle","DeploymentAssociation":"Deployment Verbindung","DeploymentDependency":"Deployment Abhngigkeit"},"PetriNet":{"PetriNetPlace":"Platz","PetriNetTransition":"Transition"},"ReachabilityGraph":{"ReachabilityGraphIsInitialMarking":"Ist Anfangsmarkierung","ReachabilityGraphMarking":"Markierung"},"SyntaxTree":{"SyntaxTreeTerminal":"Terminal","SyntaxTreeNonterminal":"Nichtterminal","SyntaxTreeLink":"Verbindung"},"Flowchart":{"FlowchartTerminal":"Terminator","FlowchartDecision":"Entscheidung","FlowchartProcess":"Operation","FlowchartFunctionCall":"Unterprogramm ausfhren","FlowchartInputOutput":"Ein- und Ausgabe","FlowchartFlowline":"Verbindung"},"ColorLegend":{"ColorLegend":"Farbe Beschreibung"},"BPMN":{"BPMNTask":"Task","BPMNUserTask":"User Task","BPMNSendTask":"Send Task","BPMNReceiveTask":"Receive Task","BPMNManualTask":"Manual Task","BPMNBusinessRuleTask":"Business Rule Task","BPMNScriptTask":"Script Task","BPMNSubprocess":"Sub-Prozess","BPMNTransaction":"Transaktion","BPMNCallActivity":"Aufruf-Aktivitt","BPMNAnnotation":"Annotation","BPMNStartEvent":"Start-Ereignis","BPMNMessageStartEvent":"Message Start Event","BPMNTimerStartEvent":"Timer Start Event","BPMNConditionalStartEvent":"Conditional Start Event","BPMNSignalStartEvent":"Signal Start Event","BPMNIntermediateEvent":"Zwischenereignis","BPMNMessageIntermediateCatchEvent":"Message Intermediate Catch Event","BPMNMessageIntermediateThrowEvent":"Message Intermediate Throw Event","BPMNTimerIntermediateCatchEvent":"Timer Intermediate Catch Event","BPMNEscalationIntermediateThrowEvent":"Escalation Intermediate Throw Event","BPMNConditionalIntermediateCatchEvent":"Conditional Intermediate Catch Event","BPMNLinkIntermediateCatchEvent":"Link Intermediate Catch Event","BPMNLinkIntermediateThrowEvent":"Link Intermediate Throw Event","BPMNCompensationIntermediateThrowEvent":"Compensation Intermediate Throw Event","BPMNSignalIntermediateCatchEvent":"Signal Intermediate Catch Event","BPMNSignalIntermediateThrowEvent":"Signal Intermediate Throw Event","BPMNEndEvent":"End-Ereignis","BPMNMessageEndEvent:":"Message End Event","BPMNEscalationEndEvent":"Escalation End Event","BPMNErrorEndEvent":"Error End Event","BPMNCompensationEndEvent":"Compensation End Event","BPMNSignalEndEvent":"Signal End Event","BPMNTerminateEndEvent":"Terminate End Event","BPMNGateway":"Gateway","BPMNComplexGateway":"Komplex","BPMNEventBasedGateway":"Ereignis-basiert","BPMNExclusiveGateway":"Exklusiv","BPMNInclusiveGateway":"Inklusiv","BPMNParallelGateway":"Parallel","BPMNConversation":"Konversation","BPMNCallConversation":"Aufruf-Konversation","BPMNSequenceFlow":"Sequenz","BPMNMessageFlow":"Nachricht","BPMNAssociationFlow":"Assoziation","BPMNDataAssociationFlow":"Daten-Assoziation","BPMNDataObject":"Datenobjekt","BPMNPool":"Pool","BPMNSwimlane":"Bahn","BPMNSwimlanes":"Bahnen","BPMNGroup":"Gruppe"}}}'),Cr=JSON.parse('{"views":{"modelling":"Modeling","exporting":"Interactive","highlight":"Show interactive elements"},"sidebar":{"classAttribute":"+ attribute: Type","classMethod":"+ method()","enumAttribute":"Case","objectAttribute":"attribute = value"},"popup":{"attributes":"Attributes","methods":"Methods","relationship":"Relationship","association":"Association","multiplicity":"Multiplicity","role":"Role","messages":"Messages","condition":"Conditions","tokens":"Tokens","capacity":"Capacity"},"assessment":{"assessment":"Assessment for","score":"Points","feedback":"Feedback","feedbackPlaceholder":"You can enter feedback here...","additionalFeedbackPlaceholder":"You can enter additional feedback here..."},"packages":{"ClassDiagram":{"Package":"Package","Class":"Class","AbstractClass":"Abstract","Interface":"Interface","Enumeration":"Enumeration","ClassAttribute":"Attribute","ClassMethod":"Method","ClassAggregation":"Aggregation","ClassBidirectional":"Association (bidirectional)","ClassComposition":"Composition","ClassDependency":"Dependency","ClassInheritance":"Inheritance","ClassRealization":"Realization","ClassUnidirectional":"Association (unidirectional)"},"ObjectDiagram":{"ObjectName":"Object","ObjectAttribute":"Attribute","ObjectMethod":"Method","ObjectLink":"Relationship"},"ActivityDiagram":{"Activity":"Activity","ActivityActionNode":"Action","ActivityFinalNode":"Final Node","ActivityForkNode":"Fork Node","ActivityInitialNode":"Initial Node","ActivityMergeNode":"Condition","ActivityObjectNode":"Object","ActivityControlFlow":"Control Flow"},"UseCaseDiagram":{"UseCase":"UseCase","UseCaseActor":"Actor","UseCaseSystem":"System","UseCaseAssociation":"Association","UseCaseExtend":"Extend","UseCaseGeneralization":"Generalization","UseCaseInclude":"Include"},"CommunicationDiagram":{"ObjectName":"Object","ObjectAttribute":"Attribute","ObjectMethod":"Method","CommunicationLink":"Communication Link"},"ComponentDiagram":{"Component":"Component","Subsystem":"Subsystem","ComponentDependency":"Dependency","ComponentInterface":"Interface","ComponentInterfaceProvided":"Provided Interface","ComponentInterfaceRequired":"Required Interface"},"DeploymentDiagram":{"DeploymentNode":"Node","DeploymentComponent":"Component","DeploymentArtifact":"Artifact","DeploymentInterface":"Interface","DeploymentInterfaceProvided":"Provided Interface","DeploymentInterfaceRequired":"Required Interface","DeploymentAssociation":"Deployment Association","DeploymentDependency":"Deployment Dependency"},"PetriNet":{"PetriNetPlace":"Place","PetriNetTransition":"Transition"},"ReachabilityGraph":{"ReachabilityGraphIsInitialMarking":"Is initial marking","ReachabilityGraphMarking":"Marking"},"SyntaxTree":{"SyntaxTreeTerminal":"Terminal","SyntaxTreeNonterminal":"Nonterminal","SyntaxTreeLink":"Link"},"Flowchart":{"FlowchartTerminal":"Terminal","FlowchartDecision":"Decision","FlowchartProcess":"Process","FlowchartFunctionCall":"Function Call","FlowchartInputOutput":"Input Output","FlowchartFlowline":"Flowline"},"ColorLegend":{"ColorLegend":"Color Description"},"BPMN":{"BPMNTask":"Task","BPMNUserTask":"User Task","BPMNSendTask":"Send Task","BPMNReceiveTask":"Receive Task","BPMNManualTask":"Manual Task","BPMNBusinessRuleTask":"Business Rule Task","BPMNScriptTask":"Script Task","BPMNSubprocess":"Subprocess","BPMNTransaction":"Transaction","BPMNCallActivity":"Call Activity","BPMNAnnotation":"Annotation","BPMNStartEvent":"Start Event","BPMNMessageStartEvent":"Message Start Event","BPMNTimerStartEvent":"Timer Start Event","BPMNConditionalStartEvent":"Conditional Start Event","BPMNSignalStartEvent":"Signal Start Event","BPMNIntermediateEvent":"Intermediate Event","BPMNMessageIntermediateCatchEvent":"Message Intermediate Catch Event","BPMNMessageIntermediateThrowEvent":"Message Intermediate Throw Event","BPMNTimerIntermediateCatchEvent":"Timer Intermediate Catch Event","BPMNEscalationIntermediateThrowEvent":"Escalation Intermediate Throw Event","BPMNConditionalIntermediateCatchEvent":"Conditional Intermediate Catch Event","BPMNLinkIntermediateCatchEvent":"Link Intermediate Catch Event","BPMNLinkIntermediateThrowEvent":"Link Intermediate Throw Event","BPMNCompensationIntermediateThrowEvent":"Compensation Intermediate Throw Event","BPMNSignalIntermediateCatchEvent":"Signal Intermediate Catch Event","BPMNSignalIntermediateThrowEvent":"Signal Intermediate Throw Event","BPMNEndEvent":"End Event","BPMNMessageEndEvent":"Message End Event","BPMNEscalationEndEvent":"Escalation End Event","BPMNErrorEndEvent":"Error End Event","BPMNCompensationEndEvent":"Compensation End Event","BPMNSignalEndEvent":"Signal End Event","BPMNTerminateEndEvent":"Terminate End Event","BPMNGateway":"Gateway","BPMNComplexGateway":"Complex","BPMNEventBasedGateway":"Event-based","BPMNInclusiveGateway":"Inclusive","BPMNExclusiveGateway":"Exclusive","BPMNParallelGateway":"Parallel","BPMNConversation":"Conversation","BPMNCallConversation":"Call Conversation","BPMNSequenceFlow":"Sequence","BPMNMessageFlow":"Message","BPMNAssociationFlow":"Association","BPMNDataAssociationFlow":"Data Association","BPMNDataObject":"Data Object","BPMNPool":"Pool","BPMNSwimlane":"Lane","BPMNSwimlanes":"Lanes","BPMNGroup":"Group"}}}'),{Provider:Er,Consumer:br}=(0,W.createContext)(null),vr=to.en,wr={[to.de]:fr,[to.en]:Cr};class kr extends W.Component{constructor(){super(...arguments),this.translate=e=>{try{let t=wr[this.props.locale],n=e.split(".").reduce(((e,t)=>e[t]),t);return n||(t=wr[vr],n=e.split(".").reduce(((e,t)=>e[t]),t)),n}catch(e){return console.error(e),""}}}render(){const e={translate:this.translate};return W.createElement(Er,{value:e},this.props.children)}}function xr(e){return function(t){return W.createElement(br,null,(n=>W.createElement(e,{...t,...n})))}}kr.defaultProps={locale:vr};var Mr,Sr=n(7701),Ir=n(1265);!function(e){e.LAYOUT="@@layouter/LAYOUT"}(Mr||(Mr={}));const Tr={},Pr={readonly:!1,colorEnabled:!1,enablePopups:!0,enableCopyPasteToClipboard:!1,mode:no.Exporting,view:oo.Modelling,zoomFactor:1,selectionBoxActive:!1,features:{hoverable:!0,selectable:!0,movable:!0,resizable:!0,connectable:!0,updatable:!0,droppable:!0,alternativePortVisualization:!1}},Dr=(e,t)=>e&&t&&e.name===t.name&&e.color===t.color,Ar={editor:(e=Pr,t)=>{switch(t.type){case so.CHANGE_VIEW:{const{payload:n}=t;return{...e,view:n.view}}case so.SET_ZOOM_FACTOR:{const{payload:n}=t;return{...e,zoomFactor:n.zoomFactor}}case so.SET_SELECTION_BOX:{const{payload:n}=t;return{...e,selectionBoxActive:n.selectionBoxActive}}}return e},diagram:(e=new Wt,t)=>{switch(t.type){case Rn.APPEND:{const{payload:n}=t;return{...e,ownedRelationships:[...new Set([...n.ids,...e.ownedRelationships])].reverse()}}case Bn.APPEND:{const{payload:n}=t;return e.id!==n.owner?{...e,ownedElements:e.ownedElements.filter((e=>!n.ids.includes(e)))}:{...e,ownedElements:[...new Set([...e.ownedElements,...n.ids])]}}case Rn.BRING_TO_FRONT:{const{ids:n}=t.payload;return{...e,ownedElements:[...e.ownedElements].filter((e=>!n.includes(e))).concat(n)}}case Bn.REMOVE:{const{payload:n}=t;return{...e,ownedElements:e.ownedElements.filter((e=>!n.ids.includes(e))),ownedRelationships:e.ownedRelationships.filter((e=>!n.ids.includes(e)))}}case Kn.RESIZE:{const{payload:n}=t;if(!n.ids.includes(e.id))break;return{...e,bounds:{...e.bounds,width:e.bounds.width+n.delta.width,height:e.bounds.height+n.delta.height},resizeFrom:n.resizeFrom}}}return e},hovered:(e=[],t)=>{switch(t.type){case Wn.HOVER:{const{payload:n}=t;return[...new Set([...n.ids,...e])]}case $n.DELETE:case Wn.LEAVE:{const{payload:n}=t;return e.filter((e=>!n.ids.includes(e)))}}return e},selected:(e=[],t)=>{switch(t.type){case eo.SELECT:{const{payload:n}=t;return[...new Set([...n.ids,...n.overwrite?[]:e])]}case $n.DELETE:case eo.DESELECT:{const{payload:n}=t;return e.filter((e=>!n.ids.includes(e)))}}return e},moving:(e=[],t)=>{switch(t.type){case Vn.START:{const{payload:n}=t;return[...new Set([...n.ids,...e])]}case $n.DELETE:case Vn.END:{const{payload:n}=t;return e.filter((e=>!n.ids.includes(e)))}}return e},resizing:(e=[],t)=>{switch(t.type){case Xn.START:{const{payload:n}=t;return[...new Set([...n.ids,...e])]}case $n.DELETE:case Xn.END:{const{payload:n}=t;return e.filter((e=>!n.ids.includes(e)))}}return e},connecting:(e=[],t)=>{switch(t.type){case Fn.START:{const{payload:n}=t;return[...new Set([...n.ports,...e])]}case Fn.END:{const{payload:n}=t;return e.filter((e=>!n.ports.includes(e)))}case $n.DELETE:{const{payload:n}=t;return e.reduce(((e,t)=>({...e,...!n.ids.includes(t.element)&&t})),[])}}return e},reconnecting:(e={},t)=>{switch(t.type){case zn.START:{const{payload:n}=t;return n.ids.reduce(((e,t)=>({...e,[t]:n.endpoint})),e)}case $n.DELETE:case zn.END:{const{payload:n}=t;return Object.keys(e).reduce(((t,o)=>({...t,...!n.ids.includes(o)&&{[o]:e[o]}})),{})}}return e},interactive:(e=[],t)=>{switch(t.type){case qn.SELECT:{const{payload:n}=t;return[...new Set([...n.ids,...e])]}case $n.DELETE:case qn.DESELECT:{const{payload:n}=t;return e.filter((e=>!n.ids.includes(e)))}}return e},updating:(e=[],t)=>{switch(t.type){case co.START:{const{payload:n}=t;return[...new Set([...n.ids,...e])]}case $n.DELETE:case co.END:{const{payload:n}=t;return e.filter((e=>!n.ids.includes(e)))}case co.ENDALL:return[]}return e},copy:(e=[],t)=>{switch(t.type){case nr.COPY:{const{payload:e}=t;return e}case nr.PASTE:return e}return e},lastAction:(e="",t)=>t.type,remoteSelection:(e={},t)=>{switch(t.type){case ro.SELECTION_CHANGE:const{payload:n}=t,{selector:o,changes:s}=n;return s.reduce(((e,t)=>{const{id:n}=t,s=[...e[n]??[]];if(t.type!==ao.SELECT||s.some((e=>Dr(e,o)))){if(t.type===ao.DESELECT){const e=s.findIndex((e=>Dr(e,o)));e>=0&&s.splice(e,1)}}else s.push(o);return{...e,[n]:s}}),e);case ro.PRUNE_SELECTORS:const{allowedSelectors:i}=t.payload;return Object.fromEntries(Object.entries(e).map((([e,t])=>[e,t.filter((e=>i.some((t=>Dr(e,t)))))])))}return e},elements:((e,...t)=>(n=e,o)=>t.reduce(((e,t)=>t(e,o)),n))({},((e={},t)=>{switch(t.type){case Bn.APPEND:{const{payload:n}=t,o=e[n.owner],s={...e,...o&&he.isUMLContainer(o)&&{[o.id]:{...o,ownedElements:[...new Set((new ut[o.type]).reorderChildren([...o.ownedElements,...n.ids].map((t=>e[t]))))]}}},i=(e,t)=>{const n=e[t];let s=new _(n.bounds.x,n.bounds.y),i=n.owner&&e[n.owner];for(;i;)s=s.add(i.bounds.x,i.bounds.y),i=i.owner?e[i.owner]:null;for(i=o;i;)s=s.subtract(i.bounds.x,i.bounds.y),i=i.owner?e[i.owner]:null;return{...e,[t]:{...e[t],owner:o?o.id:null,bounds:{...n.bounds,...s}}}};return n.ids.filter((t=>e[t])).reduce(i,s)}case Bn.REMOVE:{const{payload:n}=t;return[...new Set(n.ids.filter((t=>e[t]&&e[t].owner)).map((t=>e[t].owner)).filter(po))].reduce(((t,o)=>({...t,[o]:{...e[o],ownedElements:e[o].ownedElements.filter((e=>!n.ids.includes(e)))}})),e)}}return e}),((e={},t)=>{switch(t.type){case zn.RECONNECT:{const{payload:n}=t;return n.connections.reduce(((t,n)=>({...t,[n.id]:{...e[n.id],source:{...e[n.id].source,...n.source},target:{...e[n.id].target,...n.target}}})),e)}case Hn.LAYOUT:{const{payload:n}=t;return{...e,[n.id]:{...e[n.id],path:n.path,bounds:{...e[n.id].bounds,...n.bounds},isManuallyLayouted:!1}}}case Hn.WAYPOINTLAYOUT:{const{payload:n}=t;return{...e,[n.id]:{...e[n.id],path:n.path,bounds:{...e[n.id].bounds,...n.bounds}}}}case Hn.STARTWAYPOINTSLAYOUT:{const{payload:n}=t;return{...e,[n.id]:{...e[n.id],path:n.path,bounds:{...e[n.id].bounds,...n.bounds}}}}case Hn.ENDWAYPOINTSLAYOUT:{const{payload:n}=t;return{...e,[n.id]:{...e[n.id],isManuallyLayouted:!0}}}}return e}),((e={},t)=>{switch(t.type){case $n.CREATE:{const{payload:n}=t;return n.values.reduce(((e,t)=>({...e,[t.id]:t})),e)}case $n.UPDATE:{const{payload:n}=t;return n.values.reduce(((e,t)=>({...e,[t.id]:{...e[t.id],...t}})),e)}case $n.DELETE:{const{payload:n}=t;return Object.keys(e).reduce(((t,o)=>({...t,...!n.ids.includes(o)&&{[o]:e[o]}})),{})}}return e}),((e={},t)=>{const n={x:0,y:0},o=(e,t,o)=>{switch(o){case Z.TOPLEFT:n.x=Math.min(e.x-t.delta.width,e.x+e.width),n.y=Math.min(e.y-t.delta.height,e.y+e.height);break;case Z.TOPRIGHT:n.x=e.x,n.y=Math.min(e.y-t.delta.height,e.y+e.height);break;case Z.BOTTOMLEFT:n.x=Math.min(e.x-t.delta.width,e.x+e.width),n.y=e.y;break;case Z.BOTTOMRIGHT:default:n.x=e.x,n.y=e.y}return n};if(t.type===Kn.RESIZE){const{payload:n}=t;return n.ids.reduce(((e,t)=>({...e,...t in e&&{[t]:{...e[t],bounds:{...e[t].bounds,x:o(e[t].bounds,n,n.resizeFrom).x,y:o(e[t].bounds,n,n.resizeFrom).y,width:Math.max(e[t].bounds.width+n.delta.width,0),height:Math.max(e[t].bounds.height+n.delta.height,0)},resizeFrom:n.resizeFrom}}})),e)}return e}),((e={},t)=>{if(t.type===Yn.MOVE){const{payload:n}=t;return n.ids.reduce(((e,t)=>({...e,...t in e&&{[t]:{...e[t],bounds:{...e[t].bounds,x:e[t].bounds.x+n.delta.x,y:e[t].bounds.y+n.delta.y}}}})),e)}return e})),assessments:(e=Tr,t)=>{switch(t.type){case ts.ASSESS:{const{payload:n}=t;return{...e,[n.element]:n.assessment}}case ts.DELETE:{const{payload:n}=t,o={...e};return delete o[n.element],o}case $n.DELETE:{const{payload:n}=t;return Object.keys(e).reduce(((t,o)=>({...t,...!n.ids.includes(o)&&{[o]:e[o]}})),{})}}return e}};var Lr=n(3821),Rr=n(3786);const Nr=e=>Lr.q8 in e;function Br(e){return(0,Rr.Q7)(e.map((e=>Or($r(e)))))}const Or=e=>(0,Rr.cH)((function*(){for(;;)yield(0,Rr.T1)(e)})),$r=e=>function*(){try{yield(0,Rr.T1)(e)}catch(e){console.error(e)}},Ur=(e,t)=>{const n=Object.keys(e).reduce(((e,n)=>t.hasOwnProperty(n)?e:{...e,[n]:void 0}),{});return Object.keys(t).reduce(((n,o)=>{if(!e.hasOwnProperty(o))return{...n,[o]:t[o]};if(e[o]===t[o])return n;if(Array.isArray(e[o]))return{...n,[o]:t[o]};if("object"==typeof e[o]){const s=Ur(e[o],t[o]);return Object.keys(s).length?{...n,[o]:Ur(e[o],t[o])}:n}return{...n,[o]:t[o]}}),n)};function*Fr(){yield Br([zr,Hr,Qr,Wr,jr,Gr])}function*zr(){const e=yield(0,Rr.s)($n.CREATE);for(const t of e.payload.values)yield(0,Rr.T1)(qr,t.id)}function*Hr(){const e=yield(0,Rr.s)(zn.RECONNECT);for(const t of e.payload.connections)yield(0,Rr.T1)(qr,t.id)}function*jr(){yield(0,Rr.s)(Hn.ENDWAYPOINTSLAYOUT);const e=yield(0,Rr.SD)("layer"),{elements:t,diagram:n}=yield(0,Rr.Lt)(),o=[...n.ownedElements.map((e=>uo.get(t[e]))),...n.ownedRelationships.map((e=>go.get(t[e])))].filter(po),s=Nn.get(n);if(!s)return;const[i]=s.render(e,o),r={width:i.bounds.width-n.bounds.width,height:i.bounds.height-n.bounds.height};yield(0,Rr.yJ)({type:Kn.RESIZE,payload:{ids:[n.id],delta:r},undoable:!1})}function*Qr(){const e=yield(0,Rr.s)($n.UPDATE),{elements:t}=yield(0,Rr.Lt)();for(const n of e.payload.values)Qt.isUMLRelationship(t[n.id])&&(yield(0,Rr.T1)(qr,n.id))}function*Wr(){const e=yield(0,Rr.s)([Yn.MOVE,Kn.RESIZE]),{elements:t}=yield(0,Rr.Lt)(),n=Object.values(t).filter((e=>Qt.isUMLRelationship(e))),o=[];e:for(const s of n){let n=s.source.element;for(;n;){if(e.payload.ids.includes(n)){o.push(s.id);continue e}n=t[n].owner}let i=s.target.element;for(;i;){if(e.payload.ids.includes(i)){o.push(s.id);continue e}i=t[i].owner}}for(const e of[...new Set([...o])])yield(0,Rr.T1)(qr,e)}function*Gr(){const e=yield(0,Rr.s)($n.DELETE),{elements:t}=yield(0,Rr.Lt)(),n=Object.values(t).filter((e=>Qt.isUMLRelationship(e))).filter((t=>e.payload.ids.includes(t.source.element)||e.payload.ids.includes(t.target.element))).map((e=>e.id));yield(0,Rr.Q7)([(0,Rr.yJ)({type:Bn.REMOVE,payload:{ids:n},undoable:!1}),(0,Rr.yJ)({type:$n.DELETE,payload:{ids:n},undoable:!1})])}function*qr(e){const{elements:t,selected:n,editor:o}=yield(0,Rr.Lt)(),s=yield(0,Rr.SD)("layer"),i=go.get(t[e]);if(!i)return;const r=uo.get(t[i.source.element]),a=uo.get(t[i.target.element]);if(!r||!a)return;const l=yield(0,Rr.yJ)(uo.getAbsolutePosition(i.source.element));r.bounds={...r.bounds,...l};const c=yield(0,Rr.yJ)(uo.getAbsolutePosition(i.target.element));a.bounds={...a.bounds,...c};const d=t[e],[h]=i.render(s,r,a),{path:u,bounds:p}=Ur(d,h);u&&(i.isManuallyLayouted&&_r(r.id,a.id,n,o.readonly)?yield(0,Rr.yJ)(go.layoutWaypoints(h.id,d.path,{...d.bounds,...p})):yield(0,Rr.yJ)(go.layout(h.id,u,{...d.bounds,...p}))),h.type===pt.CommunicationLink&&(yield(0,Rr.yJ)(uo.update(h.id,h)))}const _r=(e,t,n,o)=>!!(n.includes(e)&&n.includes(t)||o);function*Vr(){yield Br([Yr])}function*Yr(){yield(0,Rr.s)(Mr.LAYOUT),yield(0,Rr.SD)("layer");const{elements:e,diagram:t}=yield(0,Rr.Lt)(),n=Object.values(e).filter((e=>!e.owner)).map((e=>e.id));if(n.length){yield(0,Rr.yJ)(On.append(n));for(const t of Object.keys(e))yield(0,Rr.cb)(0),J.isUMLElement(e[t])&&(yield(0,Rr.T1)(Jr,t)),Qt.isUMLRelationship(e[t])&&!e[t].isManuallyLayouted&&(yield(0,Rr.T1)(qr,t))}}function*Zr(){const{elements:e,diagram:t}=yield(0,Rr.Lt)(),n=yield(0,Rr.SD)("layer"),o=Nn.get(t),s=[...o.ownedElements.map((t=>uo.get(e[t]))),...o.ownedRelationships.map((t=>go.get(e[t])))].filter(po);return o.render(n,s)}function*Xr(e){const{elements:t}=yield(0,Rr.Lt)(),n=yield(0,Rr.SD)("layer"),o=On.get(t[e]),s=o.ownedElements.map((e=>uo.get(t[e]))).filter(po);return o.render(n,s)}function*Kr(e){const{elements:t}=yield(0,Rr.Lt)(),n=yield(0,Rr.SD)("layer");return uo.get(t[e]).render(n)}function*Jr(e){const{elements:t,diagram:n}=yield(0,Rr.Lt)(),o={...t,[n.id]:n};let s=[];if(Nn.isUMLDiagram(o[e])?s=yield(0,Rr.T1)(Zr):he.isUMLContainer(o[e])?s=yield(0,Rr.T1)(Xr,e):J.isUMLElement(o[e])&&(s=yield(0,Rr.T1)(Kr,e)),s.length)for(const[e,t]of s.entries()){const s=o[t.id],i={width:t.bounds.width-s.bounds.width,height:t.bounds.height-s.bounds.height};if(Object.values(i).some((e=>0!==e))&&(yield(0,Rr.yJ)({type:Kn.RESIZE,payload:{ids:[t.id],resizeFrom:t.resizeFrom,delta:i},undoable:!1})),Nn.isUMLDiagram(t))continue;const r={x:t.bounds.x-s.bounds.x,y:t.bounds.y-s.bounds.y};if(Object.values(r).some((e=>0!==e))&&(yield(0,Rr.yJ)({type:Yn.MOVE,payload:{ids:[t.id],delta:r},undoable:!1})),0===e){const{id:e,name:o,owner:i,type:r,bounds:a,ownedElements:l,...c}=Ur(s,t);Object.keys(c).length&&(yield(0,Rr.yJ)(uo.update(t.id,{...c}))),yield(0,Rr.T1)(Jr,t.owner||n.id)}}}function*ea(){yield Br([ta,na,oa,sa])}function*ta(){const e=yield(0,Rr.s)(Bn.APPEND),{elements:t,diagram:n}=yield(0,Rr.Lt)(),o={...t,[n.id]:n},s=On.get(o[e.payload.owner]);s&&(yield(0,Rr.T1)(Jr,s.id))}function*na(){const e=yield(0,Rr.s)(Bn.REMOVE),{elements:t,diagram:n}=(yield(0,Rr.SD)("layer"),yield(0,Rr.Lt)()),o={...t,[n.id]:n},s=[...new Set(e.payload.ids.filter((e=>e in o)).map((e=>o[e].owner||n.id)))];for(const e of s)yield(0,Rr.T1)(Jr,e)}function*oa(){const e=yield(0,Rr.s)(Vn.END),{elements:t,hovered:n}=yield(0,Rr.Lt)();let o=null;if(n.length){const e=t[n[0]];if(!e||!he.isUMLContainer(e)||!ut[e.type].features.droppable)return;o=e.id}const s=e.payload.ids.filter((e=>t[e].owner!==o&&e!==o));s.length&&!e.payload.keyboard&&(yield(0,Rr.yJ)(On.remove(s)),yield(0,Rr.yJ)(On.append(s,o||void 0)))}function*sa(){const e=yield(0,Rr.s)(Vn.END),{elements:t,diagram:n}=yield(0,Rr.Lt)(),o={...t,[n.id]:n};yield(0,Rr.O4)({append:(0,Rr.s)(Bn.APPEND),resize:(0,Rr.T1)((function*(){yield(0,Rr.cb)(0);const t=[...new Set(e.payload.ids.map((e=>o[e].owner||n.id)))];for(const e of t)yield(0,Rr.T1)(Jr,e)}))})}function*ia(){yield Br([ra,aa])}function*ra(){const e=yield(0,Rr.s)(eo.SELECT),{diagram:t,editor:n}=yield(0,Rr.Lt)();if(n.readonly||n.mode===no.Assessment)return;const o=e.payload.ids.filter((e=>t.ownedRelationships.includes(e)));o.length&&(yield(0,Rr.yJ)({type:Rn.APPEND,payload:{ids:o},undoable:!1}))}function*aa(){yield(0,Rr.p8)([Fn.END,zn.END,co.END],la)}function*la(){const e=yield(0,Rr.SD)("layer"),{elements:t,diagram:n}=yield(0,Rr.Lt)(),o=[...n.ownedElements.map((e=>uo.get(t[e]))),...n.ownedRelationships.map((e=>go.get(t[e])))].filter(po),s=Nn.get(n);if(!s)return;const[i]=s.render(e,o),r={width:i.bounds.width-n.bounds.width,height:i.bounds.height-n.bounds.height};yield(0,Rr.yJ)({type:Kn.RESIZE,payload:{ids:[n.id],delta:r},undoable:!1})}function*ca(){yield Br([da,ha,ua])}function*da(){yield(0,Rr.s)(qn.SELECT);const{interactive:e,elements:t}=yield(0,Rr.Lt)(),n=Dn(e,t),o=e.filter((e=>!n.includes(e)));yield(0,Rr.yJ)({type:qn.DESELECT,payload:{ids:o},undoable:!1})}function*ha(){const e=yield(0,Rr.s)($n.UPDATE);if(!Nr(e))for(const t of e.payload.values)yield(0,Rr.T1)(Jr,t.id)}function*ua(){const e=yield(0,Rr.s)(Kn.RESIZE);if(!Nr(e))for(const t of e.payload.ids)yield(0,Rr.T1)(Jr,t)}var pa;function*ma(){yield Br([ga])}function*ga(){yield(0,Rr.sg)(100,pa.PATCH,ya)}function*ya(){const{elements:e}=yield(0,Rr.Lt)(),t=Object.values(e).filter((e=>!e.owner)).map((e=>e.id));if(t.length){yield(0,Rr.yJ)(On.append(t));for(const t of Object.keys(e))yield(0,Rr.cb)(0),J.isUMLElement(e[t])&&(yield(0,Rr.T1)(Jr,t)),Qt.isUMLRelationship(e[t])&&!e[t].isManuallyLayouted&&(yield(0,Rr.T1)(qr,t))}}function*fa(){var e;yield(e=[Vr,ca,ea,Fr,ia,ma],(0,Rr.Q7)(e.map(Rr.cH)))}!function(e){e.PATCH="@@patcher/PATCH"}(pa||(pa={}));class Ca{constructor(e){this.maxSize=e,this.items=[]}get latest(){return this.items.length?this.items[this.items.length-1]:null}push(e){this.items.push(e)>this.maxSize&&this.items.shift()}pop(){return this.items.pop()}clear(){this.items.length=0}}const Ea={transform:e=>e,transformInverse:e=>e,merge:(e,t)=>({...e,...t})},ba={transform:e=>e,selectDiscrete:()=>!0,selectContinuous:()=>!1};function va(e,t=ba){const n=t.transform||ba.transform,o=t.selectDiscrete||ba.selectDiscrete,s=t.selectContinuous||ba.selectContinuous;return t=>(e.initialize(n(t.getState())),i=>r=>{const a=i(r);return o(r)?e.check(n(t.getState())):s(r)&&e.checkContinuous(n(t.getState())),a})}function wa(e,t){return{...e,diagram:{...e.diagram,ownedElements:Object.keys(t.elements).filter((e=>!t.elements[e].owner)),ownedRelationships:e.diagram.ownedRelationships.filter((e=>!!t.elements[e]))},elements:Object.keys(t.elements).reduce(((n,o)=>({...n,[o]:{...e.elements[o],...t.elements[o]}})),{}),interactive:t.interactive,assessments:Object.keys(t.assessments).reduce(((n,o)=>({...n,[o]:{...e.assessments[o],...t.assessments[o]}})),{})}}const ka=(e={},t=null,n)=>{const o=(e=>{const t=new Ca(25),n=new Ca(25);return(o={},s)=>{switch(s.type){case or.UNDO:{const e=t.pop();return e?(n.push([o,s]),e[0]):o}case or.REDO:{const e=n.pop();return e?(t.push([o,s]),e[0]):o}default:return Nr(s)||!s.undoable||(n.clear(),t.push([o,s])),e(o,s)}}})((0,Do.HY)(Ar)),s=n&&function(e,t=Ea){const n=t.transform||Ea.transform,o=t.transformInverse||Ea.transformInverse,s=t.merge||Ea.merge;return(t,i)=>{const{type:r,payload:a}=i;if(r===pa.PATCH){const i=e.patch(a,o(t));if(i.patched)return s(t??{},n(i.result))}return t}}(n,{transform:e=>vo.fromModel(e),transformInverse:e=>vo.toModel(e),merge:wa}),i=(0,Sr.Ay)({context:{layer:t}}),r=(0,Do.Tw)(Ir.A,i,...n?[va(n,{selectDiscrete:e=>(e=>e.type.endsWith("END")||e.type.endsWith("DELETE")||e.type.endsWith("UNDO")||e.type.endsWith("REDO"))(e)||(e=>e.type===eo.SELECT||e.type===eo.DESELECT)(e),selectContinuous:e=>(e=>e.type===Yn.MOVE||e.type===Kn.RESIZE)(e),transform:e=>vo.toModel(e)})]:[]),a=(window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Do.Zz)(r),l=(0,Do.y$)(((e,t)=>{const n=o(e,t);return s?s(n,t):n}),e,a);return t&&(i.run(fa),l.dispatch({type:Mr.LAYOUT,payload:{},undoable:!1})),l},xa=(e={},t=null,n)=>({store:ka(e,t,n)});class Ma extends W.Component{constructor(){super(...arguments),this.state=xa(this.props.initialState,this.props.canvas,this.props.patcher)}componentDidUpdate(e){if(e.canvas!==this.props.canvas){const e=xa(this.props.initialState,this.props.canvas,this.props.patcher);this.setState(e)}}render(){return W.createElement(wo.Kq,{store:this.state.store},this.props.children)}}const Sa=Ro(Ma),Ia=So;class Ta extends W.Component{constructor(){super(...arguments),this.onDragStart=async e=>{try{const t=await this.props.onDragStart(e);this.props.onDrop&&this.props.onDrop(t)}catch(e){}}}componentDidMount(){const e=(0,ko.findDOMNode)(this);Fo()({tablet:!0})?(e.addEventListener("touchstart",this.onDragStart),e.addEventListener("touchend",ei)):e.addEventListener("pointerdown",this.onDragStart)}componentWillUnmount(){const e=(0,ko.findDOMNode)(this);Fo()({tablet:!0})?e.removeEventListener("touchstart",this.onDragStart):e.removeEventListener("pointerdown",this.onDragStart)}render(){return this.props.children}}const Pa=Ia(Ta),Da=_t(hi(Js)).attrs((e=>({child:Js,scale:e.scale})))`
  overflow: visible;
  fill: white;
  scale: ${e=>e.scale??.8};
  transform-origin: center;
`;class Aa extends W.Component{constructor(){super(...arguments),this.onDrop=e=>{const t=this.props.element.clone({bounds:{...this.props.element.bounds,...e.position}});this.props.create(t,e.owner)}}render(){const{element:e}=this.props;return W.createElement(Pa,{onDrop:this.onDrop},W.createElement(Da,{id:e.id}))}}const La=_t.div`
  width: 100%;
  text-align: center;
  margin: 1rem 0;
  height: 2px;
  background-color: ${e=>e.theme.color.primaryContrast};
`,Ra=(0,Do.Zz)(xr,Ro,(0,wo.Ng)((e=>({type:e.diagram.type,colorEnabled:e.editor.colorEnabled})),{create:uo.create}));class Na extends W.Component{constructor(){super(...arguments),this.state=(({type:e,canvas:t,translate:n,colorEnabled:o})=>{const s=[],i=[];switch(e){case D.ClassDiagram:s.push(...((e,t)=>{const n=[];fe.stereotypeHeaderHeight=te(1,50),fe.nonStereotypeHeaderHeight=te(1,40);const o=new ve({name:t("packages.ClassDiagram.Package")});o.bounds={...o.bounds,width:o.bounds.width,height:o.bounds.height},n.push(o);const s=new we({name:t("packages.ClassDiagram.Class")});s.bounds={...s.bounds,width:s.bounds.width,height:s.bounds.height};const i=new Ee({name:t("sidebar.classAttribute"),owner:s.id,bounds:{x:0,y:0,width:te(1,200),height:te(1,30)}}),r=new be({name:t("sidebar.classMethod"),owner:s.id,bounds:{x:0,y:0,width:te(1,200),height:te(1,30)}});s.ownedElements=[i.id,r.id],n.push(...s.render(e,[i,r]));const a=new Ce({name:t("packages.ClassDiagram.AbstractClass")});a.bounds={...a.bounds,width:a.bounds.width,height:a.bounds.height};const l=new Ee({name:t("sidebar.classAttribute"),owner:a.id,bounds:{x:0,y:40,width:te(1,200),height:te(1,30)}}),c=new be({name:t("sidebar.classMethod"),owner:a.id,bounds:{x:0,y:70,width:te(1,200),height:te(1,30)}});a.ownedElements=[l.id,c.id],n.push(...a.render(e,[l,c]));const d=new xe({name:t("packages.ClassDiagram.Interface"),bounds:{height:110}});d.bounds={...d.bounds,width:d.bounds.width,height:d.bounds.height};const h=new Ee({name:t("sidebar.classAttribute"),owner:d.id,bounds:{x:0,y:50,width:te(1,200),height:te(1,30)}}),u=new be({name:t("sidebar.classMethod"),owner:d.id,bounds:{x:0,y:80,width:te(1,200),height:te(1,30)}});d.ownedElements=[h.id,u.id],n.push(...d.render(e,[h,u]));const p=new ke({name:t("packages.ClassDiagram.Enumeration"),bounds:{height:140}});p.bounds={...p.bounds,width:p.bounds.width,height:p.bounds.height};const m=new Ee({name:t("sidebar.enumAttribute")+" 1",owner:p.id,bounds:{x:0,y:50,width:te(1,200),height:te(1,30)}}),g=new Ee({name:t("sidebar.enumAttribute")+" 2",owner:p.id,bounds:{x:0,y:80,width:te(1,200),height:te(1,30)}}),y=new Ee({name:t("sidebar.enumAttribute")+" 3",owner:p.id,bounds:{x:0,y:110,width:te(1,200),height:te(1,30)}});return p.ownedElements=[m.id,g.id,y.id],n.push(...p.render(e,[m,g,y])),n})(t,n));break;case D.ObjectDiagram:s.push(...((e,t)=>{const n=[],o=new Ae({name:t("packages.ObjectDiagram.ObjectName")});o.bounds={...o.bounds,width:o.bounds.width,height:o.bounds.height};const s=new Pe({name:t("sidebar.objectAttribute"),owner:o.id,bounds:{x:0,y:0,width:te(1,200),height:te(1,25)}});return o.ownedElements=[s.id],n.push(...o.render(e,[s])),n})(t,n));break;case D.ActivityDiagram:s.push(...((e,t)=>{const n=[];re.defaultWidth=10*Math.round(2),re.defaultHeight=10*Math.round(6),ae.defaultWidth=10*Math.round(6),ae.defaultHeight=10*Math.round(2);const o=new pe({name:t("packages.ActivityDiagram.Activity")});o.bounds={...o.bounds,width:o.bounds.width,height:o.bounds.height},n.push(o);const s=new le({bounds:{x:0,y:0,width:45,height:45}});n.push(s);const i=new ie({bounds:{x:0,y:0,width:45,height:45}});n.push(i);const r=new se({name:t("packages.ActivityDiagram.ActivityActionNode")});r.bounds={...r.bounds,width:r.bounds.width,height:r.bounds.height},n.push(r);const a=new de({name:t("packages.ActivityDiagram.ActivityObjectNode")});a.bounds={...a.bounds,width:a.bounds.width,height:a.bounds.height},n.push(a);const l=new ce({name:t("packages.ActivityDiagram.ActivityMergeNode")});l.bounds={...l.bounds,width:l.bounds.width,height:l.bounds.height},n.push(l);const c=new re;n.push(c);const d=new ae;return n.push(d),n})(0,n));break;case D.UseCaseDiagram:s.push(...((e,t)=>{const n=[],o=new Ne({name:t("packages.UseCaseDiagram.UseCase")});o.bounds={...o.bounds,width:o.bounds.width,height:o.bounds.height},n.push(o);const s=new Le({name:t("packages.UseCaseDiagram.UseCaseActor"),bounds:{x:0,y:0,width:te(1,80),height:te(1,140)}});n.push(s);const i=new Re({name:t("packages.UseCaseDiagram.UseCaseSystem")});return i.bounds={...i.bounds,width:i.bounds.width,height:i.bounds.height},n.push(i),n})(0,n));break;case D.CommunicationDiagram:s.push(...((e,t)=>{const n=[],o=new Ae({name:t("packages.CommunicationDiagram.ObjectName")});o.bounds={...o.bounds,width:o.bounds.width,height:o.bounds.height};const s=new Pe({name:t("sidebar.classAttribute"),owner:o.id,bounds:{x:0,y:0,width:te(1,200),height:te(1,25)}});return o.ownedElements=[s.id],n.push(...o.render(e,[s])),n})(t,n));break;case D.ComponentDiagram:s.push(...((e,t)=>{const n=[],o=new je({name:t("packages.ComponentDiagram.Component")});o.bounds={...o.bounds,width:o.bounds.width,height:o.bounds.height},n.push(o);const s=new Qe({name:t("packages.ComponentDiagram.Subsystem")});s.bounds={...s.bounds,width:s.bounds.width,height:s.bounds.height},n.push(s);const i=new Se({name:t("packages.ComponentDiagram.ComponentInterface")});i.bounds={...i.bounds,width:i.bounds.width,height:i.bounds.height};const[r]=i.render(e);return r.styles={paddingTop:8},n.push(r),n})(t,n));break;case D.DeploymentDiagram:s.push(...((e,t)=>{const n=[],o=new Te({name:t("packages.DeploymentDiagram.DeploymentNode")});o.bounds={...o.bounds,width:o.bounds.width,height:o.bounds.height},n.push(o);const s=new He({name:t("packages.DeploymentDiagram.DeploymentComponent")});s.bounds={...s.bounds,width:s.bounds.width,height:s.bounds.height},n.push(s);const i=new Ie({name:t("packages.DeploymentDiagram.DeploymentArtifact")});i.bounds={...i.bounds,width:i.bounds.width},n.push(i);const r=new Be({name:t("packages.DeploymentDiagram.DeploymentInterface")});return r.bounds={...r.bounds,width:r.bounds.width,height:r.bounds.height},n.push(r),n})(0,n));break;case D.PetriNet:s.push(...((e,t)=>{const n=[];Oe.defaultHeight=te(1,60),Oe.defaultWidth=te(1,25);const o=new Oe({name:t("packages.PetriNet.PetriNetTransition")});n.push(Object.assign(o,{styles:{marginTop:"25px"}}));const s=new $e({name:t("packages.PetriNet.PetriNetPlace"),bounds:{x:0,y:0,width:te(1,60),height:te(1,60)}});return n.push(s),n})(0,n));break;case D.ReachabilityGraph:s.push(...((e,t)=>{const n=[],o=new Ue({name:t("packages.ReachabilityGraph.ReachabilityGraphMarking"),bounds:{x:0,y:0,width:160,height:100}});return n.push(o),n})(0,n));break;case D.SyntaxTree:s.push(...((e,t)=>{const n=[],o={x:0,y:0,width:100,height:50};return n.push(new Ge({name:"",bounds:o})),n.push(new We({name:"",bounds:o})),n})());break;case D.Flowchart:s.push(...((e,t)=>{const n=[],o={x:0,y:0,width:160,height:te(1,70)};return n.push(new qe({name:t("packages.Flowchart.FlowchartTerminal"),bounds:o})),n.push(new Ye({name:t("packages.Flowchart.FlowchartProcess"),bounds:o})),n.push(new Ve({name:t("packages.Flowchart.FlowchartDecision"),bounds:o})),n.push(new Ze({name:t("packages.Flowchart.FlowchartInputOutput"),bounds:{...o,width:140}})),n.push(new _e({name:t("packages.Flowchart.FlowchartFunctionCall"),bounds:o})),n})(0,n));break;case D.BPMN:s.push(...((e,t)=>{const n=[],o={x:0,y:0,width:160,height:60};return n.push(new Ke({name:t("packages.BPMN.BPMNTask"),bounds:o})),n.push(new Je({name:t("packages.BPMN.BPMNSubprocess"),bounds:o})),n.push(new st({name:t("packages.BPMN.BPMNTransaction"),bounds:o})),n.push(new it({name:t("packages.BPMN.BPMNCallActivity"),bounds:o})),n.push(new dt({bounds:o})),n.push(new rt({name:t("packages.BPMN.BPMNAnnotation"),bounds:o})),n.push(new et({bounds:{x:0,y:0,width:40,height:40}})),n.push(new tt({bounds:{x:0,y:0,width:40,height:40}})),n.push(new nt({bounds:{x:0,y:0,width:40,height:40}})),n.push(new ot({bounds:{x:0,y:0,width:40,height:40}})),n.push(new at({bounds:{x:0,y:0,width:40,height:60}})),n.push(new ht({bounds:{x:0,y:0,width:60,height:60}})),n.push(new lt({name:t("packages.BPMN.BPMNPool"),bounds:{x:0,y:0,width:160,height:80}})),n})(0,n))}return o&&i.push(new Xe({name:n("packages.ColorLegend.ColorLegend")})),{previews:s,utils:i}})(this.props),this.getElementArray=e=>Object.values(e).filter((e=>!e.owner)).map(((e,t)=>{const{styles:n}=e;return W.createElement("div",{style:{...n,height:e.bounds.height*(this.props?.previewScaleFactor??.8)+8},key:t},W.createElement(Aa,{element:e,create:this.create}))})),this.create=(e,t)=>{const n=Ln(e,this.state.previews);this.props.create(n,t)}}render(){const{previews:e,utils:t}=this.state,n=[...e,...t].reduce(((e,t)=>({...e,[t.id]:{...t}})),{});return W.createElement(Sa,{initialState:{elements:n,editor:{features:{hoverable:!1,selectable:!1,movable:!1,resizable:!1,connectable:!1,updatable:!1,droppable:!1,alternativePortVisualization:!1}}}},W.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:8}},this.getElementArray(e)),t&&t.length>0?W.createElement(W.Fragment,null,W.createElement(La,null),this.getElementArray(t)):null)}}const Ba=Ra(Na),Oa=qt.Ay.aside.attrs({})`
  flex: 0 0 148px;
  padding: 0 10px;
  height: 100%;
  min-height: inherit;
  max-height: inherit;
  overflow-x: hidden;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  align-items: center;

  svg {
    display: block;
    margin-left: auto;
    margin-right: auto;
  }
`,$a=(0,Do.Zz)(xr,(0,wo.Ng)((e=>({readonly:e.editor.readonly,mode:e.editor.mode,view:e.editor.view,selected:e.selected})),{changeView:_i.changeView}));class Ua extends W.Component{constructor(){super(...arguments),this.toggleInteractiveElementsMode=e=>{const{checked:t}=e.currentTarget,n=t?oo.Exporting:oo.Highlight;this.props.changeView(n)}}render(){return this.props.readonly||this.props.mode===no.Assessment?null:W.createElement(Oa,{id:"modeling-editor-sidebar","data-cy":"modeling-editor-sidebar"},this.props.mode===no.Exporting&&W.createElement("div",{className:"dropdown",style:{width:128}},W.createElement("select",{value:this.props.view,onChange:e=>this.props.changeView(e.target.value),color:"primary"},W.createElement("option",{value:oo.Modelling},this.props.translate("views.modelling")),W.createElement("option",{value:oo.Exporting},this.props.translate("views.exporting")))),this.props.view===oo.Modelling?W.createElement(Ba,null):W.createElement("label",{htmlFor:"toggleInteractiveElementsMode"},W.createElement("input",{id:"toggleInteractiveElementsMode",type:"checkbox",checked:this.props.view===oo.Exporting,onChange:this.toggleInteractiveElementsMode}),this.props.translate("views.highlight")))}}const Fa=$a(Ua),za=(e,t)=>{let n={...e};for(let[e,o]of Object.entries(t))o instanceof Object&&(o=za(n[e],o)),n={...n,[e]:o};return n};class Ha extends W.Component{constructor(){super(...arguments),this.theme=za(Zt(),this.props.styles)}render(){return W.createElement(qt.NP,{theme:this.theme},this.props.children)}}function ja(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(!t)return{h:0,s:0,l:0};const n=parseInt(t[1],16)/255,o=parseInt(t[2],16)/255,s=parseInt(t[3],16)/255,i=Math.max(n,o,s),r=Math.min(n,o,s);let a=0,l=0;const c=(i+r)/2;if(i===r)a=l=0;else{const e=i-r;switch(l=c>.5?e/(2-i-r):e/(i+r),i){case n:a=(o-s)/e+(o<s?6:0);break;case o:a=(s-n)/e+2;break;case s:a=(n-o)/e+4}a/=6}return{h:a,s:l,l:c}}function Qa({h:e,s:t,l:n}){let o=0,s=0,i=0;if(0===t)o=s=i=n;else{const r=(e,t,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e),a=n<.5?n*(1+t):n+t-n*t,l=2*n-a;o=r(l,a,e+1/3),s=r(l,a,e),i=r(l,a,e-1/3)}o=Math.round(255*o),s=Math.round(255*s),i=Math.round(255*i);const r=e=>1===e.length?"0"+e:e;return"#"+r(o.toString(16))+r(s.toString(16))+r(i.toString(16))}Ha.defaultProps={styles:{}};const Wa=(e,t)=>{const n=ja(e);return Qa({...n,l:n.l-t/100})},Ga=_t(_t.button`
  appearance: button;
  background-color: transparent;
  border: 1px solid transparent;
  border-radius: 0.25em;
  font-family: inherit;
  font-size: 1em;
  font-weight: 400;
  line-height: 1.5;
  margin: 0;
  overflow: visible;
  padding: 0.375em 0.75em;
  text-transform: none;
  transition:
    color 0.15s ease-in-out,
    background-color 0.15s ease-in-out,
    border-color 0.15s ease-in-out,
    box-shadow 0.15s ease-in-out;
  user-select: none;

  svg {
    pointer-events: none;
  }

  ::-moz-focus-inner {
    border-style: none;
    padding: 0;
  }

  :focus {
    outline: 0;
  }

  :not(:disabled) {
    cursor: pointer;
  }
`)((e=>{const t="link"!==e.color?e.theme.color[e.color]:e.theme.color.primary;return Vt`
    ${e.block&&Vt`
      display: block;
      width: 100%;
    `}

    ${e.disabled&&Vt`
      opacity: 0.65;
    `}

    ${"sm"===e.size&&Vt`
      border-radius: 0.2em;
      font-size: 0.875em;
      padding: 0.25em 0.5em;
    `}

    ${"lg"===e.size&&Vt`
      border-radius: 0.3em;
      font-size: 1.25em;
      padding: 0.5em 1em;
    `}

    ${"link"===e.color&&Vt`
      color: ${e.theme.color.primary};
      text-decoration: none;
      fill: ${e.theme.color.primaryContrast};
    `}

    ${"link"!==e.color&&Vt`
      :focus {
        box-shadow: 0 0 0 0.2em ${t}80;
      }
    `}

    ${"link"!==e.color&&!e.outline&&Vt`
      background-color: ${t};
      border-color: ${t};
      color: ${e.theme.color.background};

      :hover {
        background-color: ${Wa(t,7.5)};
        border-color: ${Wa(t,10)};
      }

      :active {
        background-color: ${Wa(t,10)};
        border-color: ${Wa(t,12.5)};
      }
    `}

    ${"link"!==e.color&&e.outline&&Vt`
      border-color: ${t};
      color: ${t};

      :hover {
        background-color: ${t};
        color: ${e.theme.color.background};
      }
    `}
  `})),qa=Object.freeze({block:!1,color:"secondary",disabled:!1,outline:!1,size:"sm"}),_a=(0,W.forwardRef)(((e,t)=>(0,W.createElement)(Ga,{...e,ref:t})));_a.defaultProps=qa;const Va=e=>W.createElement(qo,{viewBox:"0 0 107.01 122.88",...e},W.createElement("path",{d:"M107.01,20.54h-3.62v3.08c0,2.93-1.19,5.58-3.12,7.51c-1.93,1.92-4.58,3.12-7.51,3.12H22.71c-2.93,0-5.58-1.19-7.51-3.12 c-1.93-1.93-3.12-4.58-3.12-7.51V20.1h-1.45c-1.54,0-2.94,0.63-3.96,1.65c-1.02,1.02-1.65,2.42-1.65,3.96v16.24 c0,1.54,0.63,2.94,1.65,3.96c1.02,1.02,2.42,1.65,3.96,1.65h28.31c1.23,0,1.66-0.01,2.08-0.01c4.87-0.08,10.31-0.17,14.56,2.91 c1.46,1.05,2.62,2.39,3.46,4.04c0.81,1.58,1.3,3.44,1.46,5.59c0,0.06,0.01,0.12,0.01,0.18h0v8.21h4.29c1.88,0,3.59,0.77,4.82,2 c1.24,1.24,2,2.94,2,4.82v40.76c0,1.88-0.77,3.59-2,4.82c-1.24,1.24-2.94,2-4.82,2H51.46c-1.88,0-3.59-0.77-4.82-2 c-1.24-1.24-2-2.94-2-4.82V75.3c0-1.88,0.77-3.59,2-4.82c1.24-1.24,2.94-2,4.82-2h4.03v-8.16c-0.11-1.4-0.43-2.57-0.92-3.54 c-0.47-0.93-1.12-1.67-1.93-2.26c-2.91-2.11-7.47-2.04-11.54-1.97c-1.02,0.02-2.02,0.03-2.16,0.03H10.63 c-2.93,0-5.58-1.19-7.51-3.12C1.19,47.53,0,44.87,0,41.95V25.71c0-2.93,1.2-5.58,3.12-7.51c1.93-1.92,4.58-3.12,7.51-3.12h1.45 v-4.45c0-2.93,1.19-5.58,3.12-7.51C17.13,1.19,19.78,0,22.71,0h70.05c2.93,0,5.58,1.19,7.51,3.12c1.93,1.92,3.12,4.58,3.12,7.51 v4.89h3.62V20.54L107.01,20.54z M92.76,5.01H22.71c-1.54,0-2.94,0.63-3.96,1.65c-1.02,1.02-1.65,2.42-1.65,3.96v12.99 c0,1.54,0.63,2.94,1.65,3.96c1.02,1.02,2.42,1.65,3.96,1.65h70.05c1.54,0,2.94-0.63,3.96-1.65c1.02-1.02,1.65-2.42,1.65-3.96V10.63 c0-1.54-0.63-2.94-1.65-3.96C95.7,5.65,94.3,5.01,92.76,5.01L92.76,5.01z M64.79,73.49H51.46c-0.49,0-0.95,0.2-1.28,0.53 c-0.33,0.33-0.53,0.78-0.53,1.28v40.76c0,0.49,0.2,0.95,0.53,1.28c0.33,0.33,0.78,0.53,1.28,0.53h13.33c0.49,0,0.95-0.2,1.28-0.53 c0.33-0.33,0.53-0.78,0.53-1.28V75.3c0-0.49-0.2-0.95-0.53-1.28C65.74,73.69,65.28,73.49,64.79,73.49L64.79,73.49z"})),Ya=(0,wo.Ng)((e=>({colorEnabled:e.editor.colorEnabled})))((function({onClick:e,colorEnabled:t}){return t?W.createElement(_a,{color:"link",tabIndex:-1,onClick:e},W.createElement(Va,null)):null})),Za=e=>W.createElement(qo,{viewBox:"0 0 448 512",...e},W.createElement("path",{d:"M440 64H336l-33.6-44.8A48 48 0 0 0 264 0h-80a48 48 0 0 0-38.4 19.2L112 64H8a8 8 0 0 0-8 8v16a8 8 0 0 0 8 8h18.9l33.2 372.3a48 48 0 0 0 47.8 43.7h232.2a48 48 0 0 0 47.8-43.7L421.1 96H440a8 8 0 0 0 8-8V72a8 8 0 0 0-8-8zM171.2 38.4A16.1 16.1 0 0 1 184 32h80a16.1 16.1 0 0 1 12.8 6.4L296 64H152zm184.8 427a15.91 15.91 0 0 1-15.9 14.6H107.9A15.91 15.91 0 0 1 92 465.4L59 96h330z"})),Xa=_t(_t.textarea`
  background-clip: padding-box;
  background-color: ${e=>e.theme.color.background};
  border: 1px solid ${e=>e.theme.color.grayAccent};
  border-radius: 0.25em;
  color: ${e=>e.theme.color.grayAccent};
  font-family: ${e=>e.theme.font.family}, sans-serif;
  font-size: 1em;
  font-weight: 400;
  line-height: 1.5;
  margin: 0;
  overflow: visible;
  padding: 0.375em 0.75em;
  transition:
    border-color 0.15s ease-in-out,
    box-shadow 0.15s ease-in-out;

  :focus {
    border-color: ${e=>((e,t)=>{const n=ja(e);return Qa({...n,l:n.l+.25})})(e.theme.color.primary)};
    outline: 0;
    box-shadow: 0 0 0 0.2em ${e=>e.theme.color.primary}40;
  }

  ::placeholder {
    color: ${e=>e.theme.color.grayAccent};
    opacity: 1;
  }
`)((e=>Vt`
    ${e.gutter&&Vt`
      margin-bottom: 0.5em;
    `}

    ${e.multiline&&Vt`
      resize: vertical;
    `}

    ${e.outline&&Vt`
      &:not(:focus) {
        border-style: dashed;
      }

      &:not(:focus):not(:hover) {
        background: ${e.theme.color.background};
        opacity: 0.5;
      }
    `}

    ${e.block&&Vt`
      display: block;
      width: 100%;
    `}

    ${e.readonly&&Vt`
      background-color: ${e.theme.color.gray};
      opacity: 1;
    `}

    ${e.size&&"sm"===e.size&&Vt`
      border-radius: 0.2em;
      font-size: 0.875em;
      padding: 0.25em 0.5em;
    `}

    ${e.size&&"lg"===e.size&&Vt`
      border-radius: 0.3em;
      font-size: 1.25em;
      padding: 0.5em 1em;
    `}
  `)),Ka=Object.freeze({block:!0,gutter:!1,multiline:!1,outline:!1,readonly:!1,size:"sm",enterToSubmit:!0}),Ja=()=>({key:Date.now(),currentValue:void 0});class el extends W.Component{constructor(){super(...arguments),this.state=Ja(),this.ref=W.createRef(),this.onBlur=({currentTarget:e})=>{const t="number"==typeof this.props.value?+e.value:e.value;t&&this.props.onSubmit&&(this.props.onSubmit(t),this.setState(Ja()))},this.onChange=({currentTarget:e})=>{const t="number"==typeof this.props.value?+e.value:e.value;this.setState({currentValue:t}),this.props.onChange&&this.props.onChange(t)},this.onKeyUp=({key:e,currentTarget:t})=>{const n="number"==typeof this.props.value?+t.value:t.value;switch(e){case"Enter":this.props.enterToSubmit&&(t.blur(),this.onSubmitKeyUp(e,n));break;case"Escape":t.blur(),this.onSubmitKeyUp(e,n)}},this.onSubmitKeyUp=(e,t)=>{this.props.onSubmitKeyUp&&("Enter"!==e||this.props.enterToSubmit)&&this.props.onSubmitKeyUp(e,t)}}componentDidUpdate(e,t,n){Number.isFinite(e.value)&&!Number.isFinite(this.props.value)&&this.setState({key:Date.now()})}componentWillUnmount(){this.state.currentValue&&this.props.onSubmit&&this.props.onSubmit(this.state.currentValue)}render(){const{onChange:e,onSubmit:t,onSubmitKeyUp:n,size:o,value:s,...i}=this.props;return W.createElement(Xa,{as:i.multiline?"textarea":"input",maxLength:i.multiline?void 0:100,key:this.state.key,...i,size:o,defaultValue:s,onChange:this.onChange,onKeyUp:this.onKeyUp,onBlur:this.onBlur,ref:this.ref})}focus(){this.ref.current&&this.ref.current.focus()}}el.defaultProps=Ka;const tl=qt.Ay.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  margin: 10px 0;
  background-color: white;
  border: 1px solid ${e=>e.theme.color.gray};
`,nl=qt.Ay.button.attrs({})`
  height: 28px;
  width: 28px;
  background-color: ${({color:e,selected:t})=>t?"transparent":e||"black"};
  border-radius: 14px;
  cursor: pointer;
  border: none;
  position: relative;
  &:after,
  &:before {
    content: '';
    width: 2px;
    height: 100%;
    background: ${e=>e.theme.color.primaryContrast};
    position: absolute;
    top: 0;
    left: 50%;
    transform: translate(-50%) rotate(45deg);
    display: ${({selected:e})=>e?"block":"none"};
  }
  &:before {
    transform: translate(-50%) rotate(-45deg);
  }
`,ol=qt.Ay.div`
  display: flex;
  width: 100%;
  justify-content: space-between;
  padding: 16px;
  /* border-bottom: 1px solid #353d47; */
  font-weight: bold;
  background-color: ${e=>e.theme.color.background};
  color: ${e=>e.theme.color.primaryContrast};
  &:last-of-type {
    border-bottom: none;
  }
`,sl=qt.Ay.div`
  width: 100%;
  background: ${e=>e.theme.color.backgroundVariant};
  height: 1px;
`,il=qt.Ay.button`
  background: white;
  color: #212529;
  border: 1px solid rgba(0, 0, 0, 0.15);
  padding: 0.375rem 0.75rem;
  margin: 0;
  margin-top: 0.75rem;
  line-height: 1.5;
  outline: none;
  align-self: center;
  cursor: pointer;
`,rl=["#fc5c65","#fd9644","#fed330","#26de81","#2bcbba","#45aaf2","#4b7bec","#6a89cc","#a55eea","#d1d8e0","#778ca3","black"],al=qt.Ay.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: ${e=>e.theme.color.background};
  width: 100%;
  padding-bottom: 10px;
`,ll=qt.Ay.div`
  display: flex;
  justify-content: center;
  align-items: center;
  flex-wrap: wrap;
`,cl=qt.Ay.button.attrs({})`
  height: 28px;
  width: 28px;
  background-color: ${({color:e})=>e||"black"};
  border-radius: 14px;
  cursor: pointer;
  border: none;
  position: relative;
  margin: 10px;
  box-shadow: ${({color:e,selected:t})=>t?`0px 0px 10px ${e}`:"none"};
`;function dl({onColorChange:e,color:t,open:n,key:o}){return n?W.createElement(W.Fragment,null,n?W.createElement(al,null,W.createElement(ll,null,rl.map((n=>W.createElement(cl,{key:o,color:n,onClick:()=>{e(n)},selected:n===t})))),W.createElement(il,{onClick:()=>{e(void 0)}},"Reset")):null):null}const hl=(0,Do.Zz)(xr,Ro,(0,wo.Ng)((e=>({type:e.diagram.type,selected:e.selected,elements:e.elements})),{updateStart:uo.updateStart,update:uo.update,updateEnd:uo.updateEnd}));class ul extends W.Component{constructor(){super(...arguments),this.state={fillSelectOpen:!1,strokeSelectOpen:!1,textSelectOpen:!1},this.handleFillColorChange=e=>{const{element:t,onColorChange:n}=this.props;n(t.id,{fillColor:e})},this.handleLineColorChange=e=>{const{element:t,onColorChange:n}=this.props;n(t.id,{strokeColor:e})},this.handleTextColorChange=e=>{const{element:t,onColorChange:n}=this.props;n(t.id,{textColor:e})},this.toggleFillSelect=()=>{this.setState((e=>({fillSelectOpen:!e.fillSelectOpen,strokeSelectOpen:!1,textSelectOpen:!1})))},this.toggleLineSelect=()=>{this.setState((e=>({strokeSelectOpen:!e.strokeSelectOpen,fillSelectOpen:!1,textSelectOpen:!1})))},this.toggleTextSelect=()=>{this.setState((e=>({textSelectOpen:!e.textSelectOpen,strokeSelectOpen:!1,fillSelectOpen:!1})))}}render(){const{fillSelectOpen:e,strokeSelectOpen:t,textSelectOpen:n}=this.state,{open:o,element:s,fillColor:i,lineColor:r,textColor:a}=this.props,l=!e&&!t&&!n;return o?W.createElement(tl,null,W.createElement(pl,{title:"Fill Color",condition:i&&(e||l),color:s?.fillColor,open:e,onToggle:this.toggleFillSelect,onColorChange:this.handleFillColorChange,noDivider:!a&&!r}),W.createElement(pl,{title:"Line Color",condition:r&&(t||l),color:s?.strokeColor,open:t,onToggle:this.toggleLineSelect,onColorChange:this.handleLineColorChange,noDivider:!a}),W.createElement(pl,{title:"Text Color",condition:a&&(n||l),color:s?.textColor,open:n,onToggle:this.toggleTextSelect,onColorChange:this.handleTextColorChange,noDivider:!0})):null}}const pl=({condition:e,title:t,open:n,onToggle:o,onColorChange:s,color:i,noDivider:r})=>e?W.createElement(W.Fragment,null,W.createElement(ol,null,W.createElement("span",null,t),W.createElement(nl,{color:i,selected:n,onClick:o})),W.createElement(dl,{open:n,color:i,onColorChange:s,key:t}),n||r?null:W.createElement(sl,null)):null,ml=hl(ul),gl=_t.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class yl extends W.Component{constructor(){super(...arguments),this.state={colorOpen:!1},this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.onUpdate=e=>{const{element:t,update:n}=this.props;n(t.id,{name:e})}}render(){const{element:e}=this.props;return W.createElement("div",null,W.createElement("section",null,W.createElement(gl,null,W.createElement(el,{value:e.name,onChange:this.onUpdate,autoFocus:!0}),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(_a,{color:"link",tabIndex:-1,onClick:()=>this.props.delete(e.id)},W.createElement(Za,null)))),W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,lineColor:!0,textColor:!0,fillColor:!0}))}}const fl=(0,wo.Ng)(null,{update:uo.update,delete:uo.delete})(yl),Cl=_t.p`
  margin-top: 0;

  ${e=>"header"===e.variant&&Vt`
      font-size: 1.25em;
      font-weight: 500;
      line-height: 1.2;
      margin-bottom: 0.5em;
    `}

  ${e=>"body"===e.variant&&Vt`
      margin-bottom: 1em;
    `}

  ${e=>!e.gutter&&Vt`
      margin-bottom: 0;
    `}
`,El=e=>W.createElement(Cl,{variant:"header",as:"h1",...e});El.defaultProps={gutter:!0};const bl=e=>{const{gutter:t,...n}=e;return W.createElement(Cl,{variant:"body",as:"span",gutter:!1,...n})};bl.defaultProps={gutter:!1};const vl=_t.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class wl extends W.Component{constructor(){super(...arguments),this.state={colorOpen:!1},this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))}}render(){const{element:e}=this.props;return W.createElement("div",null,W.createElement("section",null,W.createElement(vl,null,W.createElement(El,null,this.props.translate("popup.relationship")),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(_a,{color:"link",tabIndex:-1,onClick:()=>this.props.delete(e.id)},W.createElement(Za,null)))),W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,lineColor:!0}))}}const kl=(0,Do.Zz)(xr,(0,wo.Ng)(null,{update:uo.update,delete:uo.delete}))(wl),xl=_t.hr`
  border: 0;
  border-top: 1px solid ${e=>e.theme.color.primaryContrast};
  box-sizing: content-box;
  height: 0;
  margin-top: 0.75em;
  margin-bottom: 0.75em;
  overflow: visible;
`,Ml=_t.div`
  display: flex;
  min-height: 1.9rem;
`,Sl=_t(_a).attrs((e=>({outline:!e.selected})))`
  flex: 1 1 auto;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  display: flex;
  align-items: center;
  justify-content: center;

  :not(:first-child) {
    margin-left: -1px;
  }

  :first-child {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
  }

  :last-child {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
  }

  :not(:first-child):not(:last-child) {
    border-radius: 0;
  }
`,Il=Object.freeze({color:"primary",size:"sm"});class Tl extends W.Component{constructor(){super(...arguments),this.select=e=>()=>{this.props.onChange&&this.props.onChange(e)}}render(){return W.createElement(Ml,null,W.Children.map(this.props.children,(({props:e})=>this.renderItem(e))))}renderItem(e){const{color:t,size:n,value:o}=this.props;return W.createElement(Sl,{color:t,onClick:this.select(e.value),selected:e.value===o,size:n},e.children)}}Tl.defaultProps=Il,Tl.Item=e=>null;const Pl=qt.Ay.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`,Dl=({id:e,onRefChange:t,value:n,onChange:o,onSubmitKeyUp:s,onDelete:i,element:r})=>{const[a,l]=(0,W.useState)(!1);return W.createElement(W.Fragment,null,W.createElement(Pl,null,W.createElement(el,{ref:t,gutter:!0,value:n,onChange:t=>{o(e,{name:t})},onSubmitKeyUp:s}),W.createElement(Ya,{onClick:()=>{l(!a)}}),W.createElement(_a,{color:"link",tabIndex:-1,onClick:()=>{i(e)()}},W.createElement(Za,null))),W.createElement(ml,{open:a,element:r,onColorChange:o,fillColor:!0,textColor:!0}))},Al=qt.Ay.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`,Ll=(0,Do.Zz)(xr,(0,wo.Ng)(null,{create:uo.create,update:uo.update,delete:uo.delete,getById:uo.getById}));class Rl extends W.Component{constructor(){super(...arguments),this.state={fieldToFocus:void 0,colorOpen:!1},this.newMethodField=(0,W.createRef)(),this.newAttributeField=(0,W.createRef)(),this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.create=e=>t=>{const{element:n,create:o}=this.props,s=new e;s.name=t,o(s,n.id)},this.rename=e=>t=>{this.props.update(e,{name:t})},this.toggle=e=>{const{element:t,update:n}=this.props,o=t.type===e?y.Class:e,s=new ut[o]({id:t.id,name:t.name,type:t.type,owner:t.owner,bounds:t.bounds,ownedElements:t.ownedElements});n(t.id,s)},this.delete=e=>()=>{this.props.delete(e)}}componentDidUpdate(e,t,n){this.state.fieldToFocus&&(this.state.fieldToFocus.focus(),this.setState({fieldToFocus:void 0}))}render(){const{element:e,getById:t}=this.props,n=e.ownedElements.map((e=>t(e))).filter(po),o=n.filter((e=>e instanceof Ee)),s=n.filter((e=>e instanceof be)),i=[],r=[];return W.createElement("div",null,W.createElement("section",null,W.createElement(Al,null,W.createElement(el,{value:e.name,onChange:this.rename(e.id),autoFocus:!0}),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(_a,{color:"link",tabIndex:-1,onClick:this.delete(e.id)},W.createElement(Za,null))),W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,fillColor:!0,lineColor:!0,textColor:!0}),W.createElement(xl,null)),W.createElement("section",null,W.createElement(Tl,{value:e.type,onChange:this.toggle,color:"primary"},W.createElement(Tl.Item,{value:y.AbstractClass},this.props.translate("packages.ClassDiagram.AbstractClass")),W.createElement(Tl.Item,{value:y.Interface},this.props.translate("packages.ClassDiagram.Interface")),W.createElement(Tl.Item,{value:y.Enumeration},this.props.translate("packages.ClassDiagram.Enumeration"))),W.createElement(xl,null)),W.createElement("section",null,W.createElement(El,null,this.props.translate("popup.attributes")),o.map(((e,t)=>W.createElement(Dl,{id:e.id,key:e.id,value:e.name,onChange:this.props.update,onSubmitKeyUp:()=>t===o.length-1?this.newAttributeField.current?.focus():this.setState({fieldToFocus:i[t+1]}),onDelete:this.delete,onRefChange:e=>i[t]=e,element:e}))),W.createElement(el,{ref:this.newAttributeField,outline:!0,value:"",onSubmit:this.create(Ee),onSubmitKeyUp:(e,t)=>{t?this.setState({fieldToFocus:this.newAttributeField.current}):r&&r.length>0?this.setState({fieldToFocus:r[0]}):this.setState({fieldToFocus:this.newMethodField.current})},onKeyDown:e=>{"Tab"===e.key&&e.currentTarget.value&&(e.preventDefault(),e.currentTarget.blur(),this.setState({fieldToFocus:this.newAttributeField.current}))}})),W.createElement("section",null,W.createElement(xl,null),W.createElement(El,null,this.props.translate("popup.methods")),s.map(((e,t)=>W.createElement(Dl,{id:e.id,key:e.id,value:e.name,onChange:this.props.update,onSubmitKeyUp:()=>t===s.length-1?this.newMethodField.current?.focus():this.setState({fieldToFocus:r[t+1]}),onDelete:this.delete,onRefChange:e=>r[t]=e,element:e}))),W.createElement(el,{ref:this.newMethodField,outline:!0,value:"",onSubmit:this.create(be),onSubmitKeyUp:()=>this.setState({fieldToFocus:this.newMethodField.current}),onKeyDown:e=>{"Tab"===e.key&&e.currentTarget.value&&(e.preventDefault(),e.currentTarget.blur(),this.setState({fieldToFocus:this.newMethodField.current}))}})))}}const Nl=Ll(Rl),Bl=e=>W.createElement(qo,{viewBox:"0 0 512 512",...e},W.createElement("path",{d:"M508.485 184.485l-92.485 92c-4.687 4.686-12.284 4.686-16.97 0l-7.071-7.07c-4.687-4.686-4.687-12.284 0-16.971L452.893 192H12c-6.627 0-12-5.373-12-12v-8c0-6.627 5.373-12 12-12h440.905l-60.946-60.444c-4.687-4.686-4.687-12.284 0-16.971l7.07-7.07c4.687-4.686 12.284-4.686 16.971 0l92.485 92c4.687 4.686 4.686 12.284 0 16.97zm-504.97 160l92.485 92c4.687 4.686 12.284 4.686 16.971 0l7.07-7.07c4.687-4.686 4.687-12.284 0-16.971L59.095 352H500c6.627 0 12-5.373 12-12v-8c0-6.627-5.373-12-12-12H59.107l60.934-60.444c4.687-4.686 4.687-12.284 0-16.971l-7.071-7.07c-4.686-4.686-12.284-4.687-16.97 0l-92.485 92c-4.686 4.686-4.687 12.284 0 16.97z"})),Ol=qt.Ay.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class $l extends W.Component{constructor(){super(...arguments),this.state={colorOpen:!1},this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.rename=e=>{this.props.update(this.props.element.id,{name:e})}}render(){const{element:e}=this.props;return W.createElement("div",null,W.createElement("section",null,W.createElement(Ol,null,W.createElement(El,{gutter:!1,style:{flexGrow:1}},this.props.translate("packages.ActivityDiagram.ActivityControlFlow")),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(_a,{color:"link",onClick:()=>this.props.flip(e.id)},W.createElement(Bl,null)),W.createElement(_a,{color:"link",onClick:()=>this.props.delete(e.id)},W.createElement(Za,null))),W.createElement(xl,null)),W.createElement("section",null,W.createElement(el,{value:e.name,onChange:this.rename,autoFocus:!0})),W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,lineColor:!0,textColor:!0}))}}const Ul=(0,Do.Zz)(xr,(0,wo.Ng)(null,{update:uo.update,delete:uo.delete,flip:go.flip}))($l),Fl=e=>W.createElement(qo,{viewBox:"0 0 448 512",...e},W.createElement("path",{d:"M311.03 131.515l-7.071 7.07c-4.686 4.686-4.686 12.284 0 16.971L387.887 239H12c-6.627 0-12 5.373-12 12v10c0 6.627 5.373 12 12 12h375.887l-83.928 83.444c-4.686 4.686-4.686 12.284 0 16.971l7.071 7.07c4.686 4.686 12.284 4.686 16.97 0l116.485-116c4.686-4.686 4.686-12.284 0-16.971L328 131.515c-4.686-4.687-12.284-4.687-16.97 0z"})),zl=_t.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class Hl extends W.Component{constructor(){super(...arguments),this.state={colorOpen:!1},this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.onUpdate=e=>{const{element:t,update:n}=this.props;n(t.id,{name:e})},this.onUpdateOption=e=>t=>{const{update:n}=this.props;n(e,{name:t})}}render(){const{element:e,decisions:t,targets:n,update:o}=this.props;return W.createElement("div",null,W.createElement("section",null,W.createElement(zl,null,W.createElement(el,{value:e.name,onChange:this.onUpdate}),W.createElement(Ya,{onClick:this.toggleColor})),W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:o,fillColor:!0,lineColor:!0,textColor:!0})),W.createElement("section",null,t.length>0&&W.createElement(W.Fragment,null,W.createElement(xl,null),W.createElement(El,null,this.props.translate("popup.condition")),t.map(((e,o)=>W.createElement(zl,{key:e.id},W.createElement(el,{gutter:o<t.length-1,value:e.name,onChange:this.onUpdateOption(e.id)}),W.createElement(_a,{color:"link",disabled:!0},W.createElement(Fl,null)),W.createElement(bl,null,n[o].name)))))))}}const jl=(0,Do.Zz)(xr,(0,wo.Ng)(((e,t)=>{const n=Object.values(e.elements).filter((e=>Qt.isUMLRelationship(e))).filter((e=>e.source.element===t.element.id));return{decisions:n,targets:n.map((t=>e.elements[t.target.element]))}}),{update:uo.update,getById:uo.getById}))(Hl),Ql=e=>W.createElement(qo,{viewBox:"0 0 128 128",...e},W.createElement("path",{d:"M74.1387 93.5415L92.8052 64.1677H101.049V65.1153L81.9085 93.5415H74.1387ZM74.1387 35.3625H81.9085L101.049 63.7887V64.7363H92.8052L74.1387 35.3625ZM98.7273 93.5415L117.394 64.1677H125.637V65.1153L106.497 93.5415H98.7273ZM98.7273 35.3625H106.497L125.637 63.7887V64.7363H117.394L98.7273 35.3625Z",fill:"black"}),W.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M72.068 34.225C72.4831 33.4695 73.2767 33 74.1387 33H81.9085C82.6946 33 83.4292 33.391 83.8682 34.043L103.009 62.4692C103.271 62.8592 103.411 63.3186 103.411 63.7887V65.1153C103.411 65.5854 103.271 66.0448 103.009 66.4348L83.8682 94.861C83.4292 95.513 82.6946 95.904 81.9085 95.904H74.1387C73.2767 95.904 72.4831 95.4345 72.068 94.679C71.653 93.9235 71.6824 93.0019 72.1447 92.2743L89.8254 64.452L72.1447 36.6297C71.6824 35.9021 71.653 34.9805 72.068 34.225ZM93.7418 67.0988L78.4393 91.1789H80.6511L96.8651 67.0988H93.7418ZM96.8651 61.8052H93.7418L78.4393 37.7251H80.6511L96.8651 61.8052ZM96.6567 34.225C97.0717 33.4695 97.8653 33 98.7273 33H106.497C107.283 33 108.018 33.391 108.457 34.043L127.597 62.4692C127.86 62.8592 128 63.3186 128 63.7887V65.1153C128 65.5854 127.86 66.0448 127.597 66.4348L108.457 94.861C108.018 95.513 107.283 95.904 106.497 95.904H98.7273C97.8653 95.904 97.0717 95.4345 96.6567 94.679C96.2416 93.9235 96.271 93.0019 96.7334 92.2743L114.414 64.452L96.7334 36.6297C96.271 35.9021 96.2416 34.9805 96.6567 34.225ZM118.33 67.0988L103.028 91.1789H105.24L121.454 67.0988H118.33ZM121.454 61.8052H118.33L103.028 37.7251H105.24L121.454 61.8052Z",fill:"black"}),W.createElement("path",{d:"M29.2727 93.5415H21.5028L2.36253 65.1153V64.1677H10.5588L29.2727 93.5415ZM29.2727 35.3625L10.5588 64.7363H2.36253V63.7887L21.5028 35.3625H29.2727ZM53.5297 93.5415H45.7599L26.6196 65.1153V64.1677H34.8158L53.5297 93.5415ZM53.5297 35.3625L34.8158 64.7363H26.6196V63.7887L45.7599 35.3625H53.5297Z",fill:"black"}),W.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.5431 34.043C19.9822 33.391 20.7168 33 21.5028 33H29.2727C30.1352 33 30.9291 33.47 31.344 34.2262C31.7588 34.9824 31.7286 35.9045 31.2652 36.632L13.5411 64.452L31.2652 92.2721C31.7286 92.9995 31.7588 93.9216 31.344 94.6778C30.9291 95.434 30.1352 95.904 29.2727 95.904H21.5028C20.7168 95.904 19.9822 95.513 19.5431 94.861L0.402837 66.4348C0.140261 66.0448 0 65.5854 0 65.1153V63.7887C0 63.3186 0.140261 62.8592 0.402837 62.4692L19.5431 34.043ZM6.54628 67.0988L22.7602 91.1789H24.9662L9.62486 67.0988H6.54628ZM9.62486 61.8052H6.54628L22.7602 37.7251H24.9662L9.62486 61.8052ZM43.8002 34.043C44.2392 33.391 44.9738 33 45.7599 33H53.5297C54.3922 33 55.1861 33.47 55.601 34.2262C56.0158 34.9824 55.9856 35.9045 55.5222 36.632L37.7981 64.452L55.5222 92.2721C55.9856 92.9995 56.0158 93.9216 55.601 94.6778C55.1861 95.434 54.3922 95.904 53.5297 95.904H45.7599C44.9738 95.904 44.2392 95.513 43.8002 94.861L24.6599 66.4348C24.3973 66.0448 24.257 65.5854 24.257 65.1153V63.7887C24.257 63.3186 24.3973 62.8592 24.6599 62.4692L43.8002 34.043ZM30.8033 67.0988L47.0173 91.1789H49.2233L33.8819 67.0988H30.8033ZM33.8819 61.8052H30.8033L47.0173 37.7251H49.2233L33.8819 61.8052Z",fill:"black"})),Wl=e=>W.createElement(qo,{viewBox:"0 0 128 128",...e},W.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M82.1654 32.6199C82.0806 32.6106 81.9949 32.6059 81.9085 32.6059H74.1387C73.2767 32.6059 72.4831 33.0754 72.068 33.8309C71.653 34.5864 71.6824 35.508 72.1447 36.2356L74.6334 40.1518L82.1654 32.6199ZM42.8297 71.9556L37.7981 64.0579L55.5222 36.2378C55.9856 35.5104 56.0158 34.5883 55.601 33.8321C55.1861 33.0759 54.3922 32.6059 53.5297 32.6059H45.7599C44.9738 32.6059 44.2392 32.9969 43.8002 33.6489L24.6599 62.0751C24.3973 62.465 24.257 62.9245 24.257 63.3946V64.7212C24.257 65.1913 24.3973 65.6507 24.6599 66.0407L34.3513 80.4339L42.8297 71.9556ZM47.3686 95.5099L53.7626 89.116L55.5222 91.8779C55.9856 92.6054 56.0158 93.5275 55.601 94.2837C55.1861 95.0399 54.3922 95.5099 53.5297 95.5099H47.3686ZM28.0126 86.7726L19.9011 94.8841C19.7674 94.7608 19.647 94.6212 19.5431 94.4669L0.402837 66.0407C0.140261 65.6507 0 65.1913 0 64.7212V63.3946C0 62.9245 0.140261 62.465 0.402837 62.0751L19.5431 33.6489C19.9822 32.9969 20.7168 32.6059 21.5028 32.6059H29.2727C30.1352 32.6059 30.9291 33.0759 31.344 33.8321C31.7588 34.5883 31.7286 35.5104 31.2652 36.2378L13.5411 64.0579L28.0126 86.7726ZM85.5494 57.3292L94.0734 48.8051L103.009 62.0751C103.271 62.465 103.411 62.9245 103.411 63.3946V64.7212C103.411 65.1913 103.271 65.6507 103.009 66.0407L83.8682 94.4669C83.4292 95.1189 82.6946 95.5099 81.9085 95.5099H74.1387C73.2767 95.5099 72.4831 95.0404 72.068 94.2849C71.653 93.5294 71.6824 92.6078 72.1447 91.8802L89.8253 64.0579L85.5494 57.3292ZM100.584 42.2947L114.414 64.0579L96.7334 91.8802C96.271 92.6078 96.2416 93.5294 96.6567 94.2849C97.0717 95.0404 97.8653 95.5099 98.7273 95.5099H106.497C107.283 95.5099 108.018 95.1189 108.457 94.4669L127.597 66.0407C127.86 65.6507 128 65.1913 128 64.7212V63.3946C128 62.9245 127.86 62.465 127.597 62.0751L108.768 34.1107L100.584 42.2947Z",fill:"black"}),W.createElement("rect",{x:"110.479",y:"10",width:"11.8127",height:"141.697",rx:"2",transform:"rotate(45 110.479 10)",fill:"black"}));class Gl extends W.Component{render(){const{value:e,onChange:t}=this.props;return W.createElement(_a,{color:"link",tabIndex:-1,onClick:t},e?W.createElement(Ql,null):W.createElement(Wl,null))}}const ql=_t.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class _l extends W.Component{constructor(){super(...arguments),this.state={colorOpen:!1},this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.onRename=e=>{const{element:t,update:n}=this.props;n(t.id,{name:e})},this.onStereotypeVisibilityToggle=()=>{const{element:e,update:t}=this.props,n=!e.displayStereotype;t(e.id,{displayStereotype:n})}}render(){const{element:e}=this.props;return W.createElement("div",null,W.createElement("section",null,W.createElement(ql,null,W.createElement(el,{value:e.name,onChange:this.onRename,autoFocus:!0}),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(Gl,{value:e.displayStereotype,onChange:this.onStereotypeVisibilityToggle}),W.createElement(_a,{color:"link",tabIndex:-1,onClick:()=>this.props.delete(e.id)},W.createElement(Za,null)))),W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,lineColor:!0,textColor:!0,fillColor:!0}))}}const Vl=(0,wo.Ng)(null,{update:uo.update,delete:uo.delete})(_l),Yl=_t.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class Zl extends W.Component{constructor(){super(...arguments),this.state={colorOpen:!1},this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.onRename=e=>{const{element:t,update:n}=this.props;n(t.id,{name:e})},this.onStereotypeVisibilityToggle=()=>{const{element:e,update:t}=this.props,n=!e.displayStereotype;t(e.id,{displayStereotype:n})}}render(){const{element:e}=this.props;return W.createElement("div",null,W.createElement("section",null,W.createElement(Yl,null,W.createElement(el,{value:e.name,onChange:this.onRename,autoFocus:!0}),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(Gl,{value:e.displayStereotype,onChange:this.onStereotypeVisibilityToggle}),W.createElement(_a,{color:"link",tabIndex:-1,onClick:()=>this.props.delete(e.id)},W.createElement(Za,null)))),W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,lineColor:!0,textColor:!0,fillColor:!0}))}}const Xl=(0,wo.Ng)(null,{update:uo.update,delete:uo.delete})(Zl),Kl=_t(_a).attrs({block:!0})`
  ::after {
    border-top: 0.3em solid;
    border-right: 0.3em solid transparent;
    border-bottom: 0;
    border-left: 0.3em solid transparent;
    content: '';
    display: inline-block;
    height: 0;
    margin-left: 0.255em;
    vertical-align: 0.255em;
    width: 0;
  }
`,Jl=_t.div`
  background-clip: padding-box;
  background-color: ${e=>e.theme.color.background};
  border: 1px solid rgba(0, 0, 0, 0.15);
  border-radius: 0.25em;
  list-style: none;
  margin: 0.125em 0 0;
  padding: 0.5em 0;
  position: absolute;
  text-align: left;
  z-index: 1000;
`,ec=_t.div``,tc=_t(_a).attrs({block:!0,color:"link"})`
  color: ${e=>e.theme.font.color};
  padding-right: 1.5em;
  padding-left: 1.5em;
  text-align: left;

  :hover {
    text-decoration: none;
    background-color: ${e=>e.theme.color.gray};
  }
`,nc=Object.freeze({color:"primary",outline:!0,placeholder:"",size:"sm"}),oc=Object.freeze({show:!1,top:0,left:0,width:0});class sc extends W.Component{constructor(){super(...arguments),this.state=oc,this.activator=(0,W.createRef)(),this.dismiss=()=>{this.activator.current&&this.getScrollableParent(this.activator.current).removeEventListener("scroll",this.dismiss),document.removeEventListener("click",this.dismiss),this.setState({show:!1})},this.select=e=>()=>{this.props.onChange&&this.props.onChange(e)},this.show=e=>{if(!this.activator.current)return;const t=this.getScrollableParent(this.activator.current),n=t.getBoundingClientRect(),o=this.activator.current.getBoundingClientRect();this.setState({show:!0,top:o.top-n.top+o.height,left:o.left-n.left,width:o.width}),t.addEventListener("scroll",this.dismiss,{once:!0}),document.addEventListener("click",this.dismiss,{once:!0}),e.stopPropagation()},this.getScrollableParent=e=>{const t=getComputedStyle(e);if(/(auto|scroll)/.test([t.overflow,t.overflowY,t.overflowX].join("")))return e;const n=e.parentElement;return n?this.getScrollableParent(n):document.body}}componentWillUnmount(){document.removeEventListener("click",this.dismiss)}render(){const{color:e,outline:t,size:n}=this.props,{show:o,top:s,left:i,width:r}=this.state,a=W.Children.toArray(this.props.children).find((e=>e.props.value===this.props.value));return W.createElement(ec,null,W.createElement(Kl,{ref:this.activator,color:e,onClick:e=>this.show(e),outline:t,size:n},a?a.props.children:this.props.placeholder),o&&W.createElement(Jl,{style:{top:s,left:i,minWidth:r}},W.Children.map(this.props.children,(({props:e})=>this.renderItem(e)))))}renderItem(e){const{size:t}=this.props;return W.createElement(tc,{size:t,onClick:this.select(e.value)},e.children)}}sc.defaultProps=nc,sc.Item=e=>null;const ic=(0,Do.Zz)(xr,(0,wo.Ng)(null,{update:uo.update,delete:uo.delete,flip:go.flip,getById:uo.getById})),rc=_t.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class ac extends W.Component{constructor(){super(...arguments),this.state={colorOpen:!1},this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.onChange=e=>{const{element:t,update:n}=this.props;n(t.id,{type:e})},this.onUpdate=(e,t)=>n=>{const{element:o,update:s}=this.props;s(o.id,{[t]:{...o[t],[e]:n}})}}render(){const{element:e,getById:t}=this.props,n=e.source&&t(e.source.element),o=e.target&&t(e.target.element);return n&&o?W.createElement("div",null,W.createElement("section",null,W.createElement(rc,null,W.createElement(El,{gutter:!1,style:{flexGrow:1}},this.props.translate("popup.association")),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(_a,{color:"link",onClick:()=>this.props.flip(e.id)},W.createElement(Bl,null)),W.createElement(_a,{color:"link",onClick:()=>this.props.delete(e.id)},W.createElement(Za,null))),W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,lineColor:!0,textColor:!0}),W.createElement(xl,null)),W.createElement("section",null,W.createElement(sc,{value:e.type,onChange:this.onChange},W.createElement(sc.Item,{value:f.ClassAggregation},this.props.translate("packages.ClassDiagram.ClassAggregation")),W.createElement(sc.Item,{value:f.ClassUnidirectional},this.props.translate("packages.ClassDiagram.ClassUnidirectional")),W.createElement(sc.Item,{value:f.ClassBidirectional},this.props.translate("packages.ClassDiagram.ClassBidirectional")),W.createElement(sc.Item,{value:f.ClassComposition},this.props.translate("packages.ClassDiagram.ClassComposition")),W.createElement(sc.Item,{value:f.ClassDependency},this.props.translate("packages.ClassDiagram.ClassDependency")),W.createElement(sc.Item,{value:f.ClassInheritance},this.props.translate("packages.ClassDiagram.ClassInheritance")),W.createElement(sc.Item,{value:f.ClassRealization},this.props.translate("packages.ClassDiagram.ClassRealization"))),W.createElement(xl,null)),W.createElement("section",null,W.createElement(El,null,n.name),W.createElement(rc,null,W.createElement(bl,{style:{marginRight:"0.5em"}},this.props.translate("popup.multiplicity")),W.createElement(el,{style:{minWidth:0},gutter:!0,value:e.source.multiplicity,onChange:this.onUpdate("multiplicity","source"),autoFocus:!0})),W.createElement(rc,null,W.createElement(bl,{style:{marginRight:"0.5em"}},this.props.translate("popup.role")),W.createElement(el,{value:e.source.role,onChange:this.onUpdate("role","source")})),W.createElement(xl,null)),W.createElement("section",null,W.createElement(El,null,o.name),W.createElement(rc,null,W.createElement(bl,{style:{marginRight:"0.5em"}},this.props.translate("popup.multiplicity")),W.createElement(el,{style:{minWidth:0},gutter:!0,value:e.target.multiplicity,onChange:this.onUpdate("multiplicity","target")})),W.createElement(rc,null,W.createElement(bl,{style:{marginRight:"0.5em"}},this.props.translate("popup.role")),W.createElement(el,{value:e.target.role,onChange:this.onUpdate("role","target")})))):null}}const lc=ic(ac),cc=e=>W.createElement(qo,{viewBox:"0 0 448 512",...e},W.createElement("path",{d:"M136.97 380.485l7.071-7.07c4.686-4.686 4.686-12.284 0-16.971L60.113 273H436c6.627 0 12-5.373 12-12v-10c0-6.627-5.373-12-12-12H60.113l83.928-83.444c4.686-4.686 4.686-12.284 0-16.971l-7.071-7.07c-4.686-4.686-12.284-4.686-16.97 0l-116.485 116c-4.686 4.686-4.686 12.284 0 16.971l116.485 116c4.686 4.686 12.284 4.686 16.97-.001z"})),dc=_t.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class hc extends W.Component{constructor(){super(...arguments),this.state={fieldToFocus:void 0,colorOpen:!1},this.newCommunicationLinkField=(0,W.createRef)(),this.messageRefs=[],this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.create=e=>{const{element:t,update:n}=this.props;t.messages.find((t=>t.name===e))||n(t.id,{messages:[...t.messages,new Fe({id:V(),name:e,direction:"source"})]})},this.rename=e=>t=>{const{element:n,update:o}=this.props,s=[...n.messages],i=s.findIndex((t=>t.name===e.name));s[i].name=t,o(n.id,{messages:s})},this.flip=e=>()=>{const{element:t,update:n}=this.props,o=[...t.messages],s=o.findIndex((t=>t.name===e.name));o[s].direction="source"===o[s].direction?"target":"source",n(t.id,{messages:o})},this.delete=e=>()=>{const{element:t,update:n}=this.props;n(t.id,{messages:t.messages.filter((t=>t.name!==e.name))})}}componentDidMount(){this.setState({fieldToFocus:this.newCommunicationLinkField.current})}componentDidUpdate(e,t,n){this.state.fieldToFocus&&(this.state.fieldToFocus.focus(),this.setState({fieldToFocus:void 0}))}render(){const{element:e,getById:t}=this.props,n=e.source&&t(e.source.element),o=e.target&&t(e.target.element);return n&&o?W.createElement("div",null,W.createElement("section",null,W.createElement(dc,null,W.createElement(El,{gutter:!1},this.props.translate("packages.CommunicationDiagram.CommunicationLink")),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(_a,{color:"link",onClick:()=>this.props.delete(e.id)},W.createElement(Za,null))),W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,lineColor:!0,textColor:!0}),W.createElement(xl,null)),W.createElement("section",null,W.createElement(El,null,this.props.translate("popup.messages")," (",W.createElement("small",null,n.name,"  ",o.name),")"),e.messages.map(((t,n)=>W.createElement(dc,{key:t.id},W.createElement(el,{ref:e=>this.messageRefs[n]=e,gutter:!0,value:t.name,onChange:this.rename(t),onSubmitKeyUp:()=>n===e.messages.length-1?this.newCommunicationLinkField.current?.focus():this.setState({fieldToFocus:this.messageRefs[n+1]})}),W.createElement(_a,{color:"link",tabIndex:-1,onClick:this.flip(t)},"source"===t.direction?W.createElement(Fl,null):W.createElement(cc,null)),W.createElement(_a,{color:"link",tabIndex:-1,onClick:this.delete(t)},W.createElement(Za,null))))),W.createElement(el,{ref:this.newCommunicationLinkField,outline:!0,value:"",onSubmit:this.create,onSubmitKeyUp:()=>this.setState({fieldToFocus:this.newCommunicationLinkField.current}),onKeyDown:e=>{"Tab"===e.key&&e.currentTarget.value&&(e.preventDefault(),e.currentTarget.blur(),this.setState({fieldToFocus:this.newCommunicationLinkField.current}))}}))):null}}const uc=(0,Do.Zz)(xr,(0,wo.Ng)(null,{update:uo.update,delete:uo.delete,flip:go.flip,getById:uo.getById}))(hc),pc=_t.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class mc extends W.Component{constructor(){super(...arguments),this.state={colorOpen:!1},this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.onChange=e=>{const{element:t,update:n}=this.props;n(t.id,{type:e})}}render(){const{element:e}=this.props;return W.createElement("div",null,W.createElement("section",null,W.createElement(pc,null,W.createElement(El,{gutter:!1,style:{flexGrow:1}},this.props.translate("popup.association")),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(_a,{color:"link",onClick:()=>this.props.flip(e.id)},W.createElement(Bl,null)),W.createElement(_a,{color:"link",tabIndex:-1,onClick:()=>this.props.delete(e.id)},W.createElement(Za,null))),W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,lineColor:!0}),W.createElement(xl,null)),W.createElement("section",null,W.createElement(sc,{value:e.type,onChange:this.onChange},W.createElement(sc.Item,{value:E.ComponentDependency},this.props.translate("packages.ComponentDiagram.ComponentDependency")),W.createElement(sc.Item,{value:E.ComponentInterfaceProvided},this.props.translate("packages.ComponentDiagram.ComponentInterfaceProvided")),W.createElement(sc.Item,{value:E.ComponentInterfaceRequired},this.props.translate("packages.ComponentDiagram.ComponentInterfaceRequired")))))}}const gc=(0,Do.Zz)(xr,(0,wo.Ng)(null,{update:uo.update,delete:uo.delete,flip:go.flip}))(mc),yc=qt.Ay.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class fc extends W.Component{constructor(e){super(e),this.state={colorOpen:!1},this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.onChange=e=>{const{element:t,update:n}=this.props;n(t.id,{type:e})},this.rename=e=>{const{element:t,update:n}=this.props;n(t.id,{name:e})},this.onChange=this.onChange.bind(this)}render(){const{element:e}=this.props;return W.createElement("div",null,W.createElement("section",null,W.createElement(yc,null,W.createElement(El,{gutter:!1,style:{flexGrow:1}},this.props.translate("popup.association")),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(_a,{color:"link",onClick:()=>this.props.flip(e.id)},W.createElement(Bl,null)),W.createElement(_a,{color:"link",tabIndex:-1,onClick:()=>this.props.delete(e.id)},W.createElement(Za,null))),W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,lineColor:!0,textColor:e.type===v.DeploymentAssociation}),W.createElement(xl,null)),W.createElement("section",null,W.createElement(sc,{value:e.type,onChange:this.onChange},W.createElement(sc.Item,{value:v.DeploymentAssociation},this.props.translate("packages.DeploymentDiagram.DeploymentAssociation")),W.createElement(sc.Item,{value:v.DeploymentDependency},this.props.translate("packages.DeploymentDiagram.DeploymentDependency")),W.createElement(sc.Item,{value:v.DeploymentInterfaceProvided},this.props.translate("packages.DeploymentDiagram.DeploymentInterfaceProvided")),W.createElement(sc.Item,{value:v.DeploymentInterfaceRequired},this.props.translate("packages.DeploymentDiagram.DeploymentInterfaceRequired")))),e.type===v.DeploymentAssociation&&W.createElement(W.Fragment,null,W.createElement(xl,null),W.createElement("section",null,W.createElement(yc,null,W.createElement(el,{value:e.name,onChange:this.rename,autoFocus:!0}),W.createElement(_a,{color:"link",onClick:()=>this.props.delete(e.id)},W.createElement(Za,null))))))}}const Cc=(0,Do.Zz)(xr,(0,wo.Ng)(null,{update:uo.update,delete:uo.delete,flip:go.flip}))(fc),Ec=_t.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class bc extends W.Component{constructor(){super(...arguments),this.state={colorOpen:!1},this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.onRename=e=>{const{element:t,update:n}=this.props;n(t.id,{name:e})},this.onStereotypeVisibilityToggle=()=>{const{element:e,update:t}=this.props,n=!e.displayStereotype;t(e.id,{displayStereotype:n})},this.onStereotypeRename=e=>{const{element:t,update:n}=this.props;n(t.id,{stereotype:e})}}render(){const{element:e}=this.props;return W.createElement("div",null,W.createElement("section",null,W.createElement(Ec,null,W.createElement(el,{value:e.name,onChange:this.onRename,autoFocus:!0}),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(Gl,{value:e.displayStereotype,onChange:this.onStereotypeVisibilityToggle}),W.createElement(_a,{color:"link",tabIndex:-1,onClick:()=>this.props.delete(e.id)},W.createElement(Za,null))),W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,lineColor:!0,textColor:!0,fillColor:!0})),W.createElement("section",null,W.createElement(xl,null),W.createElement(Ec,null,W.createElement(el,{value:e.stereotype,onChange:this.onStereotypeRename}))))}}const vc=(0,wo.Ng)(null,{update:uo.update,delete:uo.delete})(bc),wc=qt.Ay.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class kc extends W.Component{constructor(){super(...arguments),this.state={fieldToFocus:void 0,colorOpen:!1},this.newMethodField=(0,W.createRef)(),this.newAttributeField=(0,W.createRef)(),this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.create=e=>t=>{const{element:n,create:o}=this.props,s=new e;s.name=t,o(s,n.id)},this.rename=e=>t=>{this.props.update(e,{name:t})},this.delete=e=>()=>{this.props.delete(e)}}componentDidUpdate(e,t,n){this.state.fieldToFocus&&(this.state.fieldToFocus.focus(),this.setState({fieldToFocus:void 0}))}render(){const{element:e,getById:t}=this.props,n=e.ownedElements.map((e=>t(e))).filter(po),o=n.filter((e=>e instanceof Pe)),s=n.filter((e=>e instanceof De)),i=[],r=[];return W.createElement("div",null,W.createElement("section",null,W.createElement(wc,null,W.createElement(el,{value:e.name,onChange:this.rename(e.id),autoFocus:!0}),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(_a,{color:"link",tabIndex:-1,onClick:this.delete(e.id)},W.createElement(Za,null))),W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,fillColor:!0,lineColor:!0,textColor:!0}),W.createElement(xl,null)),W.createElement("section",null,W.createElement(El,null,this.props.translate("popup.attributes")),o.map(((e,t)=>W.createElement(Dl,{id:e.id,key:e.id,value:e.name,onChange:this.props.update,onSubmitKeyUp:()=>t===o.length-1?this.newAttributeField.current?.focus():this.setState({fieldToFocus:i[t+1]}),onDelete:this.delete,onRefChange:e=>i[t]=e,element:e}))),W.createElement(el,{ref:this.newAttributeField,outline:!0,value:"",onSubmit:this.create(Pe),onSubmitKeyUp:(e,t)=>{t?this.setState({fieldToFocus:this.newAttributeField.current}):r&&r.length>0?this.setState({fieldToFocus:r[0]}):this.setState({fieldToFocus:this.newMethodField.current})},onKeyDown:e=>{"Tab"===e.key&&e.currentTarget.value&&(e.preventDefault(),e.currentTarget.blur(),this.setState({fieldToFocus:this.newAttributeField.current}))}})),W.createElement("section",null,W.createElement(xl,null),W.createElement(El,null,this.props.translate("popup.methods")),s.map(((e,t)=>W.createElement(Dl,{id:e.id,key:e.id,value:e.name,onChange:this.props.update,onSubmitKeyUp:()=>t===s.length-1?this.newMethodField.current?.focus():this.setState({fieldToFocus:r[t+1]}),onDelete:this.delete,onRefChange:e=>r[t]=e,element:e}))),W.createElement(el,{ref:this.newMethodField,outline:!0,value:"",onSubmit:this.create(De),onSubmitKeyUp:()=>this.setState({fieldToFocus:this.newMethodField.current}),onKeyDown:e=>{"Tab"===e.key&&e.currentTarget.value&&(e.preventDefault(),e.currentTarget.blur(),this.setState({fieldToFocus:this.newMethodField.current}))}})))}}const xc=(0,Do.Zz)(xr,(0,wo.Ng)(null,{create:uo.create,update:uo.update,delete:uo.delete,getById:uo.getById}))(kc),Mc=qt.Ay.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class Sc extends W.Component{constructor(){super(...arguments),this.state={colorOpen:!1},this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.rename=e=>t=>{this.props.update(e,{name:t})},this.onChange=e=>{const{element:t,update:n}=this.props;n(t.id,{type:e})}}render(){const{element:e}=this.props;return W.createElement("div",null,W.createElement("section",null,e.type===M.UseCaseAssociation?W.createElement(Mc,null,W.createElement(el,{value:e.name,placeholder:"...",onChange:this.rename(e.id),autoFocus:!0}),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(_a,{color:"link",tabIndex:-1,onClick:()=>this.props.delete(e.id)},W.createElement(Za,null))):W.createElement(Mc,null,W.createElement(El,{gutter:!1,style:{flexGrow:1}},{[M.UseCaseAssociation]:this.props.translate("packages.UseCaseDiagram.UseCaseAssociation"),[M.UseCaseGeneralization]:this.props.translate("packages.UseCaseDiagram.UseCaseGeneralization"),[M.UseCaseInclude]:this.props.translate("packages.UseCaseDiagram.UseCaseInclude"),[M.UseCaseExtend]:this.props.translate("packages.UseCaseDiagram.UseCaseExtend")}[e.type]),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(_a,{color:"link",tabIndex:-1,onClick:()=>this.props.flip(e.id)},W.createElement(Bl,null)),W.createElement(_a,{color:"link",tabIndex:-1,onClick:()=>this.props.delete(e.id)},W.createElement(Za,null)))),W.createElement("section",null,W.createElement(xl,null),W.createElement(sc,{value:e.type,onChange:this.onChange},W.createElement(sc.Item,{value:M.UseCaseAssociation},this.props.translate("packages.UseCaseDiagram.UseCaseAssociation")),W.createElement(sc.Item,{value:M.UseCaseGeneralization},this.props.translate("packages.UseCaseDiagram.UseCaseGeneralization")),W.createElement(sc.Item,{value:M.UseCaseInclude},this.props.translate("packages.UseCaseDiagram.UseCaseInclude")),W.createElement(sc.Item,{value:M.UseCaseExtend},this.props.translate("packages.UseCaseDiagram.UseCaseExtend")))),W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,lineColor:!0,textColor:e.type!==M.UseCaseGeneralization}))}}const Ic=(0,Do.Zz)(xr,(0,wo.Ng)(null,{update:uo.update,delete:uo.delete,flip:go.flip}))(Sc),Tc=e=>W.createElement(qo,{viewBox:"0 0 330 220",...e},W.createElement("g",{transform:"translate(0.912517,-1.244823)"},W.createElement("path",{style:{fill:"#000000",fillOpacity:1,stroke:"none"},d:"M 177.49050,123.22017 C 184.81453,136.25742 193.31063,146.07188 202.97884,152.66359 C 212.79308,159.10900 223.85266,162.33166 236.15762,162.33158 C 250.95230,162.33166 263.03727,157.42443 272.41258,147.60987 C 281.78729,137.64902 286.47480,124.97811 286.47511,109.59709 C 286.47480,94.802293 282.15350,82.497592 273.51121,72.682955 C 264.86833,62.868664 254.02847,57.961432 240.99161,57.961244 C 229.12610,57.961432 218.35949,62.868664 208.69174,72.682955 C 199.17001,82.351107 188.76961,99.196829 177.49050,123.22017 M 150.68381,99.709379 C 143.50589,86.818886 135.00979,77.150906 125.19547,70.705411 C 115.52734,64.260267 104.46776,61.037607 92.016692,61.037422 C 77.221638,61.037607 65.136664,65.944839 55.761733,75.759133 C 46.386643,85.427283 41.699138,97.951711 41.699203,113.33245 C 41.699138,128.12753 46.020432,140.43223 54.663098,150.24659 C 63.305607,160.06115 74.145463,164.96839 87.182697,164.96830 C 99.047834,164.96839 109.74121,160.13440 119.26284,150.46632 C 128.93068,140.79844 139.40432,123.87947 150.68381,99.709379 M 166.28443,139.91942 C 155.88383,159.84143 144.97074,174.41664 133.54510,183.64510 C 122.26563,192.87369 109.66796,197.48795 95.752051,197.48790 C 75.976520,197.48795 59.204040,189.28482 45.434563,172.87848 C 31.811432,156.47228 24.999901,136.18417 24.999949,112.01409 C 24.999901,86.379432 31.079009,65.651870 43.237293,49.831344 C 55.541927,34.011210 71.508741,26.101045 91.137784,26.100825 C 105.05370,26.101045 117.50489,30.642066 128.49138,39.723901 C 139.47757,48.659664 150.46391,63.454602 161.45043,84.108760 C 171.41120,63.894056 182.17781,49.025875 193.75030,39.504174 C 205.32237,29.836401 218.21300,25.002411 232.42226,25.002190 C 251.90445,25.002411 268.53044,33.278788 282.30030,49.831344 C 296.21602,66.384293 303.17404,86.818886 303.17436,111.13518 C 303.17404,136.62363 297.02169,157.27795 284.71729,173.09820 C 272.55877,188.77212 256.66520,196.60905 237.03653,196.60900 C 223.12024,196.60905 210.74229,192.36099 199.90266,183.86483 C 189.20907,175.22230 178.00300,160.57385 166.28443,139.91942"}))),Pc=(0,Do.Zz)(xr,(0,wo.Ng)(null,{update:uo.update,delete:uo.delete})),Dc=_t.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class Ac extends W.Component{constructor(){super(...arguments),this.state={colorOpen:!1},this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.rename=e=>t=>{this.props.update(e,{name:t})},this.changeTokenAmount=e=>t=>{this.props.update(e,{amountOfTokens:t})},this.changeCapacity=e=>t=>{this.props.update(e,{capacity:t})},this.delete=e=>()=>{this.props.delete(e)}}render(){const{element:e}=this.props;return W.createElement("div",null,W.createElement("section",null,W.createElement(Dc,null,W.createElement(el,{value:e.name,onChange:this.rename(e.id),autoFocus:!0}),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(_a,{color:"link",tabIndex:-1,onClick:this.delete(e.id)},W.createElement(Za,null))),W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,lineColor:!0,textColor:!0,fillColor:!0}),W.createElement(xl,null)),W.createElement("section",null,W.createElement(Dc,null,W.createElement(bl,{style:{marginRight:"0.5em",minWidth:"70px"}},this.props.translate("popup.tokens")),W.createElement(el,{style:{minWidth:0},value:e.amountOfTokens,type:"number",onChange:this.changeTokenAmount(e.id)}))),W.createElement("section",null,W.createElement(Dc,{style:{marginTop:"0.5em",alignItems:"center"}},W.createElement(bl,{style:{marginRight:"0.5em",minWidth:"70px"}},this.props.translate("popup.capacity")),W.createElement("div",{style:{position:"relative"}},W.createElement(el,{value:e.capacity,type:"number",onChange:this.changeCapacity(e.id)}),!isFinite(e.capacity)&&W.createElement(Tc,{style:{position:"absolute",top:"25%",left:"5%"},key:e.capacity})),W.createElement(_a,{color:"link",type:"reset",tabIndex:-1,onClick:t=>this.changeCapacity(e.id)(Number.POSITIVE_INFINITY)},W.createElement(Tc,null)))))}}const Lc=Pc(Ac),Rc=(0,Do.Zz)(xr,(0,wo.Ng)(null,{update:uo.update,delete:uo.delete,flip:go.flip})),Nc=_t.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class Bc extends W.Component{constructor(){super(...arguments),this.state={colorOpen:!1},this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.rename=e=>t=>{this.props.update(e,{name:t})},this.delete=e=>()=>{this.props.delete(e)}}render(){const{element:e}=this.props;return W.createElement("div",null,W.createElement("section",null,W.createElement(Nc,null,W.createElement(el,{value:e.name,onChange:this.rename(e.id),autoFocus:!0}),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(_a,{color:"link",onClick:()=>this.props.flip(e.id)},W.createElement(Bl,null)),W.createElement(_a,{color:"link",tabIndex:-1,onClick:this.delete(e.id)},W.createElement(Za,null))),W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,lineColor:!0,textColor:!0})))}}const Oc=Rc(Bc),$c=(0,Do.Zz)(xr,(0,wo.Ng)(null,{update:uo.update,delete:uo.delete,flip:go.flip})),Uc=_t.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class Fc extends W.Component{constructor(){super(...arguments),this.state={colorOpen:!1},this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.rename=e=>t=>{this.props.update(e,{name:t})},this.delete=e=>()=>{this.props.delete(e)}}render(){const{element:e}=this.props;return W.createElement("div",null,W.createElement("section",null,W.createElement(Uc,null,W.createElement(el,{value:e.name,onChange:this.rename(e.id),autoFocus:!0}),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(_a,{color:"link",onClick:()=>this.props.flip(e.id)},W.createElement(Bl,null)),W.createElement(_a,{color:"link",tabIndex:-1,onClick:this.delete(e.id)},W.createElement(Za,null)))),W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,lineColor:!0,textColor:!0}))}}const zc=$c(Fc),Hc=(0,Do.Zz)(xr,(0,wo.Ng)(null,{update:uo.update,delete:uo.delete})),jc=_t.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class Qc extends W.Component{constructor(){super(...arguments),this.state={colorOpen:!1},this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.rename=e=>t=>{this.props.update(e,{name:t})},this.toggleIsInitialMarking=e=>t=>{this.props.update(e,{isInitialMarking:t.currentTarget.checked})},this.delete=e=>()=>{this.props.delete(e)}}render(){const{element:e}=this.props;return W.createElement("div",null,W.createElement("section",null,W.createElement(jc,null,W.createElement(el,{value:e.name,onChange:this.rename(e.id),autoFocus:!0}),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(_a,{color:"link",tabIndex:-1,onClick:this.delete(e.id)},W.createElement(Za,null))),W.createElement(xl,null)),W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,lineColor:!0,textColor:!0,fillColor:!0}),W.createElement("section",null,W.createElement("label",{htmlFor:"toggleIsInitialMarking"},W.createElement("input",{id:"toggleIsInitialMarking",type:"checkbox",checked:e.isInitialMarking,onChange:this.toggleIsInitialMarking(e.id)}),this.props.translate("packages.ReachabilityGraph.ReachabilityGraphIsInitialMarking"))))}}const Wc=Hc(Qc),Gc=_t.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class qc extends W.Component{constructor(){super(...arguments),this.state={colorOpen:!1},this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.onUpdate=e=>{const{element:t,update:n}=this.props;n(t.id,{name:e})}}render(){const{element:e}=this.props;return W.createElement("div",null,W.createElement("section",null,W.createElement(Gc,null,W.createElement(el,{value:e.name,placeholder:this.props.translate("packages.SyntaxTree.SyntaxTreeTerminal"),onChange:this.onUpdate,autoFocus:!0}),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(_a,{color:"link",tabIndex:-1,onClick:()=>this.props.delete(e.id)},W.createElement(Za,null)))),W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,lineColor:!0,textColor:!0,fillColor:!0}))}}const _c=(0,Do.Zz)(xr,(0,wo.Ng)(null,{update:uo.update,delete:uo.delete}))(qc),Vc=_t.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class Yc extends W.Component{constructor(){super(...arguments),this.state={colorOpen:!1},this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.onUpdate=e=>{const{element:t,update:n}=this.props;n(t.id,{name:e})}}render(){const{element:e}=this.props;return W.createElement("div",null,W.createElement("section",null,W.createElement(Vc,null,W.createElement(el,{value:e.name,placeholder:this.props.translate("packages.SyntaxTree.SyntaxTreeNonterminal"),onChange:this.onUpdate,autoFocus:!0}),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(_a,{color:"link",tabIndex:-1,onClick:()=>this.props.delete(e.id)},W.createElement(Za,null)))),W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,lineColor:!0,textColor:!0,fillColor:!0}))}}const Zc=(0,Do.Zz)(xr,(0,wo.Ng)(null,{update:uo.update,delete:uo.delete}))(Yc),Xc=_t.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class Kc extends W.Component{constructor(){super(...arguments),this.state={colorOpen:!1},this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.onUpdate=e=>{const{element:t,update:n}=this.props;n(t.id,{name:e})}}render(){const{element:e}=this.props;return W.createElement("div",null,W.createElement("section",null,W.createElement(Xc,null,W.createElement(el,{value:e.name,placeholder:this.props.translate("packages.Flowchart.FlowchartDecision"),onChange:this.onUpdate,autoFocus:!0}),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(_a,{color:"link",tabIndex:-1,onClick:()=>this.props.delete(e.id)},W.createElement(Za,null)))),W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,lineColor:!0,textColor:!0,fillColor:!0}))}}const Jc=(0,Do.Zz)(xr,(0,wo.Ng)(null,{update:uo.update,delete:uo.delete})),ed=Jc((e=>W.createElement(Kc,{...e}))),td=Jc((e=>W.createElement(Kc,{...e}))),nd=Jc((e=>W.createElement(Kc,{...e}))),od=Jc((e=>W.createElement(Kc,{...e}))),sd=Jc((e=>W.createElement(Kc,{...e}))),id=qt.Ay.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class rd extends W.Component{constructor(){super(...arguments),this.state={colorOpen:!1},this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.rename=e=>{this.props.update(this.props.element.id,{name:e})}}render(){const{element:e}=this.props;return W.createElement("div",null,W.createElement("section",null,W.createElement(id,null,W.createElement(El,{gutter:!1,style:{flexGrow:1}},this.props.translate("packages.Flowchart.FlowchartFlowline")),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(_a,{color:"link",onClick:()=>this.props.flip(e.id)},W.createElement(Bl,null)),W.createElement(_a,{color:"link",onClick:()=>this.props.delete(e.id)},W.createElement(Za,null))),W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,lineColor:!0,textColor:!0}),W.createElement(xl,null)),W.createElement("section",null,W.createElement(el,{value:e.name,onChange:this.rename,autoFocus:!0})))}}const ad=(0,Do.Zz)(xr,(0,wo.Ng)(null,{update:uo.update,delete:uo.delete,flip:go.flip}))(rd),ld=_t.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class cd extends W.Component{constructor(){super(...arguments),this.state={colorOpen:!1},this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.onUpdate=e=>{const{element:t,update:n}=this.props;n(t.id,{name:e})}}render(){const{element:e}=this.props;return W.createElement("div",null,W.createElement("section",null,W.createElement(ld,null,W.createElement(el,{value:e.name,placeholder:this.props.translate("packages.SyntaxTree.SyntaxTreeNonterminal"),onChange:this.onUpdate,autoFocus:!0}),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(_a,{color:"link",tabIndex:-1,onClick:()=>this.props.delete(e.id)},W.createElement(Za,null)))),W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,lineColor:!0,textColor:!0,fillColor:!0}))}}const dd=(0,Do.Zz)(xr,(0,wo.Ng)(null,{update:uo.update,delete:uo.delete}))(cd),hd=(0,Do.Zz)(xr,(0,wo.Ng)(null,{update:uo.update,delete:uo.delete,flip:go.flip})),ud=_t.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class pd extends W.Component{constructor(){super(...arguments),this.state={colorOpen:!1},this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.rename=e=>t=>{this.props.update(e,{name:t})},this.changeFlowType=e=>t=>{this.props.update(e,{flowType:t})},this.delete=e=>()=>{this.props.delete(e)}}render(){const{element:e}=this.props;return W.createElement("div",null,W.createElement("section",null,W.createElement(ud,null,W.createElement(el,{value:e.name,onChange:this.rename(e.id),autoFocus:!0}),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(_a,{color:"link",onClick:()=>this.props.flip(e.id)},W.createElement(Bl,null)),W.createElement(_a,{color:"link",tabIndex:-1,onClick:this.delete(e.id)},W.createElement(Za,null)))),W.createElement(xl,null),W.createElement("section",null,W.createElement(sc,{value:e.flowType,onChange:this.changeFlowType(e.id)},W.createElement(sc.Item,{value:"sequence"},this.props.translate("packages.BPMN.BPMNSequenceFlow")),W.createElement(sc.Item,{value:"message"},this.props.translate("packages.BPMN.BPMNMessageFlow")),W.createElement(sc.Item,{value:"association"},this.props.translate("packages.BPMN.BPMNAssociationFlow")),W.createElement(sc.Item,{value:"data association"},this.props.translate("packages.BPMN.BPMNDataAssociationFlow")))),W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,lineColor:!0,textColor:!0}))}}const md=hd(pd),gd=(0,Do.Zz)(xr,(0,wo.Ng)(null,{update:uo.update,delete:uo.delete})),yd=_t.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class fd extends W.Component{constructor(){super(...arguments),this.state={colorOpen:!1},this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.rename=e=>t=>{this.props.update(e,{name:t})},this.changeGatewayType=e=>t=>{this.props.update(e,{gatewayType:t})},this.delete=e=>()=>{this.props.delete(e)}}render(){const{element:e}=this.props;return W.createElement("div",null,W.createElement("section",null,W.createElement(yd,null,W.createElement(el,{value:e.name,onChange:this.rename(e.id),autoFocus:!0}),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(_a,{color:"link",tabIndex:-1,onClick:this.delete(e.id)},W.createElement(Za,null))),W.createElement(xl,null)),W.createElement("section",null,W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,lineColor:!0,textColor:!0,fillColor:!0})),W.createElement("section",null,W.createElement(sc,{value:e.gatewayType,onChange:this.changeGatewayType(e.id)},W.createElement(sc.Item,{value:"exclusive"},this.props.translate("packages.BPMN.BPMNExclusiveGateway")),W.createElement(sc.Item,{value:"parallel"},this.props.translate("packages.BPMN.BPMNParallelGateway")),W.createElement(sc.Item,{value:"inclusive"},this.props.translate("packages.BPMN.BPMNInclusiveGateway")),W.createElement(sc.Item,{value:"event-based"},this.props.translate("packages.BPMN.BPMNEventBasedGateway")),W.createElement(sc.Item,{value:"complex"},this.props.translate("packages.BPMN.BPMNComplexGateway")))))}}const Cd=gd(fd),Ed=(0,Do.Zz)(xr,(0,wo.Ng)(null,{create:uo.create,update:uo.update,delete:uo.delete,getById:uo.getById})),bd=_t.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class vd extends W.Component{constructor(){super(...arguments),this.state={colorOpen:!1},this.newSwimlaneField=(0,W.createRef)(),this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.rename=(e,t)=>{this.props.update(e,{name:t})},this.delete=e=>{this.props.delete(e)},this.insertSwimlane=(e,t)=>{const n=this.props.element.ownedElements.map((e=>this.props.getById(e))).filter(po),o=n.every((e=>e.type!==U.BPMNSwimlane)),s=new ct({id:V(),name:t??this.props.translate("packages.BPMN.BPMNSwimlane"),bounds:{x:lt.HEADER_WIDTH,width:this.props.element.bounds.width-lt.HEADER_WIDTH,height:o?this.props.element.bounds.height:ct.DEFAULT_HEIGHT},ownedElements:o?this.props.element.ownedElements:[]});this.props.create(s,e);const i=new lt({...this.props.element,ownedElements:o?[s.id]:[s.id,...this.props.element.ownedElements]});this.props.update(e,i),o&&n.forEach((e=>this.props.update(e.id,{owner:s.id})))}}render(){const{element:e,getById:t}=this.props,n=[],o=e.ownedElements.map((e=>t(e))).filter(po).filter((e=>e.type===U.BPMNSwimlane));return W.createElement("div",null,W.createElement("section",null,W.createElement(bd,null,W.createElement(el,{value:e.name,onChange:t=>this.rename(e.id,t),autoFocus:!0}),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(_a,{color:"link",tabIndex:-1,onClick:()=>this.delete(e.id)},W.createElement(Za,null)))),W.createElement("section",null,W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,lineColor:!0,textColor:!0,fillColor:!0})),W.createElement("section",null,W.createElement(xl,null),W.createElement(El,null,this.props.translate("packages.BPMN.BPMNSwimlanes")),o.reverse().map(((e,t)=>W.createElement(Dl,{id:e.id,key:e.id,value:e.name,onChange:this.props.update,onSubmitKeyUp:()=>t===o.length-1?this.newSwimlaneField.current?.focus():this.setState({fieldToFocus:n[t+1]}),onDelete:e=>()=>this.delete(e),onRefChange:e=>n[t]=e,element:e}))),W.createElement(el,{ref:this.newSwimlaneField,outline:!0,value:"",onSubmit:t=>this.insertSwimlane(e.id,t),onSubmitKeyUp:()=>this.setState({fieldToFocus:this.newSwimlaneField.current}),onKeyDown:e=>{"Tab"===e.key&&e.currentTarget.value&&(e.preventDefault(),e.currentTarget.blur(),this.setState({fieldToFocus:this.newSwimlaneField.current}))}})))}}const wd=Ed(vd),kd=(0,Do.Zz)(xr,(0,wo.Ng)(null,{update:uo.update,delete:uo.delete})),xd=_t.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class Md extends W.Component{constructor(){super(...arguments),this.state={colorOpen:!1},this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.rename=e=>t=>{this.props.update(e,{name:t})},this.changeEventType=e=>t=>{this.props.update(e,{eventType:t})},this.delete=e=>()=>{this.props.delete(e)}}render(){const{element:e}=this.props;return W.createElement("div",null,W.createElement("section",null,W.createElement(xd,null,W.createElement(el,{value:e.name,onChange:this.rename(e.id),autoFocus:!0}),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(_a,{color:"link",tabIndex:-1,onClick:this.delete(e.id)},W.createElement(Za,null)))),W.createElement("section",null,W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,lineColor:!0,textColor:!0,fillColor:!0})),W.createElement("section",null,W.createElement(xl,null),W.createElement(sc,{value:e.eventType,onChange:this.changeEventType(e.id)},W.createElement(sc.Item,{value:"default"},this.props.translate("packages.BPMN.BPMNIntermediateEvent")),W.createElement(sc.Item,{value:"message-catch"},this.props.translate("packages.BPMN.BPMNMessageIntermediateCatchEvent")),W.createElement(sc.Item,{value:"message-throw"},this.props.translate("packages.BPMN.BPMNMessageIntermediateThrowEvent")),W.createElement(sc.Item,{value:"timer-catch"},this.props.translate("packages.BPMN.BPMNTimerIntermediateCatchEvent")),W.createElement(sc.Item,{value:"escalation-throw"},this.props.translate("packages.BPMN.BPMNEscalationIntermediateThrowEvent")),W.createElement(sc.Item,{value:"conditional-catch"},this.props.translate("packages.BPMN.BPMNConditionalIntermediateCatchEvent")),W.createElement(sc.Item,{value:"link-catch"},this.props.translate("packages.BPMN.BPMNLinkIntermediateCatchEvent")),W.createElement(sc.Item,{value:"link-throw"},this.props.translate("packages.BPMN.BPMNLinkIntermediateThrowEvent")),W.createElement(sc.Item,{value:"compensation-throw"},this.props.translate("packages.BPMN.BPMNCompensationIntermediateThrowEvent")),W.createElement(sc.Item,{value:"signal-catch"},this.props.translate("packages.BPMN.BPMNSignalIntermediateCatchEvent")),W.createElement(sc.Item,{value:"signal-throw"},this.props.translate("packages.BPMN.BPMNSignalIntermediateThrowEvent")))))}}const Sd=kd(Md),Id=(0,Do.Zz)(xr,(0,wo.Ng)(null,{update:uo.update,delete:uo.delete})),Td=_t.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class Pd extends W.Component{constructor(){super(...arguments),this.state={colorOpen:!1},this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.rename=e=>t=>{this.props.update(e,{name:t})},this.changeEventType=e=>t=>{this.props.update(e,{eventType:t})},this.delete=e=>()=>{this.props.delete(e)}}render(){const{element:e}=this.props;return W.createElement("div",null,W.createElement("section",null,W.createElement(Td,null,W.createElement(el,{value:e.name,onChange:this.rename(e.id),autoFocus:!0}),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(_a,{color:"link",tabIndex:-1,onClick:this.delete(e.id)},W.createElement(Za,null)))),W.createElement("section",null,W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,lineColor:!0,textColor:!0,fillColor:!0})),W.createElement("section",null,W.createElement(xl,null),W.createElement(sc,{value:e.eventType,onChange:this.changeEventType(e.id)},W.createElement(sc.Item,{value:"default"},this.props.translate("packages.BPMN.BPMNStartEvent")),W.createElement(sc.Item,{value:"message"},this.props.translate("packages.BPMN.BPMNMessageStartEvent")),W.createElement(sc.Item,{value:"timer"},this.props.translate("packages.BPMN.BPMNTimerStartEvent")),W.createElement(sc.Item,{value:"conditional"},this.props.translate("packages.BPMN.BPMNConditionalStartEvent")),W.createElement(sc.Item,{value:"signal"},this.props.translate("packages.BPMN.BPMNSignalStartEvent")))))}}const Dd=Id(Pd),Ad=(0,Do.Zz)(xr,(0,wo.Ng)(null,{update:uo.update,delete:uo.delete})),Ld=_t.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class Rd extends W.Component{constructor(){super(...arguments),this.state={colorOpen:!1},this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.rename=e=>t=>{this.props.update(e,{name:t})},this.changeEventType=e=>t=>{this.props.update(e,{eventType:t})},this.delete=e=>()=>{this.props.delete(e)}}render(){const{element:e}=this.props;return W.createElement("div",null,W.createElement("section",null,W.createElement(Ld,null,W.createElement(el,{value:e.name,onChange:this.rename(e.id),autoFocus:!0}),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(_a,{color:"link",tabIndex:-1,onClick:this.delete(e.id)},W.createElement(Za,null)))),W.createElement("section",null,W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,lineColor:!0,textColor:!0,fillColor:!0})),W.createElement("section",null,W.createElement(xl,null),W.createElement(sc,{value:e.eventType,onChange:this.changeEventType(e.id)},W.createElement(sc.Item,{value:"default"},this.props.translate("packages.BPMN.BPMNEndEvent")),W.createElement(sc.Item,{value:"message"},this.props.translate("packages.BPMN.BPMNMessageEndEvent")),W.createElement(sc.Item,{value:"escalation"},this.props.translate("packages.BPMN.BPMNEscalationEndEvent")),W.createElement(sc.Item,{value:"error"},this.props.translate("packages.BPMN.BPMNErrorEndEvent")),W.createElement(sc.Item,{value:"compensation"},this.props.translate("packages.BPMN.BPMNCompensationEndEvent")),W.createElement(sc.Item,{value:"signal"},this.props.translate("packages.BPMN.BPMNSignalEndEvent")),W.createElement(sc.Item,{value:"terminate"},this.props.translate("packages.BPMN.BPMNTerminateEndEvent")))))}}const Nd=Ad(Rd),Bd=(0,Do.Zz)(xr,(0,wo.Ng)(null,{update:uo.update,delete:uo.delete})),Od=_t.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`;class $d extends W.Component{constructor(){super(...arguments),this.state={colorOpen:!1},this.toggleColor=()=>{this.setState((e=>({colorOpen:!e.colorOpen})))},this.rename=e=>t=>{this.props.update(e,{name:t})},this.changeTaskType=e=>t=>{this.props.update(e,{taskType:t})},this.changeMarker=e=>t=>{this.props.element.marker!==t?this.props.update(e,{marker:t}):this.props.update(e,{marker:"none"})},this.delete=e=>()=>{this.props.delete(e)}}render(){const{element:e}=this.props;return W.createElement("div",null,W.createElement("section",null,W.createElement(Od,null,W.createElement(el,{value:e.name,onChange:this.rename(e.id),autoFocus:!0}),W.createElement(Ya,{onClick:this.toggleColor}),W.createElement(_a,{color:"link",tabIndex:-1,onClick:this.delete(e.id)},W.createElement(Za,null))),W.createElement("section",null,W.createElement(ml,{open:this.state.colorOpen,element:e,onColorChange:this.props.update,lineColor:!0,textColor:!0,fillColor:!0}))),W.createElement("section",null,W.createElement(xl,null),W.createElement(sc,{value:e.taskType,onChange:this.changeTaskType(e.id)},W.createElement(sc.Item,{value:"default"},this.props.translate("packages.BPMN.BPMNTask")),W.createElement(sc.Item,{value:"user"},this.props.translate("packages.BPMN.BPMNUserTask")),W.createElement(sc.Item,{value:"send"},this.props.translate("packages.BPMN.BPMNSendTask")),W.createElement(sc.Item,{value:"receive"},this.props.translate("packages.BPMN.BPMNReceiveTask")),W.createElement(sc.Item,{value:"manual"},this.props.translate("packages.BPMN.BPMNManualTask")),W.createElement(sc.Item,{value:"business-rule"},this.props.translate("packages.BPMN.BPMNBusinessRuleTask")),W.createElement(sc.Item,{value:"script"},this.props.translate("packages.BPMN.BPMNScriptTask")))),W.createElement("section",null,W.createElement(xl,null),W.createElement(Tl,{value:e.marker,onChange:this.changeMarker(e.id),color:"primary"},W.createElement(Tl.Item,{value:"parallel multi instance"},W.createElement(Ls,{stroke:"currentColor"})),W.createElement(Tl.Item,{value:"sequential multi instance"},W.createElement(Ds,{stroke:"currentColor"})),W.createElement(Tl.Item,{value:"loop"},W.createElement(As,{stroke:"currentColor"})))))}}const Ud=Bd($d),Fd={[z.Package]:fl,[z.Class]:Nl,[z.AbstractClass]:Nl,[z.Interface]:Nl,[z.Enumeration]:Nl,[z.ClassAttribute]:null,[z.ClassMethod]:null,[z.ObjectName]:xc,[z.ObjectAttribute]:null,[z.ObjectMethod]:null,[z.Activity]:fl,[z.ActivityActionNode]:fl,[z.ActivityFinalNode]:fl,[z.ActivityForkNode]:fl,[z.ActivityForkNodeHorizontal]:fl,[z.ActivityInitialNode]:fl,[z.ActivityMergeNode]:jl,[z.ActivityObjectNode]:fl,[z.UseCase]:fl,[z.UseCaseActor]:fl,[z.UseCaseSystem]:fl,[z.Component]:Xl,[z.Subsystem]:Vl,[z.ComponentInterface]:fl,[z.DeploymentNode]:vc,[z.DeploymentComponent]:Xl,[z.DeploymentArtifact]:fl,[z.DeploymentInterface]:fl,[z.PetriNetPlace]:Lc,[z.PetriNetTransition]:fl,[z.ReachabilityGraphMarking]:Wc,[z.CommunicationLinkMessage]:null,[z.SyntaxTreeTerminal]:_c,[z.SyntaxTreeNonterminal]:Zc,[z.FlowchartTerminal]:ed,[z.FlowchartProcess]:td,[z.FlowchartDecision]:nd,[z.FlowchartFunctionCall]:od,[z.FlowchartInputOutput]:sd,[z.ColorLegend]:dd,[z.BPMNTask]:Ud,[z.BPMNSubprocess]:fl,[z.BPMNTransaction]:fl,[z.BPMNCallActivity]:fl,[z.BPMNAnnotation]:fl,[z.BPMNStartEvent]:Dd,[z.BPMNIntermediateEvent]:Sd,[z.BPMNEndEvent]:Nd,[z.BPMNGateway]:Cd,[z.BPMNDataObject]:fl,[z.BPMNDataStore]:fl,[z.BPMNGroup]:fl,[z.BPMNPool]:wd,[z.BPMNSwimlane]:fl,[pt.ClassAggregation]:lc,[pt.ClassBidirectional]:lc,[pt.ClassComposition]:lc,[pt.ClassDependency]:lc,[pt.ClassInheritance]:lc,[pt.ClassRealization]:lc,[pt.ClassUnidirectional]:lc,[pt.ObjectLink]:kl,[pt.ActivityControlFlow]:Ul,[pt.UseCaseAssociation]:Ic,[pt.UseCaseExtend]:Ic,[pt.UseCaseGeneralization]:Ic,[pt.UseCaseInclude]:Ic,[pt.CommunicationLink]:uc,[pt.ComponentInterfaceProvided]:gc,[pt.ComponentInterfaceRequired]:gc,[pt.ComponentDependency]:gc,[pt.DeploymentAssociation]:Cc,[pt.DeploymentDependency]:Cc,[pt.DeploymentInterfaceProvided]:Cc,[pt.DeploymentInterfaceRequired]:Cc,[pt.PetriNetArc]:Oc,[pt.ReachabilityGraphArc]:zc,[pt.SyntaxTreeLink]:kl,[pt.FlowchartFlowline]:ad,[pt.BPMNFlow]:md},zd=e=>W.createElement(qo,{viewBox:"0 0 512 512",...e},W.createElement("path",{d:"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zM262.655 90c-54.497 0-89.255 22.957-116.549 63.758-3.536 5.286-2.353 12.415 2.715 16.258l34.699 26.31c5.205 3.947 12.621 3.008 16.665-2.122 17.864-22.658 30.113-35.797 57.303-35.797 20.429 0 45.698 13.148 45.698 32.958 0 14.976-12.363 22.667-32.534 33.976C247.128 238.528 216 254.941 216 296v4c0 6.627 5.373 12 12 12h56c6.627 0 12-5.373 12-12v-1.333c0-28.462 83.186-29.647 83.186-106.667 0-58.002-60.165-102-116.531-102zM256 338c-25.365 0-46 20.635-46 46 0 25.364 20.635 46 46 46s46-20.636 46-46c0-25.365-20.635-46-46-46z"})),Hd=e=>W.createElement(qo,{viewBox:"0 0 512 512",...e},W.createElement("path",{d:"M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"}));var jd=n(6819);const Qd=(0,Do.Zz)(xr,(0,wo.Ng)(null,{assess:ns.assess})),Wd=Object.freeze({showLinkIcon:!0});class Gd extends W.Component{constructor(){super(...arguments),this.state=Wd,this.toggle=()=>{this.setState({showLinkIcon:!this.state.showLinkIcon})},this.removeLink=()=>{const{element:e,assessment:t}=this.props;this.props.assess(e.id,{...t},"MANUAL")}}render(){const{assessment:e,readonly:t}=this.props,n=e?.dropInfo.tooltipMessage;return W.createElement("div",null,t?W.createElement(_a,{color:"link",tabIndex:-1,"data-tip":!0,"data-for":"tooltip"},W.createElement(Hd,null)):this.state.showLinkIcon?W.createElement(_a,{color:"link",tabIndex:-1,"data-tip":!0,"data-for":"tooltip",onClick:this.toggle},W.createElement(Hd,null)):W.createElement(_a,{color:"link",tabIndex:-1,"data-tip":!0,"data-for":"tooltip",onClick:this.removeLink,onMouseLeave:this.toggle},W.createElement(Za,null)),W.createElement(jd.A,{id:"tooltip",place:"right",effect:"solid"},this.state.showLinkIcon?n:e?.dropInfo.removeMessage))}}const qd=Qd(Gd),_d=_t.div`
  display: flex;
  align-items: baseline;
  justify-content: space-between;
`,Vd=_t.span`
  margin-top: 10px;
  font-size: 12px;
`,Yd=_t.div`
  color: white;
  background-color: ${e=>e.color||"grey"};
  text-align: center;
  margin: 0.4rem auto 0 auto;
  padding: 0.25em 0.4em;
  border-radius: 0.15rem;
  font-size: 12px;
  font-weight: bold;
`,Zd=(0,Do.Zz)(xr,(0,wo.Ng)(((e,t)=>({readonly:e.editor.readonly,assessment:ns.getById(e.assessments)(t.element.id),diagramType:e.diagram.type})),{assess:ns.assess,delete:ns.delete,updateEndAll:uo.updateEndAll}));class Xd extends W.Component{constructor(){super(...arguments),this.updateScore=e=>{const{element:t,assessment:n}=this.props,o=parseFloat(e)||0;this.props.assess(t.id,{...n,correctionStatus:{description:void 0,status:"NOT_VALIDATED"},score:o})},this.updateFeedback=e=>{const{element:t,assessment:n}=this.props,o=e.length?e:void 0,s=n?.dropInfo?"DROPPED":"MANUAL";this.props.assess(t.id,{score:0,...n,feedback:o},s)},this.deleteFeedback=()=>{this.props.updateEndAll(),this.props.delete(this.props.element.id)}}render(){const{element:e,assessment:t,readonly:n,diagramType:o}=this.props;return W.createElement(W.Fragment,null,W.createElement("section",null,W.createElement(El,null,this.props.translate("assessment.assessment")," ",this.props.translate(`packages.${o}.${e.type}`),e.name?W.createElement(W.Fragment,null," ",W.createElement("span",{style:{display:"inline-block"}},`"${e.name}"`)):""),t?.dropInfo?W.createElement(qd,{assessment:t,element:e,readonly:n}):null),W.createElement("section",null,W.createElement(_d,null,W.createElement("span",{style:{marginRight:"0.5em"}},this.props.translate("assessment.score"),":"),n?W.createElement("span",null,t&&t.score||"-"):W.createElement(el,{gutter:!0,type:"number",step:.5,onChange:this.updateScore,value:t?String(t.score):""}),n?null:W.createElement(_a,{color:"link",onClick:this.deleteFeedback},W.createElement(Za,null)))),W.createElement("span",{style:{display:"inline"}},this.props.translate("assessment.feedback")),t?.dropInfo&&t?.dropInfo.instruction?W.createElement("div",{style:{display:"inline"}},W.createElement(_a,{color:"link",tabIndex:-1,"data-tip":!0,"data-for":"tooltip-feedback-hint"},W.createElement(zd,null)),W.createElement(jd.A,{id:"tooltip-feedback-hint",place:"right",effect:"solid"},t.dropInfo.feedbackHint),t.dropInfo.instruction.feedback):null,n?t&&t.feedback&&W.createElement("section",null,t.feedback):W.createElement("section",null,W.createElement(el,{multiline:!0,placeholder:t?.dropInfo?this.props.translate("assessment.additionalFeedbackPlaceholder"):this.props.translate("assessment.feedbackPlaceholder"),onChange:this.updateFeedback,enterToSubmit:!1,value:t&&t.feedback?t.feedback:""}),t?.label?W.createElement(_d,null,W.createElement(Yd,{color:t?.labelColor},t?.label)):null,e?.assessmentNote?W.createElement(_d,null,W.createElement(Vd,null,e.assessmentNote)):null,t?.correctionStatus?.description?W.createElement(_d,null,W.createElement("span",null,t.correctionStatus.description)):null),W.createElement(xl,null))}}const Kd=Zd(Xd),Jd=({element:e,getChildren:t})=>({elements:t(e.id)}),eh=(0,wo.Ng)(null,{getChildren:uo.getChildren,assessNext:e=>(t,n)=>{const{elements:o}=n(),s=t(uo.getChildren(e.id)),i=s.length?s[s.length-1]:e,r=Object.keys(o).indexOf(i.id)+1,a=Object.keys(o)[r%Object.keys(o).length];t(uo.updateEnd(e.id)),t(uo.deselect(e.id)),t(uo.updateStart(a)),t(uo.select(a))}});class th extends W.Component{constructor(){super(...arguments),this.state=Jd(this.props),this.container=(0,W.createRef)(),this.setFocus=()=>{if(!this.container.current)return;const e=this.container.current.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');e&&e.focus()},this.onKey=e=>{"Enter"===e.key&&("keydown"===e.type?e.preventDefault():this.next())},this.next=()=>{const{assessNext:e,element:t}=this.props;e(t)}}componentDidMount(){this.setFocus()}componentDidUpdate(e){e.element!==this.props.element&&this.setState(Jd(this.props),this.setFocus)}render(){const{elements:e}=this.state;return W.createElement("div",{ref:this.container,id:"modeling-assessment-container"},e.map((e=>W.createElement(Kd,{key:e.id,element:e}))),W.createElement("section",null,W.createElement(_a,{block:!0,outline:!0,color:"primary",onClick:this.next,onKeyDown:this.onKey,onKeyUp:this.onKey},"Next Assessment")))}}const nh=eh(th),oh=_t.div`
  background-clip: padding-box;
  background-color: ${e=>e.theme.color.backgroundVariant};
  border: 1px solid ${e=>e.theme.color.primaryContrast}33;
  border-radius: 0.3em;
  box-sizing: border-box;
  display: block;
  filter: drop-shadow(0 2px 2px rgba(0, 0, 0, 0.2));
  font-family: ${e=>e.theme.font.family}, sans-serif;
  font-size: ${e=>e.theme.font.size}px;
  font-style: normal;
  font-weight: 400;
  left: 0;
  letter-spacing: normal;
  line-break: auto;
  line-height: 1.5;
  max-width: 276px;
  position: absolute;
  text-align: left;
  text-align: start;
  text-decoration: none;
  text-transform: none;
  text-shadow: none;
  top: 0;
  will-change: transform;
  white-space: normal;
  word-break: normal;
  word-spacing: normal;
  word-wrap: break-word;

  *,
  *:before,
  *:after {
    box-sizing: inherit;
  }

  ${e=>{let t=`${e.position.x}px`,n=`${e.position.y}px`;const o="start"===e.alignment?0:"end"===e.alignment?100:50;switch(e.placement){case"top":t+=` - ${o}%`,n+=" - 100% - 0.5em";break;case"right":t+=" + 0.5em",n+=` - ${o}%`;break;case"bottom":t+=` - ${o}%`,n+=" + 0.5em";break;case"left":t+=" - 100% - 0.5em",n+=` - ${o}%`}return Vt`
      transform: translate(calc(${t}), calc(${n}));
    `}}
`,sh=_t.div`
  color: ${e=>e.theme.font.color};
  padding: 0.5em 0.75em;

  ${e=>e.maxHeight&&Vt`
      max-height: ${e.maxHeight}px;
      overflow: auto;
    `}
`,ih=Vt`
  bottom: calc((0.5em + 1px) * -1);

  &::before {
    border-top-color: ${e=>e.theme.color.primaryContrast}33;
    border-width: 0.5em 0.5em 0;
    bottom: 0;
  }

  &::after {
    border-top-color: ${e=>e.theme.color.gray};
    border-width: 0.5em 0.5em 0;
    bottom: 1px;
  }
`,rh=Vt`
  height: 1em;
  left: calc((0.5em + 1px) * -1);
  width: 0.5em;

  &::before {
    border-right-color: ${e=>e.theme.color.primaryContrast}33;
    border-width: 0.5em 0.5em 0.5em 0;
    left: 0;
  }

  &::after {
    border-right-color: ${e=>e.theme.color.gray};
    border-width: 0.5em 0.5em 0.5em 0;
    left: 1px;
  }
`,ah=Vt`
  top: calc((0.5em + 1px) * -1);

  &::before {
    border-bottom-color: ${e=>e.theme.color.primaryContrast}33;
    border-width: 0 0.5em 0.5em 0.5em;
    top: 0;
  }

  &::after {
    border-bottom-color: ${e=>e.theme.color.gray};
    border-width: 0 0.5em 0.5em 0.5em;
    top: 1px;
  }
`,lh=Vt`
  height: 1em;
  right: calc((0.5em + 1px) * -1);
  width: 0.5em;

  &::before {
    border-left-color: ${e=>e.theme.color.primaryContrast}33;
    border-width: 0.5em 0 0.5em 0.5em;
    right: 0;
  }

  &::after {
    border-left-color: ${e=>e.theme.color.gray};
    border-width: 0.5em 0 0.5em 0.5em;
    right: 1px;
  }
`,ch=_t.div`
  display: block;
  height: 0.5em;
  position: absolute;
  width: 1em;

  &::before,
  &::after {
    content: '';
    border-color: transparent;
    border-style: solid;
    display: block;
    position: absolute;
  }

  ${e=>"top"===e.placement&&ih}
  ${e=>"right"===e.placement&&rh}
  ${e=>"bottom"===e.placement&&ah}
  ${e=>"left"===e.placement&&lh}

  ${e=>"top"===e.placement||"bottom"===e.placement?"start"===e.alignment?"left: 0.3em;":"end"===e.alignment?"right: 0.3em;":"left: 50%; transform: translate(-50%, 0);":"start"===e.alignment?"top: 0.3em;":"end"===e.alignment?"bottom: 0.3em;":"top: 50%; transform: translate(0, -50%);"}
`,dh=(0,W.forwardRef)((({children:e,placement:t="right",alignment:n="center",maxHeight:o,...s},i)=>W.createElement(oh,{ref:i,placement:t,alignment:n,...s},W.createElement(ch,{placement:t,alignment:n}),W.createElement(sh,{maxHeight:o},e)))),hh=(0,Do.Zz)(Ro,ur,(0,wo.Ng)((e=>({element:e.elements[e.updating[0]],disabled:!e.editor.enablePopups,mode:e.editor.mode})),{updateEnd:uo.updateEnd,getAbsolutePosition:uo.getAbsolutePosition})),uh=Object.freeze({position:null,placement:void 0,alignment:void 0});class ph extends W.Component{constructor(){super(...arguments),this.state=uh,this.popover=(0,W.createRef)(),this.show=()=>{this.position(this.props),document.addEventListener("pointerdown",this.onPointerDown);const{parentElement:e}=this.props.canvas.layer;e&&e.addEventListener("scroll",this.onScroll)},this.dismiss=()=>{this.setState(uh),document.removeEventListener("pointerdown",this.onPointerDown);const{parentElement:e}=this.props.canvas.layer;e&&e.removeEventListener("scroll",this.onScroll),this.props.element&&this.props.updateEnd(this.props.element.id)},this.position=({element:e,canvas:t})=>{const n=t.layer.parentElement;if(e&&n){const o=this.props.getAbsolutePosition(e.id).add(t.origin().subtract(this.props.root.getBoundingClientRect().x,this.props.root.getBoundingClientRect().y)),s=o.add(e.bounds.width/2,e.bounds.height/2),i=o,r=n.getBoundingClientRect(),a=s.x<r.width/2?"right":"left",l=s.y<r.height/2?"start":"end";if(Qt.isUMLRelationship(e)){const t=new Wo(e.path),n=t.position(t.length/2);i.x+=n.x,i.y+=n.y,"start"===l&&(i.y-=15),"end"===l&&(i.y+=15)}else"right"===a&&(i.x+=e.bounds.width),"end"===l&&(i.y+=e.bounds.height);this.setState({position:i,alignment:l,placement:a})}},this.onPointerDown=e=>{this.popover.current&&e.target instanceof HTMLElement&&this.popover.current.contains(e.target)||this.dismiss()},this.onScroll=e=>{this.dismiss()}}componentDidUpdate(e){!e.element&&this.props.element?setTimeout(this.show,0):e.element&&this.props.element&&e.element!==this.props.element&&this.position(this.props)}render(){const{element:e,disabled:t,mode:n}=this.props,{position:o,alignment:s,placement:i}=this.state;if(!e||t||!o)return null;let r;return r=n===no.Assessment?nh:Fd[e.type],r?(0,ko.createPortal)(W.createElement(dh,{ref:this.popover,position:o,placement:i,alignment:s,maxHeight:500},W.createElement(r,{element:e})),this.props.root):null}}const mh=hh(ph),gh=Vt((e=>`\n  text {\n    fill: ${e.theme.font.color};\n    font-family: ${e.theme.font.family};\n    font-size: ${e.theme.font.size}px;\n  }\n\n  marker, text {\n    fill-opacity: 1;\n  }\n\n  * {\n    overflow: visible;\n  }\n`)),yh=_t.div`
  display: flex;
  width: 100%;
  height: 100%;
  min-width: inherit;
  min-height: inherit;
  max-width: inherit;
  max-height: inherit;
  box-sizing: border-box;
  user-select: none;
  position: relative;
  touch-action: none;

  font-family: ${({theme:e})=>e.font.family}, sans-serif;
  font-size: ${({theme:e})=>e.font.size}px;
  color: ${({theme:e})=>e.font.color};
  font-weight: 400;
  line-height: 1.5;
  text-size-adjust: 100%;
  -webkit-tap-highlight-color: transparent;

  *,
  *:before,
  *:after {
    box-sizing: inherit;
  }

  svg {
    ${gh}
  }
`,fh=(0,Do.Zz)(Ro,(0,wo.Ng)((e=>({readonly:e.editor.readonly,mode:e.editor.mode,elements:e.elements,resizingInProgress:e.resizing.length>0,connectingInProgress:e.connecting.length>0,reconnectingInProgress:Object.keys(e.reconnecting).length>0,hoveringInProgress:e.hovered.length>0,zoomFactor:e.editor.zoomFactor})),{select:uo.select,changeSelectionBox:_i.setSelectionBoxActive}));class Ch extends W.Component{constructor(e){super(e),this.mouseDown=e=>{this.state.selectionStarted?this.setState((t=>({...t,selectionRectangle:{...t.selectionRectangle,endX:e.clientX,endY:e.clientY}}))):this.props.resizingInProgress||this.props.connectingInProgress||this.props.reconnectingInProgress||this.props.hoveringInProgress||(this.props.changeSelectionBox(!0),this.setState({selectionStarted:!0,selectionRectangle:{x:e.clientX,y:e.clientY,width:void 0,height:void 0}}))},this.mouseUp=()=>{this.state.selectionStarted&&(this.getElementIDsInSelectionBox(),this.setState({selectionStarted:!1,selectionRectangle:{x:void 0,y:void 0,width:void 0,height:void 0}}),this.props.changeSelectionBox(!1))},this.mouseMove=e=>{if(!this.state.selectionStarted)return;const t=this.getElementIDsInSelectionBox();this.props.select(t,!0),this.setState((t=>({selectionStarted:t.selectionStarted,selectionRectangle:{...t.selectionRectangle,width:e.clientX-(t.selectionRectangle.x??0),height:e.clientY-(t.selectionRectangle.y??0)}})))},this.isElementInSelectionBox=e=>{const t=this.props.canvas.origin(),{x:n,y:o,width:s,height:i}=this.state.selectionRectangle;if(!(n&&o&&s&&i))return!1;const r={x:(n-t.x)/this.props.zoomFactor,y:(o-t.y)/this.props.zoomFactor,height:i/this.props.zoomFactor,width:s/this.props.zoomFactor};return((e,t)=>{const n=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],o=Math.min(t.x,t.x+t.width),s=Math.max(t.x,t.x+t.width),i=Math.min(t.y,t.y+t.height),r=Math.max(t.y,t.y+t.height);return n.some((e=>o<=e.x&&e.x<=s&&i<=e.y&&e.y<=r))})(e.bounds,r)},this.getElementIDsInSelectionBox=()=>Object.entries(this.props.elements).reduce(((e,[t,n])=>null!==n.owner?e:this.isElementInSelectionBox(n)?[...e,t]:e),[]),this.state={selectionStarted:!1,selectionRectangle:{x:void 0,y:void 0,width:void 0,height:void 0}}}componentDidMount(){const{layer:e}=this.props.canvas;this.props.readonly||this.props.mode!==no.Modelling&&this.props.mode!==no.Exporting||(e.addEventListener("mousedown",this.mouseDown),e.addEventListener("mousemove",this.mouseMove),e.addEventListener("mouseup",this.mouseUp))}componentWillUnmount(){const{layer:e}=this.props.canvas;e.removeEventListener("mousedown",this.mouseDown),e.removeEventListener("mousemove",this.mouseMove),e.removeEventListener("mouseup",this.mouseUp)}render(){const{x:e=0,y:t=0,width:n=0,height:o=0}=this.state.selectionRectangle,s=Zt();return this.state.selectionStarted&&0!=n&&W.createElement("svg",{opacity:.5,pointerEvents:"none",style:{position:"fixed",left:`${Math.min(e,e+n)}px`,width:`${Math.abs(n)}px`,top:`${Math.min(t,t+o)}px`,height:`${Math.abs(o)}px`,backgroundColor:s.color.primary}})}}const Eh=fh(Ch),bh=Object.freeze({canvas:null,root:null});class vh extends W.Component{constructor(){super(...arguments),this.state=bh,this.resolveInitialized=()=>{},this.initializedPromise=new Promise((e=>{this.resolveInitialized=e})),this.setCanvas=e=>{e&&e.layer.current&&this.setState({canvas:{...e,layer:e.layer.current}})},this.setLayout=e=>{e&&this.setState({root:e})}}render(){const e=this.state.canvas?{canvas:this.state.canvas}:null,t=this.state.root?{root:this.state.root}:null;return W.createElement(Lo,{value:e},W.createElement(hr,{value:t},W.createElement(Sa,{initialState:this.props.state,patcher:this.props.patcher,ref:e=>{this.store??=e,this.resolveInitialized()}},W.createElement(kr,{locale:this.props.locale},W.createElement(Ha,{styles:this.props.styles},W.createElement(yh,{className:"apollon-editor",ref:this.setLayout},t&&W.createElement(yr,null,e&&W.createElement(W.Fragment,null,W.createElement(mh,null),W.createElement(Fa,null),W.createElement(lr,null)),W.createElement(tr,null,W.createElement(qi,{ref:this.setCanvas})),e&&W.createElement(W.Fragment,null,W.createElement(Eh,null)))))))))}get initialized(){return this.initializedPromise}}const wh=(e,t,n)=>{const o=new Set;for(const s of t){const t=e[s];if(!t)continue;const i=new Set(he.isUMLContainer(t)?t.ownedElements:[]);n.has(s)&&(o.add(s),n=new Set([...n,...i])),wh(e,i,n).forEach(o.add,o)}return o},kh=(e,t,n)=>{const o=new Set;for(const s of t){const t=e[s];if(!t)continue;const i=new Set(he.isUMLContainer(t)?t.ownedElements:[]);n.has(s)?n=new Set([...n,...i]):o.add(s),kh(e,i,n).forEach(o.add,o)}return o};class xh extends W.Component{constructor(){super(...arguments),this.state=(({model:e,options:t})=>{const n={layer:document.createElementNS("http://www.w3.org/2000/svg","svg"),origin:()=>new _},o=e.elements,s=e.relationships,i=e=>{const t=new ut[e.type],s=he.isUMLContainer(t)?Object.values(o).filter((t=>t.owner===e.id)):[];t.deserialize(e,s);const r=s.reduce(((e,t)=>[...e,...i(t)]),[]),[a,...l]=t.render(n,r,!0);return l.map((e=>{const t=s.find((t=>t.id===e.id));return t?(e.bounds.x=t.bounds.x,e.bounds.y=t.bounds.y,e):e})),[a,...l]},r=[...Object.values(o).filter((e=>!e.owner)).reduce(((e,t)=>[...e,...i(t)]),[]),...Object.values(s).map((e=>{const t=new Pn[e.type];return t.deserialize(e),t}))].reduce(((e,t)=>({...e,[t.id]:t})),{}),a=Object.values(r).filter((e=>!e.owner));let l=new Set(Object.values(r).map((e=>e.id)));t&&t.include&&(l=wh(r,new Set(a.map((e=>e.id))),new Set(t.include))),t&&t.exclude&&(l=kh(r,new Set(a.map((e=>e.id))),new Set(t.exclude)));const c=t&&t.keepOriginalSize||!1,d=ee(Object.values(r).filter((e=>c||l.has(e.id)))),h=((e=15)=>"number"==typeof e?{top:e,right:e,bottom:e,left:e}:Object.assign({top:0,right:0,bottom:0,left:0},e))(t?.margin);return d.x-=h.left,d.y-=h.top,d.width+=h.left+h.right,d.height+=h.top+h.bottom,{elements:Object.values(r).filter((e=>l.has(e.id))).map((e=>(e.bounds.x-=d.x,e.bounds.y-=d.y,e))),bounds:d}})(this.props)}render(){const{bounds:e,elements:t}=this.state,n=za(Zt(),this.props.styles||{}),o=vo.fromModel(this.props.model),s=(e,t,o)=>({x:t,y:o,width:e.bounds.width,height:e.bounds.height,className:e.name?e.name.replace(/[<>]/g,""):"",fill:e.fillColor||n.color.background}),i=(()=>{let e=0,n=0;for(const o of t)if(Qt.isUMLRelationship(o))for(const t of o.path)t.x<e&&(e=t.x+o.bounds.x-15),t.y<n&&(n=t.y+o.bounds.y-15);return{minX:Math.min(e,0),minY:Math.min(n,0)}})();return W.createElement(Sa,{initialState:o},W.createElement(qt.NP,{theme:n},W.createElement("svg",{width:e.width-i.minX+1,height:e.height-i.minY+1,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",fill:n.color.background},W.createElement("defs",null,W.createElement("style",null,gh[0]({theme:n}))),t.map(((e,n)=>{const o=Zs[e.type];switch(o){case rs:const r=t.filter((t=>t.owner===e.id));return W.createElement("svg",{key:e.id,...s(e,e.bounds.x-i.minX,e.bounds.y-i.minY)},W.createElement(o,{key:n,element:e},r.map(((t,n)=>{const o=Zs[t.type];return W.createElement("svg",{key:t.id,...s(t,0,t.bounds.y-e.bounds.y)},W.createElement(o,{key:n,element:t}))}))));case as:break;default:return W.createElement("svg",{key:e.id,...s(e,e.bounds.x-i.minX,e.bounds.y-i.minY)},W.createElement(o,{key:n,element:e}))}})))))}}var Mh=n(4949),Sh=n(7291),Ih=n(1443),Th=n(5282),Ph=n(8354),Dh=n(6978),Ah=n(1160),Lh=n(6126),Rh=n(5016),Nh=n(8452),Bh=n(9099);function Oh(e){return"replace"===e.op}class $h{constructor(){this.waitlist={},this.cleanup=new Sh.B,this.cleanup.pipe((0,Rh.$)((e=>e)),(0,Nh.Z)((e=>e.pipe((0,Dh.B)($h.SUPRESSION_WINDOW)))),(0,Bh.M)((e=>delete this.waitlist[e]))).subscribe()}signOperation(e){if(Oh(e)){const t=Math.random().toString(36).substring(2,15),n=e.path;return this.waitlist[n]=t,this.cleanup.next(n),{...e,hash:t}}return e}sign(e){return e.map((e=>this.signOperation(e)))}isVerifiedOperation(e){return!(Oh(e)&&function(e){return!Oh(e)||"hash"in e}(e)&&e.path in this.waitlist&&(this.waitlist[e.path]===e.hash&&delete this.waitlist[e.path],1))}verified(e){return e.filter((e=>this.isVerifiedOperation(e)))}}$h.SUPRESSION_WINDOW=200;const Uh={diff:function(e,t){const n=(0,Mh.UD)(e,t).filter((e=>!e.path.startsWith("/size"))),o=[];n.forEach((e=>{const t=/\/relationships\/(?<id>[\w-]+)\/path/g.exec(e.path);t?.groups?.id&&!o.includes(t.groups.id)&&o.push(t.groups.id)}));const s=n.filter((e=>{const t=/\/relationships\/(?<id>[\w-]+)\//g.exec(e.path);return!t?.groups?.id||!o.includes(t.groups.id)}));return o.forEach((e=>{const n=t.relationships[e];s.push({op:"replace",path:`/relationships/${e}/isManuallyLayouted`,value:n.isManuallyLayouted}),s.push({op:"replace",path:`/relationships/${e}/path`,value:n.path}),s.push({op:"replace",path:`/relationships/${e}/bounds`,value:n.bounds})})),s},maxFrequency:60};class Fh{constructor(e=Uh){this.subscribers={},this.discreteRouter=new Sh.B,this.continuousRouter=new Sh.B,this.verifier=new $h,this.options={diff:e.diff||Uh.diff,maxFrequency:e.maxFrequency||Uh.maxFrequency},this.continuousPatchObservable=this.continuousRouter.pipe((0,Ih.c)(1e3/this.options.maxFrequency));const t=(0,Th.h)(this.discreteRouter,this.continuousPatchObservable);this.observable=t.pipe((0,Ph.r)(t.pipe((0,Dh.B)(0))),(0,Ah.T)((e=>e.flat())),(0,Lh.p)((e=>e.length>0)))}get snapshot(){return this._snapshot}check(e){this.checkAndUpdate(e)}checkContinuous(e){this.checkAndUpdate(e,!1)}initialize(e){this._snapshot=e}patch(e,t){this.validate();const n=this.verifier.verified(e);return this._snapshot=t??this._snapshot,n&&n.length>0?(this._snapshot=n.reduce(((e,t,n)=>{try{return(0,Mh.HH)(e,t,n)}catch{return e}}),this.snapshot),{patched:!0,result:this.snapshot}):{patched:!1,result:this.snapshot}}subscribe(e){const t=this.nextKey();return this.subscribers[t]=this.observable.subscribe(e),t}subscribeToDiscreteChanges(e){const t=this.nextKey();return this.subscribers[t]=this.discreteRouter.subscribe(e),t}subscribeToContinuousChanges(e){const t=this.nextKey();return this.subscribers[t]=this.continuousPatchObservable.subscribe(e),t}unsubscribe(e){this.subscribers[e].unsubscribe(),delete this.subscribers[e]}checkAndUpdate(e,t=!0){this.validate();const n=!(0===Object.keys(this.subscribers).length)&&this.options.diff(this.snapshot,e);t&&(this._snapshot=e),n&&n.length&&(t?this.discreteRouter:this.continuousRouter).next(this.verifier.sign(n))}nextKey(){return Math.max(...Object.keys(this.subscribers).map((e=>parseInt(e,10))),0)+1}validate(){if(!this.snapshot)throw new Error("Patcher not initialized")}}class zh extends W.Component{constructor(e){super(e),this.state={hasError:!1}}componentDidCatch(e,t){this.setState({hasError:!0,error:e})}render(){return this.state.hasError&&this.state.error?(this.props.onError(this.state.error),null):this.props.children}}const Hh=/var\(--apollon-[\S]+, #[0-9a-fA-F]+\)/g,jh=/#[0-9a-fA-F]+/,Qh=e=>{const t=e.match(Hh),n=t?.map((e=>({match:e,color:e.match(jh)})));return n?.forEach((t=>{e=e.replace(t.match,t.color?t.color[0]:"")})),e};class Wh{ensureInitialized(){if(!this.store)throw console.error("The application state of Apollon could not be retrieved. The editor may already be destroyed or you might need to `await apollonEditor.nextRender`."),new Error("The application state of Apollon could not be retrieved. The editor may already be destroyed or you might need to `await apollonEditor.nextRender`.")}get model(){return this.ensureInitialized(),vo.toModel(this.store.getState())}set model(e){this.ensureInitialized();const t={...vo.fromModel(e),editor:{...this.store.getState().editor}};this.recreateEditor(t)}set type(e){this.ensureInitialized();const t={...this.store.getState(),diagram:new Wt({type:e}),elements:void 0};this.recreateEditor(t)}set locale(e){this.ensureInitialized();const t=this.store.getState();this.options.locale=e,this.recreateEditor(t)}static async exportModelAsSvg(e,t,n){const o=document.createElement("div"),s=(0,G.H)(o),i=(0,W.createElement)(xh,{model:e,options:t,styles:n}),r=new xh({model:e,options:t,styles:n});return s.render(i),await(async e=>await new Promise((e=>setTimeout(e,50))))(),{svg:Qh(o.querySelector("svg").outerHTML),clip:r.state.bounds}}static async exportModelAsJSON(e,t){return JSON.stringify(e,null,t?.space)}exportAsJSON(e){return Wh.exportModelAsJSON(this.model,e)}constructor(e,t){this.container=e,this.options=t,this.selection={elements:{},relationships:{}},this.assessments=[],this.application=null,this.patcher=new Fh,this.selectionSubscribers={},this.assessmentSubscribers={},this.modelSubscribers={},this.discreteModelSubscribers={},this.errorSubscribers={},this.componentDidMount=()=>{this.container.setAttribute("touch-action","none")},this.onDispatch=()=>{if(!this.store)return;const{elements:e,selected:t,assessments:n}=this.store.getState(),o={elements:t.filter((t=>e[t].type in z)).reduce(((e,t)=>({...e,[t]:!0})),{}),relationships:t.filter((t=>e[t].type in pt)).reduce(((e,t)=>({...e,[t]:!0})),{})};JSON.stringify(this.selection)!==JSON.stringify(o)&&(Object.values(this.selectionSubscribers).forEach((e=>e(o))),this.selection=o);const s=Object.keys(n).map((t=>({modelElementId:t,elementType:e[t].type,score:n[t].score,feedback:n[t].feedback,dropInfo:n[t].dropInfo})));JSON.stringify(this.assessments)!==JSON.stringify(s)&&(Object.values(this.assessmentSubscribers).forEach((e=>e(s))),this.assessments=s),this.notifyModelSubscribers(),this.notifyDiscreteModelSubscribers()},this.notifyDiscreteModelSubscribers=()=>{try{if(!this.store)return;if(this.model,this.store.getState().lastAction.endsWith("END")||this.store.getState().lastAction.endsWith("DELETE")){const e=vo.toModel(this.store.getState());Object.values(this.discreteModelSubscribers).forEach((t=>t(e)))}}catch(e){}},this.notifyModelSubscribers=mi((()=>{try{if(!this.store)return;const e=this.model,t=this.currentModelState?vo.toModel(this.currentModelState):null;!t&&e||t&&JSON.stringify(e)!==JSON.stringify(t)?(Object.values(this.modelSubscribers).forEach((t=>t(e))),this.currentModelState=this.store.getState()):this.currentModelState=this.store.getState()}catch(e){}}),50);let n,o=t.model?vo.fromModel(t.model):{};o={...o,diagram:new Wt({...o.diagram,type:t.type}),editor:{...o.editor,view:oo.Modelling,mode:t.mode||no.Exporting,colorEnabled:t.colorEnabled||!1,zoomFactor:t.scale||1,readonly:t.readonly||!1,enablePopups:!0===t.enablePopups||void 0===t.enablePopups,enableCopyPasteToClipboard:!0===t.copyPasteToClipboard,features:{hoverable:!0,selectable:!0,movable:!t.readonly,resizable:!t.readonly,connectable:!t.readonly,updatable:!t.readonly,droppable:!t.readonly,alternativePortVisualization:!1}}},this.nextRenderPromise=new Promise((e=>{n=e}));const s=(0,W.createElement)(vh,{ref:async e=>{null!=e&&(this.application=e,await e.initialized,this.store.subscribe(this.onDispatch),n())},state:o,patcher:this.patcher,styles:t.theme,locale:t.locale}),i=(0,W.createElement)(zh,{onError:this.onErrorOccurred.bind(this)},s);this.root=(0,G.H)(e),this.root.render(i);try{this.currentModelState=this.store?.getState()}catch(e){this.currentModelState=void 0}this.componentDidMount()}destroy(){this.root?.unmount()}select(e){if(!this.store)return;const t=this.store.dispatch;t(uo.deselect()),t(uo.select([...Object.entries(e.elements).filter((([,e])=>e)).map((([e])=>e)),...Object.entries(e.relationships).filter((([,e])=>e)).map((([e])=>e))]))}_getNewSubscriptionId(e){return 0===Object.keys(e).length?0:Math.max(...Object.keys(e).map((e=>parseInt(e))))+1}subscribeToSelectionChange(e){const t=this._getNewSubscriptionId(this.selectionSubscribers);return this.selectionSubscribers[t]=e,t}unsubscribeFromSelectionChange(e){delete this.selectionSubscribers[e]}subscribeToAssessmentChange(e){const t=this._getNewSubscriptionId(this.assessmentSubscribers);return this.assessmentSubscribers[t]=e,t}unsubscribeFromAssessmentChange(e){delete this.assessmentSubscribers[e]}subscribeToModelChange(e){const t=this._getNewSubscriptionId(this.modelSubscribers);return this.modelSubscribers[t]=e,t}unsubscribeFromModelChange(e){delete this.modelSubscribers[e]}subscribeToModelDiscreteChange(e){const t=this._getNewSubscriptionId(this.discreteModelSubscribers);return this.discreteModelSubscribers[t]=e,t}unsubscribeFromDiscreteModelChange(e){delete this.discreteModelSubscribers[e]}subscribeToModelChangePatches(e){return this.patcher.subscribeToDiscreteChanges(e)}subscribeToAllModelChangePatches(e){return this.patcher.subscribe(e)}subscribeToModelContinuousChangePatches(e){return this.patcher.subscribeToContinuousChanges(e)}unsubscribeFromModelChangePatches(e){return this.patcher.unsubscribe(e)}importPatch(e){this.store?.dispatch((e=>({type:pa.PATCH,payload:e,undoable:!1}))(e))}subscribeToApollonErrors(e){const t=this._getNewSubscriptionId(this.errorSubscribers);return this.errorSubscribers[t]=e,t}remoteSelect(e,t,n,o){this.store?.dispatch(uo.remoteSelectDeselect({name:e,color:t},n,o||[]))}pruneRemoteSelectors(e){this.store?.dispatch(uo.pruneRemoteSelectors(e))}unsubscribeToApollonErrors(e){delete this.errorSubscribers[e]}exportAsSVG(e){return Wh.exportModelAsSvg(this.model,e,this.options.theme)}getScaleFactor(){return this.options.scale||1}recreateEditor(e){let t;this.destroy(),this.nextRenderPromise=new Promise((e=>{t=e}));const n=(0,W.createElement)(vh,{ref:async e=>{null!=e&&(this.application=e,await e.initialized,this.store.subscribe(this.onDispatch),t())},state:e,patcher:this.patcher,styles:this.options.theme,locale:this.options.locale}),o=(0,W.createElement)(zh,{onError:this.onErrorOccurred.bind(this)},n);this.root=(0,G.H)(this.container),this.root.render(o),this.componentDidMount()}onErrorOccurred(e){Object.values(this.errorSubscribers).forEach((t=>t(e))),this.restoreEditor()}restoreEditor(){if(this.currentModelState){const e={...this.currentModelState,hovered:[],selected:[],moving:[],resizing:[],connecting:[],reconnecting:{},updating:[]};this.recreateEditor(e)}}get store(){return this.application?.store?.state.store}get nextRender(){return this.nextRenderPromise}}class Gh{constructor(e){this.editors=new Map,this.containers=new Map,this.options=new Map,this.activeEditorId=i.GDM,this._hasClassSelected=!1,this._hasRelationshipSelected=!1,this._hasQueryRootSelected=!1,this.selectedElementIds=[],this.selectedRelationshipIds=[],this.selectedElements=[],this.selectedRelationships=[],this.isRootPathSelectionInProgress=!1,this.lastOperationWasQueryPath=!1,this.lastRelationshipSelectedId=null,this.modelsManager=e}toggleSelectionRepeat(){this.lastOperationWasQueryPath=!this.lastOperationWasQueryPath,console.log("Selection repeat is now "+(this.lastOperationWasQueryPath?"enabled":"disabled"))}getModelsManager(){return this.modelsManager}get hasClassSelected(){return this._hasClassSelected}get hasRelationshipSelected(){return this._hasRelationshipSelected}get hasQueryRootSelected(){return this._hasQueryRootSelected}getSelectedElementIds(){return[...this.selectedElementIds]}getSelectedRelationshipIds(){return[...this.selectedRelationshipIds]}setSelectedElementIds(e){this.selectedElementIds=e}setSelectedRelationshipIds(e){this.selectedRelationshipIds=e}initialize(){this.containers.set(i.GDM,document.getElementById(i.GDM)),this.containers.set(i.LDM,document.getElementById(i.LDM));const e=this.modelsManager.getModelGDM();this.options.set(i.GDM,{model:e,colorEnabled:a.colorEnabled,scale:a.scale});const t=this.modelsManager.getModelLDM();this.options.set(i.LDM,{model:t,colorEnabled:a.colorEnabled,scale:a.scale}),this.renderAll()}renderAll(){this.render(i.GDM),this.render(i.LDM),this.highlightActiveEditor()}render(e){const t=this.containers.get(e),n=this.options.get(e);if(!t||!n)return this.logError("render",`Cannot render editor: missing container or options for ${e}`),{success:!1,error:`Missing container or options for ${e}`};const o=this.editors.get(e);o&&o.destroy();try{const o=new Wh(t,n);return this.editors.set(e,o),this.setupEditorModelDiscreteChangeSubscriptions(e,o),this.setupEditorSelectionChangeSubscriptions(),this.setupClickHandlers(e,t),{success:!0}}catch(e){return this.logError("render",`Error creating editor: ${e}`),{success:!1,error:String(e)}}}setupEditorModelDiscreteChangeSubscriptions(e,t){t.subscribeToModelDiscreteChange((t=>{this.handleModelChange(e,t)}))}setupEditorSelectionChangeSubscriptions(){this.editors.get(i.GDM).subscribeToSelectionChange((e=>{this.handleSelectionChange(e)}))}handleModelChange(e,t){e===i.GDM?(this.modelsManager.setModelGDM(t),this.modelsManager.saveGDMToLocalStorage()):(this.modelsManager.setModelLDM(t),this.modelsManager.saveLDMToLocalStorage());const n=this.options.get(e);n&&this.options.set(e,{...n,model:t})}handleSelectionChange(e){this.lastOperationWasQueryPath?this.lastOperationWasQueryPath=!1:(console.log("Selection Changed:",e),this.selectedElementIds=Object.keys(e.elements),this.selectedRelationshipIds=Object.keys(e.relationships),this.updateSelectionState(i.GDM),this.logSelectionDetails(),this.emitSelectionChangeEvent(),console.log("Is root path selection in progress: ",this.isRootPathSelectionInProgress),console.log("Selected relationships length: ",this.selectedRelationshipIds.length),console.log("Has relationship selected: ",this._hasRelationshipSelected),this.isRootPathSelectionInProgress&&1===this.selectedRelationshipIds.length&&this._hasRelationshipSelected&&this.selectedRelationshipIds[0]!==this.lastRelationshipSelectedId&&(this.lastRelationshipSelectedId=this.selectedRelationshipIds[0],this.lastOperationWasQueryPath=!0,setTimeout((()=>{window.apollon.addToQueryPath()}),0)))}logSelectionDetails(){for(const e of this.selectedElementIds)console.log(`Selected element ID: ${e} of type ${this.modelsManager.getGDMManager().getUMLTypeById(e)}`);for(const e of this.selectedRelationshipIds)console.log(`Selected relationship ID: ${e} of type ${this.modelsManager.getGDMManager().getUMLTypeById(e)}`);for(const e of this.selectedElementIds){const t=this.modelsManager.getGDMManager().getClassOutgoingAssociationsById(e);console.log(`Outgoing relationships for selected class ID: ${e}`,t)}}emitSelectionChangeEvent(){const e={hasClassSelected:this._hasClassSelected,hasRelationshipSelected:this._hasRelationshipSelected,hasQueryRootSelected:this._hasQueryRootSelected,selectedElementIds:[...this.selectedElementIds],selectedRelationshipIds:[...this.selectedRelationshipIds],onlyOneThingSelected:this.selectedElementIds.length+this.selectedRelationshipIds.length===1,activeEditorId:this.activeEditorId},t=new CustomEvent(Gh.EVENT_SELECTION_CHANGED,{detail:e,bubbles:!0});this.containers.get(i.GDM).dispatchEvent(t)}updateSelectionState(e){this._hasClassSelected=!1,this._hasRelationshipSelected=!1,this._hasQueryRootSelected=!1;const t=e===i.GDM?this.modelsManager.getGDMManager():this.modelsManager.getLDMManager();if(0===this.selectedElementIds.length&&0===this.selectedRelationshipIds.length)return;const n=[],o=[];for(const e of this.selectedElementIds){const o=this.modelsManager.getGDMManager().getClassElementById(e);o&&(n.push(o),o.type===z.Class&&(this._hasClassSelected=!0,t.isClassTaggedAs(e,d.QUERY_ROOT)&&(this._hasQueryRootSelected=!0)))}if(this._hasRelationshipSelected=1===this.selectedRelationshipIds.length,0!==this.selectedRelationshipIds.length)for(const e of this.selectedRelationshipIds){const n=t.getRelationshipById(e);n&&o.push(n)}}setupClickHandlers(e,t){t.onclick=()=>this.setActiveEditor(e)}setActiveEditor(e){return this.activeEditorId=e,this.highlightActiveEditor(),this}highlightActiveEditor(){for(const[e,t]of this.containers.entries())t.classList.toggle(Gh.CSS_CLASS_ACTIVE_EDITOR,e===this.activeEditorId)}executeEditorAction(e,t){const n=this.editors.get(e);if(!n)return{success:!1,error:`Editor with ID ${e} not found`};try{return{success:!0,data:t(n)}}catch(e){return this.logError("executeEditorAction",String(e)),{success:!1,error:String(e)}}}getActiveEditor(){return{editor:this.editors.get(this.activeEditorId),options:this.options.get(this.activeEditorId),editorId:this.activeEditorId}}getEditor(e){return this.editors.get(e)}updateOptions(e,t){const n=this.options.get(e);return n&&this.options.set(e,{...n,...t}),this}updateActiveOptions(e){return this.updateOptions(this.activeEditorId,e)}saveActiveModel(){const{editor:e,editorId:t}=this.getActiveEditor();if(!e)return{success:!1,error:"No active editor found"};const n=e.model;t===i.GDM?(this.modelsManager.setModelGDM(n),this.modelsManager.saveGDMToLocalStorage()):(this.modelsManager.setModelLDM(n),this.modelsManager.saveLDMToLocalStorage());const o=this.options.get(t);if(!o)return{success:!1,error:"Could not find options for active editor"};const s={...o,model:n};return this.options.set(t,s),{success:!0,data:s}}clearActiveModel(){if(this.activeEditorId===i.GDM){this.modelsManager.clearGDMFromLocalStorage();const e=this.modelsManager.getModelGDM();this.updateOptions(this.activeEditorId,{model:e})}else{this.modelsManager.clearLDMFromLocalStorage();const e=this.modelsManager.getModelLDM();this.updateOptions(this.activeEditorId,{model:e})}return this.render(this.activeEditorId),this}clearInactiveModel(){const e=this.activeEditorId===i.GDM?i.LDM:i.GDM;if(e===i.GDM){this.modelsManager.clearGDMFromLocalStorage();const t=this.modelsManager.getModelGDM();this.updateOptions(e,{model:t})}else{this.modelsManager.clearLDMFromLocalStorage();const t=this.modelsManager.getModelLDM();this.updateOptions(e,{model:t})}return this.render(e),this}getSelection(e){const t=this.editors.get(i.GDM);return t?.selection}getActiveEditorId(){return this.activeEditorId}getEditorIds(){return Array.from(this.editors.keys())}getIsRootPathSelectionInProgress(){return this.isRootPathSelectionInProgress}setIsRootPathSelectionInProgress(e){return this.isRootPathSelectionInProgress=e,this}logError(e,t){console.error(`[EditorManager.${e}] ${t}`)}}Gh.CSS_CLASS_ACTIVE_EDITOR="active-editor",Gh.EVENT_SELECTION_CHANGED="apollon:selection-changed";const qh=class{constructor(e,t){if(this.localStorageKey=e,t)this.model=t;else{const t=function(e){try{const t=window.localStorage.getItem(e);if(null===t||"undefined"===t||"null"===t)return console.log(`No valid model found in localStorage for key: ${e}`),null;const n=JSON.parse(t);return console.log(`Retrieved model from localStorage with key: ${e}`),n}catch(e){return console.error(`Failed to retrieve model from localStorage: ${e}`),null}}(e);this.model=t||this.getEmptyModel()}}getModel(){return this.model}setModel(e){this.model=e}updateModel(e){e(this.model),this.saveToStorage()}saveToStorage(){!function(e,t){try{const n=null==t?"null":JSON.stringify(t);window.localStorage.setItem(e,n),console.log(`Added model to localStorage with key: ${e}`)}catch(e){console.error(`Failed to store model in localStorage: ${e}`)}}(this.localStorageKey,this.model)}clearStorage(){var e;e=this.localStorageKey,window.localStorage.getItem(e)?(window.localStorage.setItem(e,"null"),console.log(`Removed model from localStorage with key: ${e}`)):console.log(`Key ${e} not found in localStorage`),this.model=this.getEmptyModel()}getEmptyModel(){return{version:"3.0.0",type:"ClassDiagram",size:{width:0,height:0},elements:{},interactive:{elements:{},relationships:{}},relationships:{},assessments:{}}}};function _h(e,t){return yo(e)?function(e,t){return e.elements.find((e=>e.id===t))}(e,t):e.elements[t]}function Vh(e,t){if(yo(e))return function(e,t){const n=e.elements.findIndex((e=>e.id===t.id));n>=0?e.elements[n]=t:e.elements.push(t)}(e,t);e.elements[t.id]=t}function Yh(e,t){return yo(e)?function(e,t){const n=e.relationships.find((e=>e.id===t));return n&&Co(n)}(e,t):e.relationships[t]}const Zh=class{constructor(e){this.getRelationshipEndInfo=(e,t)=>{const n=this.getRelationshipById(e),o="source"===t?"target":"source",s=this.getRelationshipEndRoleById(e,t),i=this.getRelationshipEndClass(e,o),r=this.getRelationshipEndClass(e,t),a=this.getRelationshipEndMultiplicity(e,t);return{relationshipType:n.type,relationshipId:e,sourceClassId:i.id,targetClassId:r.id,endType:t,roleName:s,multiplicity:a}},this.repository=e}getClassElementById(e){const t=_h(this.repository.getModel(),e);if(t)return t;console.error(`Element with id ${e} not found in model`)}getClassElementByName(e){const t=this.repository.getModel(),n=Object.values(t.elements).find((t=>t.name===e));if(n)return n;console.error(`Element with name ${e} not found in model`)}getClassElement(e){return"id"in e?this.getClassElementById(e.id):this.getClassElementByName(e.name)}getClassProperty(e,t){const n=this.repository.getModel(),o=this.getClassElement(e);if(!o){const t="id"in e?`id ${e.id}`:`name ${e.name}`;return void console.error(`Class element with ${t} not found in model`)}const s=o[t];if(!s||0===s.length){const n="id"in e?`id ${e.id}`:`name ${e.name}`;return void console.error(`No ${t} found for class element with ${n}`)}const i=[];for(const e of s){const t=_h(n,e);t&&i.push(t)}return i}getClassAttributesById(e){return this.getClassProperty({id:e},"attributes")}getClassMethodsById(e){return this.getClassProperty({id:e},"methods")}getClassAttributesByName(e){return this.getClassProperty({name:e},"attributes")}getClassMethodsByName(e){return this.getClassProperty({name:e},"methods")}getRelationshipById(e){const t=Yh(this.repository.getModel(),e);if(t)return t;console.error(`Relationship with id ${e} not found in model`)}getRelationshipByName(e){const t=this.repository.getModel(),n=Object.values(t.relationships).find((t=>t.name===e));if(n)return n;console.error(`Relationship with name ${e} not found in model`)}getRelationship(e){return"id"in e?this.getRelationshipById(e.id):this.getRelationshipByName(e.name)}getClassRelationshipsById(e){if(!this.getClassElementById(e))return void console.error(`Class element with id ${e} not found in model`);const t=this.repository.getModel(),n=Object.values(t.relationships),o=[];for(const t of n)t.source.element!==e&&t.target.element!==e||o.push(t);return o}isClassDirectlyReachableFrom(e,t,n){const o=this.getRelationshipById(n);if(!o)return console.error(`Cannot check reachability: Relationship with id ${n} not found in model`),!1;const s=o.source.element===e,i=o.target.element===e,r=o.target.element===t,a=o.source.element===t;return!!(s&&r||i&&a)&&("ClassBidirectional"===o.type||"ClassAggregation"===o.type||"ClassComposition"===o.type||("ClassUnidirectional"===o.type?s&&r:(console.warn(`Unsupported relationship type: ${o.type}`),!1)))}getClassOutgoingAssociationsById(e){const t=this.getClassRelationshipsById(e);if(!t)return;const n=[];for(const o of t){const t=o.source.element,s=o.target.element;let i;if(t===e)i=s;else{if(s!==e)continue;i=t}this.isClassDirectlyReachableFrom(e,i,o.id)&&n.push(o)}return n}getRelationshipEndClass(e,t){const n=this.getRelationshipById(e);if(n)return this.getClassElementById(n[t].element);console.error(`Relationship with id ${e} not found in model`)}getRelationshipRoleNameClass(e,t){const n=this.getRelationshipById(e);if(!n)return void console.error(`Relationship with id ${e} not found in model`);let o;if(n.source.role===t)o=n.source.element;else{if(n.target.role!==t)return void console.error(`Role name ${t} not found in relationship ${e}`);o=n.target.element}return this.getClassElementById(o)}getRelationshipOppositeEnd(e,t){const n=this.getRelationshipById(e);if(n){if(n.source.element===t||n.target.element===t)return n.source.element===t?"target":"source";console.error(`Class with id ${t} is not part of relationship ${e}`)}else console.error(`Relationship with id ${e} not found in model`)}getRelationshipOppositeEndClass(e,t){const n=this.getRelationshipById(e);if(!n)return void console.error(`Relationship with id ${e} not found in model`);const o=this.getRelationshipOppositeEnd(e,t);if(!o)return void console.error(`Cannot determine opposite end for relationship with id ${e}`);const s=n[o].element;if(this.isClassDirectlyReachableFrom(t,s,e))return this.getClassElementById(s);console.warn(`Class ${t} cannot traverse to ${s} through relationship ${e}`)}getRelationshipEndClassRoleName(e,t){const n=this.getRelationshipById(e);if(n)return n.source.element===t?n.source.role:n.target.element===t?n.target.role:void console.error(`Class with id ${t} is not part of relationship ${e}`);console.error(`Relationship with id ${e} not found in model`)}getRelationsipIsSourceOrTarget(e,t){const n=this.getRelationshipById(e);if(n)return n.source.element===t?"source":n.target.element===t?"target":void console.error(`Class with id ${t} is not part of relationship ${e}`);console.error(`Relationship with id ${e} not found in model`)}getReachableClasses(e){if(!this.getClassElementById(e))return console.error(`Source class with id ${e} not found in model`),[];const t=this.repository.getModel(),n=Object.values(t.relationships),o=[],s=new Set;for(const t of n)if(this.isAssociationAggregationOrComposition(t)){let n;const i=t.source.element===e,r=t.target.element===e,a=this.isBidirectionalRelationship(t);i?n=this.getClassElementById(t.target.element):r&&a&&(n=this.getClassElementById(t.source.element)),n&&!s.has(n.id)&&(o.push(n),s.add(n.id))}return o}getClassParent(e){const t=this.getClassParentRelationship(e);if(t)return this.getClassElementById(t.target.element);console.error(`Class with id ${e} has no inheritance relationships`)}getClassParentRelationship(e){const t=this.getClassRelationshipsById(e);if(!t)return void console.error(`Class element with id ${e} not found in model`);const n=t.filter((t=>{const n="ClassInheritance"===t.type,o=this.getRelationshipOppositeEnd(t.id,e);return n&&"target"===o}));if(n.length>1)throw new Error(`Class ${e} has multiple inheritance relationships, which is not supported`);if(0!==n.length)return n[0];console.error(`Class with id ${e} has no inheritance relationships`)}isAssociationAggregationOrComposition(e){return"ClassBidirectional"===e.type||"ClassUnidirectional"===e.type||"ClassComposition"===e.type||"ClassAggregation"===e.type}isBidirectionalRelationship(e){return"ClassBidirectional"===e.type}isClassTaggedAs(e,t){const n=this.getClassAttributesById(e);if(!n)return console.error(`Cannot check ${t} tag: No attributes found for class with id ${e}`),!1;for(const e of n)if(e.name===t)return!0;return!1}getRelationshipEndRoleById(e,t){const n=this.getRelationshipById(e);if(n)return n[t].role;console.error(`Cannot check ${t}: Relationship with id ${e} not found in model`)}hasRelationshipEndTag(e,t,n){const o=this.getRelationshipEndRoleById(e,t);return o?o.includes(n):(console.error(`Cannot check ${n} tag: Role text not found for relationship with id ${e}`),!1)}hasRelationshipTag(e,t){return this.hasRelationshipEndTag(e,"source",t)||this.hasRelationshipEndTag(e,"target",t)}hasRelationshipSourceTag(e,t){return this.hasRelationshipEndTag(e,"source",t)}hasRelationshipTargetTag(e,t){return this.hasRelationshipEndTag(e,"target",t)}getUMLTypeById(e){const t=this.repository.getModel(),n=_h(t,e);if(n)return n.type;const o=Yh(t,e);if(o)return o.type;console.error(`No element or relationship found with id ${e}`)}getAllClasses(){const e=this.repository.getModel();return Object.values(e.elements).filter((e=>"Class"===e.type))}getAllRelationships(){const e=this.repository.getModel();return Object.values(e.relationships)}getAllClassesTaggedAs(e){return this.getAllClasses().filter((t=>this.isClassTaggedAs(t.id,e)))}getAllRelationshipsTaggedAs(e){return this.getAllRelationships().filter((t=>this.hasRelationshipTag(t.id,e)))}getRelationshipEndMultiplicity(e,t){const n=this.getRelationshipById(e);if(!n)return void console.error(`Cannot check ${t} multiplicity: Relationship with id ${e} not found in model`);const o="source"===t?n.source.element:n.target.element,s=this.getClassElementById(o)?.name,i="source"===t?n.source.multiplicity:n.target.multiplicity,r=this.getMultiplicityFromString(i);if(s)return{relationshipId:n.id,end:t,targetClassId:o,targetClassName:s,lower:r.lower,upper:r.upper};console.error(`Cannot check ${t} multiplicity: Class with id ${o} not found in model`)}getMultiplicityFromString(e){if(Number(e),!isNaN(Number(e)))return{lower:Number(e),upper:Number(e)};if(""===e)return{lower:0,upper:1};if("*"===e)return{lower:0,upper:Number.POSITIVE_INFINITY};if(!e.includes(".."))return{lower:0,upper:1};const[t,n]=e.split("..").map(Number);return{lower:isNaN(t)?0:t,upper:isNaN(n)?1:n}}getClassOutgoingAssociationsWithLowerMultiplicityNotZero(e){const t=this.getClassOutgoingAssociationsById(e);return t?t.filter((t=>{const n=this.getRelationshipOppositeEnd(t.id,e);return 0!==this.getRelationshipEndMultiplicity(t.id,n).lower})):[]}},Xh=class{constructor(e,t){this.tagColorMap={[d.INSTANTIABLE]:h.INSTANTIABLE,[d.MODIFIABLE]:h.MODIFIABLE,[d.REQUIRED]:h.REQUIRED,[d.QUERIED]:h.QUERIED,[d.QUERY_ROOT]:h.QUERY_ROOT,[d.PENDING]:h.PENDING},this.modelRepositoryService=e,this.modelQueryService=t}addOrUpdateElement(e){this.modelRepositoryService.updateModel((t=>{Vh(t,e)}))}addOrUpdateRelationship(e){this.modelRepositoryService.updateModel((t=>{!function(e,t){if(yo(e))return function(e,t){const n=function(e){return fo(e)?{...e,messages:Object.values(e.messages)}:e}(t),o=e.relationships.findIndex((e=>e.id===t.id));o>=0?e.relationships[o]=n:e.relationships.push(n)}(e,t);e.relationships[t.id]=t}(t,e)}))}appendToRelationshipEndRole(e,t,n){this.modelQueryService.getRelationshipById(e)?this.modelRepositoryService.updateModel((o=>{const s=Yh(o,e);s&&("source"===t?s.source.role+=n:s.target.role+=n)})):console.error(`Cannot append to relationship: Relationship with id ${e} not found in model`)}changeRelationshipStrokeColor(e,t){this.modelQueryService.getRelationshipById(e)?this.modelRepositoryService.updateModel((n=>{const o=Yh(n,e);o&&(o.strokeColor=t)})):console.error(`Cannot highlight relationship: Relationship with id ${e} not found in model`)}resetRelationshipStrokeColor(e){this.modelQueryService.getRelationshipById(e)?this.modelRepositoryService.updateModel((t=>{const n=Yh(t,e);n&&(n.strokeColor=u.STROKE)})):console.error(`Cannot reset color: Relationship with id ${e} not found in model`)}getTagColor(e){return this.tagColorMap[e]||h.DEFAULT}addTagToClass(e,t){if(this.modelQueryService.isClassTaggedAs(e,t))return void console.log(`Cannot add attribute: Class with id ${e} already tagged with ${t}`);if(!this.modelQueryService.getClassElementById(e))return void console.error(`Cannot add attribute: Class with id ${e} not found in model`);const n=`${e}_attr_${Date.now()}`,o=this.getTagColor(t),s={id:n,name:t,type:"ClassAttribute",owner:e,bounds:{x:0,y:0,width:159,height:30},fillColor:o,strokeColor:u.STROKE,textColor:u.TEXT};this.modelRepositoryService.updateModel((t=>{Vh(t,s);const o=_h(t,e);o&&(o.attributes||(o.attributes=[]),o.attributes.push(n),Vh(t,o))}))}tagClass(e,t){this.addTagToClass(e,t)}tagRelationshipEnd(e,t,n){if(this.modelQueryService.hasRelationshipEndTag(e,t,n))return void console.error(`Cannot tag relationship: Relationship end ${t} with id ${e} already tagged with ${n}`);const o=this.modelQueryService.getRelationshipById(e);if(!o)return void console.error(`Cannot tag relationship: Relationship with id ${e} not found in model`);const s="source"===t?o.source.element:o.target.element;this.modelQueryService.getClassElementById(s)?this.appendToRelationshipEndRole(e,t,n):console.error(`Cannot tag relationship: Class with id ${s} not found in model`)}removeClassTag(e,t){this.modelQueryService.getClassElementById(e)?this.modelQueryService.isClassTaggedAs(e,t)?this.modelRepositoryService.updateModel((n=>{const o=_h(n,e);if(o&&o.attributes)for(const e of o.attributes){const s=_h(n,e);if(s&&s.name===t){o.attributes=o.attributes.filter((e=>e!==s.id)),Vh(n,o),delete n.elements[s.id];break}}})):console.log(`Class with id ${e} is not tagged with ${t}`):console.error(`Cannot remove tag: Class with id ${e} not found in model`)}},Kh=class{constructor(e,t){this.modelRepositoryService=new qh(e,t),this.modelQueryService=new Zh(this.modelRepositoryService),this.modelUpdateService=new Xh(this.modelRepositoryService,this.modelQueryService)}getModel(){return this.modelRepositoryService.getModel()}setModel(e){this.modelRepositoryService.setModel(e)}saveToLocalStorage(){this.modelRepositoryService.saveToStorage()}clearFromLocalStorage(){this.modelRepositoryService.clearStorage()}getClassElementById(e){return this.modelQueryService.getClassElementById(e)}getClassElementByName(e){return this.modelQueryService.getClassElementByName(e)}getRelationshipById(e){return this.modelQueryService.getRelationshipById(e)}getRelationshipByName(e){return this.modelQueryService.getRelationshipByName(e)}getClassAttributesById(e){return this.modelQueryService.getClassAttributesById(e)}getClassMethodsById(e){return this.modelQueryService.getClassMethodsById(e)}getClassAttributesByName(e){return this.modelQueryService.getClassAttributesByName(e)}getClassMethodsByName(e){return this.modelQueryService.getClassMethodsByName(e)}getClassRelationshipsById(e){return this.modelQueryService.getClassRelationshipsById(e)}isClassDirectlyReachableFrom(e,t,n){return this.modelQueryService.isClassDirectlyReachableFrom(e,t,n)}getClassOutgoingAssociationsById(e){return this.modelQueryService.getClassOutgoingAssociationsById(e)}getRelationshipOppositeEndClass(e,t){return this.modelQueryService.getRelationshipOppositeEndClass(e,t)}getRelationshipEndClassRoleName(e,t){return this.modelQueryService.getRelationshipEndClassRoleName(e,t)}getRelationsipIsSourceOrTarget(e,t){return this.modelQueryService.getRelationsipIsSourceOrTarget(e,t)}getReachableClasses(e){return this.modelQueryService.getReachableClasses(e)}isClassTaggedAs(e,t){return this.modelQueryService.isClassTaggedAs(e,t)}getRelationshipEndRoleById(e,t){return this.modelQueryService.getRelationshipEndRoleById(e,t)}hasRelationshipEndTag(e,t,n){return this.modelQueryService.hasRelationshipEndTag(e,t,n)}hasRelationshipTag(e,t){return this.modelQueryService.hasRelationshipTag(e,t)}hasRelationshipSourceTag(e,t){return this.modelQueryService.hasRelationshipSourceTag(e,t)}hasRelationshipTargetTag(e,t){return this.modelQueryService.hasRelationshipTargetTag(e,t)}getUMLTypeById(e){return this.modelQueryService.getUMLTypeById(e)}getAllClasses(){return this.modelQueryService.getAllClasses()}getAllRelationships(){return this.modelQueryService.getAllRelationships()}getAllClassesTaggedAs(e){return this.modelQueryService.getAllClassesTaggedAs(e)}getAllRelationshipsTaggedAs(e){return this.modelQueryService.getAllRelationshipsTaggedAs(e)}getRelationshipEndMultiplicity(e,t){return this.modelQueryService.getRelationshipEndMultiplicity(e,t)}getClassOutgoingAssociationsWithLowerMultiplicityNotZero(e){return this.modelQueryService.getClassOutgoingAssociationsWithLowerMultiplicityNotZero(e)}getClassParent(e){return this.modelQueryService.getClassParent(e)}getClassParentRelationship(e){return this.modelQueryService.getClassParentRelationship(e)}getRelationshipEndClass(e,t){return this.modelQueryService.getRelationshipEndClass(e,t)}getRelationshipRoleNameClass(e,t){return this.modelQueryService.getRelationshipRoleNameClass(e,t)}getAssociationEndInfo(e,t){return this.modelQueryService.getRelationshipEndInfo(e,t)}addOrUpdateElement(e){this.modelUpdateService.addOrUpdateElement(e)}addOrUpdateRelationship(e){this.modelUpdateService.addOrUpdateRelationship(e)}appendToRelationshipEndRole(e,t,n){this.modelUpdateService.appendToRelationshipEndRole(e,t,n)}changeRelationshipStrokeColor(e,t){this.modelUpdateService.changeRelationshipStrokeColor(e,t)}resetRelationshipStrokeColor(e){this.modelUpdateService.resetRelationshipStrokeColor(e)}addTagToClass(e,t){this.modelUpdateService.addTagToClass(e,t)}tagRelationshipEnd(e,t,n){this.modelUpdateService.tagRelationshipEnd(e,t,n)}removeClassTag(e,t){this.modelUpdateService.removeClassTag(e,t)}},Jh=class{constructor(e,t){this.gdmManager=new Kh(e),this.ldmManager=new Kh(t)}getModelGDM(){return this.gdmManager.getModel()}getModelLDM(){return this.ldmManager.getModel()}setModelGDM(e){this.gdmManager.setModel(e)}setModelLDM(e){this.ldmManager.setModel(e)}saveGDMToLocalStorage(){this.gdmManager.saveToLocalStorage()}saveLDMToLocalStorage(){this.ldmManager.saveToLocalStorage()}saveModelsToLocalStorage(){this.saveGDMToLocalStorage(),this.saveLDMToLocalStorage()}clearGDMFromLocalStorage(){this.gdmManager.clearFromLocalStorage()}clearLDMFromLocalStorage(){this.ldmManager.clearFromLocalStorage()}clearModelsFromLocalStorage(){this.clearGDMFromLocalStorage(),this.clearLDMFromLocalStorage()}getGDMManager(){return this.gdmManager}getLDMManager(){return this.ldmManager}copyClassifierFromGDMToLDMById(e){const t=this.gdmManager.getClassElementById(e);if(!t)return void console.error(`GDM element with id ${e} not found`);const n=this.gdmManager.getClassAttributesById(e);if(n)for(const e of n)this.ldmManager.addOrUpdateElement(e);const o=this.gdmManager.getClassMethodsById(e);if(o)for(const e of o)this.ldmManager.addOrUpdateElement(e);this.ldmManager.addOrUpdateElement(t),this.saveModelsToLocalStorage()}copyClassifierFromGDMToLDMByName(e){const t=this.gdmManager.getClassElementByName(e);t?this.copyClassifierFromGDMToLDMById(t.id):console.error(`GDM element with name ${e} not found`)}copyRelationshipFromGDMToLDMById(e){const t=this.gdmManager.getRelationshipById(e);if(!t)return void console.error(`GDM relationship with id ${e} not found`);const n=JSON.parse(JSON.stringify(t));n.id="ldm"+n.id,n.strokeColor=u.STROKE,this.ldmManager.addOrUpdateRelationship(n),this.saveModelsToLocalStorage()}copyRelationshipFromGDMToLDMByName(e){const t=this.gdmManager.getRelationshipByName(e);if(!t)return void console.error(`GDM relationship with name ${e} not found`);const n=JSON.parse(JSON.stringify(t));n.id="ldm"+n.id,n.strokeColor=u.STROKE,this.ldmManager.addOrUpdateRelationship(n),this.saveModelsToLocalStorage()}updateLDMRelationship(e,t){const n=this.ldmManager.getRelationshipById("ldm"+e.relationshipId);if(!n)return void console.error(`LDM relationship with id ${e.relationshipId} not found`);let o,s=!1;for(const n of t)if(n.relationshipId===e.relationshipId&&n!==e&&n.sourceClassId!==e.sourceClassId){s=!0,o=n;break}if(s&&o){n.type="ClassBidirectional";const e="source"==(o.sourceClassId===n.source.element?"source":"target")?"target":"source",t=o.multiplicity.lower,s=o.multiplicity.upper,i=t===s,r=0===t&&s===Number.POSITIVE_INFINITY;switch(n[e].role=o.roleName,!0){case i:n[e].multiplicity=t.toString();break;case r:n[e].multiplicity="*";break;default:n[e].multiplicity=t+".."+s}}else{if(n.type="ClassUnidirectional",n.source.element!==e.sourceClassId){const e=n.source,t=n.target;n.source=t,n.target=e}n.source.multiplicity="",n.source.role=""}this.ldmManager.addOrUpdateRelationship(n),this.saveModelsToLocalStorage()}tagClass(e,t){this.gdmManager.addTagToClass(e,t)}removeClassTag(e,t){this.gdmManager.removeClassTag(e,t)}removeClassTagPending(e){this.removeClassTag(e,d.PENDING)}tagRelationshipEnd(e,t,n){this.gdmManager.tagRelationshipEnd(e,t,n)}changeRelationshipStrokeColor(e,t){this.gdmManager.changeRelationshipStrokeColor(e,t)}resetRelationshipStrokeColor(e){this.gdmManager.resetRelationshipStrokeColor(e)}tagClassAsInstantiable(e){this.tagClass(e,d.INSTANTIABLE)}tagClassAsModifiable(e){this.tagClass(e,d.MODIFIABLE)}tagClassAsRequired(e){this.tagClass(e,d.REQUIRED)}tagClassAsQueried(e){this.tagClass(e,d.QUERIED)}tagClassAsQueryRoot(e){this.tagClass(e,d.QUERY_ROOT)}tagClassAsPending(e){this.tagClass(e,d.PENDING)}tagRelationshipEndAsModifiable(e,t){this.tagRelationshipEnd(e,t,d.MODIFIABLE)}tagRelationshipEndAsQueried(e,t){this.tagRelationshipEnd(e,t,d.QUERIED)}},eu=class{constructor(){this.queryShapes={},this.queryShapes={}}addNewQueryShape(e){this.queryShapes[e.id]||(this.queryShapes[e.id]={rootClass:e,queryPaths:[]})}getQueryShape(e){return this.queryShapes[e]}removeQueryShape(e){delete this.queryShapes[e]}addQueryPath(e,t){let n=this.queryShapes[e];if(!n)throw new Error(`Query shape with root class ID ${e} does not exist.`);n.queryPaths.push(t)}getQueryPaths(e){const t=this.queryShapes[e];return t?t.queryPaths:[]}toString(){let e="{\n";for(const t in this.queryShapes)e+=`    "${t}::${this.queryShapes[t].rootClass.name}": ${this.toStringQueryPath(t)},\n`;return e+="}",e}toStringQueryPath(e){const t=this.queryShapes[e];if(!t)return"";let n=`"Root::${t.rootClass.name}": [\n`;return n+=t.queryPaths.map((e=>`    [${e.map((e=>`"${e.roleName}::${e.targetClassName}"`)).join(", ")}]`)).join("\n"),n+="\n]",n}resetQueryShapes(){this.queryShapes={}}},tu=class{constructor(e,t,n){this.queryRootId=e,this.queryRootClass=t,this.queryPath=[],this.modelManager=n}addStep(e){const t=this.getLastStep(),n=t?t.targetClassId:this.queryRootId,o=this.modelManager.getRelationshipOppositeEndClass(e,n);if(!o)throw new Error(`QueryPathBuilder Error: Unable to find target class for relationship ID ${e}`);const s=this.modelManager.getRelationshipEndClassRoleName(e,o.id);if(void 0===s)throw new Error(`QueryPathBuilder Error: Unable to find role name for relationship ID ${e}`);const i=this.buildPathStep(e,s,o.id,o.name);if(!this.modelManager.isClassDirectlyReachableFrom(i.sourceClassId,i.targetClassId,i.relationshipId))throw new Error(`QueryPathBuilder Error: Target class ${o.name} is not directly reachable from source class ${i.sourceClassName}`);this.queryPath.push(i)}removeElementsFromStep(e,t,n,o){const s=this.buildPathStep(e,t,n,o),i=this.queryPath.indexOf(s);-1!==i&&(this.queryPath=this.queryPath.slice(i,this.queryPath.length-i))}buildPathStep(e,t,n,o){const s=this.getLastStep();return{relationshipId:e,roleName:t,sourceClassId:s?s.targetClassId:this.queryRootId,sourceClassName:s?s.targetClassName:this.queryRootClass.name,targetClassId:n,targetClassName:o}}getLastStep(){if(0!==this.queryPath.length)return this.queryPath[this.queryPath.length-1]}getValidOutgoingRelationshipsFromLastStep(){const e=this.getLastStep(),t=e?e.targetClassId:this.queryRootId;return this.modelManager.getClassOutgoingAssociationsById(t)}getQueryPath(){return this.queryPath}getQueryRootId(){return this.queryRootId}getQueryRootClass(){return this.queryRootClass}};class nu{constructor(e,t,n,o,s,i){this.queryShapeManager=e,this.updaterService=t,this.sidebarUIController=n,this.editorManager=o,this.modelsManager=s,this.heuristicService=i,this.currentQueryPathBuilder=null}isQueryPathInProgress(){return null!==this.currentQueryPathBuilder}createQueryPathBuilder(e,t,n){const o=new tu(e,t,n);return this.currentQueryPathBuilder=o,this.sidebarUIController.setCurrentQueryPathBuilder(o),o}destroyCurrentQueryPathBuilder(){this.currentQueryPathBuilder=null,this.sidebarUIController.setCurrentQueryPathBuilder(null)}highlightRelationshipsByRelationship(e){const t=e.map((e=>e.id));this.highlightRelationshipsById(t)}highlightRelationshipsById(e){this.updaterService.highlightRelationships(e,c)}resetHighlightedRelationships(){const e=Object.values(this.modelsManager.getGDMManager().getModel().relationships).map((e=>e.id));this.updaterService.resetHighlightedRelationships(e)}selectQueryRoot(){if(!this.currentQueryPathBuilder){const e=this.editorManager.getSelection();if(!e)return void console.error("No selection found");const t=Object.keys(e.elements);if(1!==t.length)return void console.error("Selection is not a single class");const n=this.modelsManager.getGDMManager(),o=t[0],s=n.getClassElementById(o);if(!s)return void console.error("Query root class not found");this.queryShapeManager.addNewQueryShape(s),this.currentQueryPathBuilder=this.createQueryPathBuilder(o,s,n),this.updaterService.startQueryRoot(o);const i=this.currentQueryPathBuilder.getValidOutgoingRelationshipsFromLastStep();if(!i)return void console.error("No valid outgoing relationships found");this.highlightRelationshipsByRelationship(i),this.editorManager.setIsRootPathSelectionInProgress(!0),this.heuristicService.addQueryRootId(o)}this.sidebarUIController.selectQueryRoot(),this.sidebarUIController.updateAllButtonStates(!1,!1,!1,this.isQueryPathInProgress(),!1,!1)}addToQueryPath(){if(!this.currentQueryPathBuilder)throw new Error("No current query path builder found");const e=this.sidebarUIController.getLastSelectionUpdateData();if(!e)return void console.error("No selection found");const t=this.currentQueryPathBuilder.getValidOutgoingRelationshipsFromLastStep();if(!t)return void console.error("No valid outgoing relationships found");const n=t.filter((e=>e.id!==this.currentQueryPathBuilder?.getLastStep()?.relationshipId)),o=e.selectedRelationshipIds;if(1!==o.length)return void console.error("Selection is not a single relationship");const s=o[0];if(!n.map((e=>e.id)).includes(s))return void console.error("Selected relationship is not valid");this.currentQueryPathBuilder.addStep(s),this.resetHighlightedRelationships();const i=this.currentQueryPathBuilder.getValidOutgoingRelationshipsFromLastStep();if(!i)throw new Error("No valid outgoing relationships found after adding step");const r=i.filter((e=>e.id!==s));this.highlightRelationshipsByRelationship(r);const a=this.currentQueryPathBuilder.getLastStep();if(!a)throw new Error("No last step found");const l=a.targetClassId,c=this.modelsManager.getGDMManager().getRelationsipIsSourceOrTarget(s,l);if(!c)throw new Error("No type of end found");this.updaterService.tagRelationshipEndAsQueried(s,c),this.updaterService.tagClassAsQueried([l]);const d=this.modelsManager.getGDMManager().getAssociationEndInfo(s,c);this.heuristicService.addQueriedRelationshipEndInfo(d),this.heuristicService.addQueriedClassId(l)}finishQueryPath(){if(!this.currentQueryPathBuilder)throw new Error("No current query path builder found");const e=this.currentQueryPathBuilder.getQueryRootId(),t=this.currentQueryPathBuilder.getQueryPath();this.queryShapeManager.addQueryPath(e,t),this.destroyCurrentQueryPathBuilder(),this.updaterService.finishQueryPath(),this.editorManager.setIsRootPathSelectionInProgress(!1),this.sidebarUIController.finishQueryPath(),this.resetHighlightedRelationships(),this.sidebarUIController.updateAllButtonStates(!1,!1,!1,this.isQueryPathInProgress(),!1,!1)}highlightQueryShape(e){this.resetHighlightedRelationships();const t=this.queryShapeManager.getQueryShape(e);if(!t)return;const n=new Set;for(const e of t.queryPaths)for(const t of e)n.add(t.relationshipId);this.highlightRelationshipsById(Array.from(n))}stopShowingQueryShape(){this.resetHighlightedRelationships(),this.sidebarUIController.stopShowingQueryShape()}}const ou=class{constructor(){this.map=new Map}add(e){const t=this.getRelationshipKey(e);return this.map.has(t)||this.map.set(t,e),this}has(e){return this.map.has(this.getRelationshipKey(e))}delete(e){return this.map.delete(this.getRelationshipKey(e))}get size(){return this.map.size}toArray(){return Array.from(this.map.values())}clear(){this.map.clear()}getRelationshipKey(e){return[e.relationshipType,e.relationshipId,e.sourceClassId,e.targetClassId,e.endType,e.roleName,e.multiplicity].join("|")}},su=class{constructor(e,t,n){this.instantiableClassesIds=new Set,this.modifiableClassesIds=new Set,this.queryRootsIds=new Set,this.queriedClassesIds=new Set,this.requiredClassesIds=new Set,this.pendingClassesIds=new Set,this.changesSinceLastHeuristicRun=!1,this.modifiableRelationshipsEndInfo=new ou,this.queriedRelationshipsEndInfo=new ou,this.requiredRelationshipsEndInfo=new ou,this.modelsManager=e,this.updaterService=t,this.queryShapeManager=n}clearHeuristicsData(){this.instantiableClassesIds.clear(),this.modifiableClassesIds.clear(),this.queryRootsIds.clear(),this.queriedClassesIds.clear(),this.requiredClassesIds.clear(),this.pendingClassesIds.clear(),this.modifiableRelationshipsEndInfo.clear(),this.queriedRelationshipsEndInfo.clear(),this.requiredRelationshipsEndInfo.clear(),this.changesSinceLastHeuristicRun=!1}runHeuristicsLoop(){this.changesSinceLastHeuristicRun=!1;const e={instantiableClassesIds:this.instantiableClassesIds.size,modifiableClassesIds:this.modifiableClassesIds.size,queryRootsIds:this.queryRootsIds.size,queriedClassesIds:this.queriedClassesIds.size,requiredClassesIds:this.requiredClassesIds.size,pendingClassesIds:this.pendingClassesIds.size,modifiableRelationshipsEndInfo:this.modifiableRelationshipsEndInfo.size,queriedRelationshipsEndInfo:this.queriedRelationshipsEndInfo.size,requiredRelationshipsEndInfo:this.requiredRelationshipsEndInfo.size};this.heuristic1_anyTagIsAlsoTaggedAsRequired(),this.heuristic2_nonZeroLowerCardinalities(),this.heuristic3_parentClasses(),this.heuristic4_requiredRelationshipsEnds(),this.constraintVerification_eitherIntantiableOrQueried();for(const[t,n]of Object.entries(e))if(this[t].size!==n){this.changesSinceLastHeuristicRun=!0;break}this.changesSinceLastHeuristicRun&&this.runHeuristicsLoop()}updateLDM(){const e=Array.from(this.requiredClassesIds),t=this.requiredRelationshipsEndInfo.toArray(),n=this.requiredRelationshipsEndInfo.toArray().map((e=>e.relationshipId));this.updaterService.updateLDMAfterHeuristics(e,n),this.updaterService.updateLDMRelationships(t)}runHeuristics(){this.runHeuristicsLoop(),this.updateLDM()}makeClassesRequired(e){for(const t of e)this.requiredClassesIds.add(t)}makeRelationshipsRequired(e){for(const t of e)this.requiredRelationshipsEndInfo.add(t)}heuristic1_anyTagIsAlsoTaggedAsRequired(){const e=new Set([...this.instantiableClassesIds,...this.modifiableClassesIds,...this.queryRootsIds,...this.queriedClassesIds]);this.makeClassesRequired(Array.from(e));const t=new Set([...this.modifiableRelationshipsEndInfo.toArray(),...this.queriedRelationshipsEndInfo.toArray()]);this.makeRelationshipsRequired(Array.from(t))}heuristic2_nonZeroLowerCardinalities(){const e=this.modelsManager.getGDMManager();for(const t of this.instantiableClassesIds){const n=e.getClassOutgoingAssociationsWithLowerMultiplicityNotZero(t);for(const o of n){const n=e.getRelationsipIsSourceOrTarget(o.id,t),s="source"===n?"target":"source",i=e.getAssociationEndInfo(o.id,n),r=e.getAssociationEndInfo(o.id,s);this.requiredRelationshipsEndInfo.add(i),this.requiredRelationshipsEndInfo.add(r)}}}heuristic3_parentClasses(){const e=this.modelsManager.getGDMManager();for(const t of this.requiredClassesIds){if(!e.getClassParent(t))continue;const n=e.getClassParentRelationship(t),o="target",s=e.getAssociationEndInfo(n.id,o);this.requiredRelationshipsEndInfo.add(s)}}heuristic4_requiredRelationshipsEnds(){const e=new Set([...this.modifiableRelationshipsEndInfo.toArray(),...this.queriedRelationshipsEndInfo.toArray(),...this.requiredRelationshipsEndInfo.toArray()]);for(const t of e)this.requiredClassesIds.add(t.sourceClassId),this.requiredClassesIds.add(t.targetClassId)}isClassParent(e){for(const t of this.requiredRelationshipsEndInfo.toArray()){const n="ClassInheritance"===t.relationshipType,o=t.targetClassId===e;if(n&&o)return!0}return!1}constraintVerification_eitherIntantiableOrQueried(){for(const e of this.requiredClassesIds){const t=this.instantiableClassesIds.has(e),n=this.queriedClassesIds.has(e),o=this.queryRootsIds.has(e),s=this.pendingClassesIds.has(e),i=this.isClassParent(e);t||n||o||i?s&&(this.pendingClassesIds.delete(e),this.updaterService.removeTagClassPending([e])):(this.pendingClassesIds.add(e),this.updaterService.tagClassAsPending([e]))}}addInstantiableClassId(e){const t=this.modelsManager.getGDMManager().getClassElementById(e);"Class"===t?.type&&(this.instantiableClassesIds.add(e),this.runHeuristics())}addModifiableClassId(e){const t=this.modelsManager.getGDMManager().getClassElementById(e);"Class"===t?.type&&(this.modifiableClassesIds.add(e),this.runHeuristics())}addModifiableRelationshipId(e){this.modifiableRelationshipsEndInfo.add(e),this.runHeuristics()}addQueryRootId(e){const t=this.modelsManager.getGDMManager().getClassElementById(e);"Class"===t?.type&&(this.queryRootsIds.add(e),this.runHeuristics())}addQueriedClassId(e){const t=this.modelsManager.getGDMManager().getClassElementById(e);"Class"===t?.type&&(this.queriedClassesIds.add(e),this.runHeuristics())}addQueriedRelationshipEndInfo(e){this.queriedRelationshipsEndInfo.add(e),this.runHeuristics()}addRequiredClassId(e){const t=this.modelsManager.getGDMManager().getClassElementById(e);"Class"===t?.type&&(this.requiredClassesIds.add(e),this.runHeuristics())}addRequiredRelationshipEndInfo(e){this.requiredRelationshipsEndInfo.add(e),this.runHeuristics()}addPendingClassId(e){const t=this.modelsManager.getGDMManager().getClassElementById(e);"Class"===t?.type&&(this.pendingClassesIds.add(e),this.runHeuristics())}getInstantiableClassesIds(){return this.instantiableClassesIds}getModifiableClassesIds(){return this.modifiableClassesIds}getModifiableRelationshipsEndInfo(){return this.modifiableRelationshipsEndInfo}getQueryRootsIds(){return this.queryRootsIds}getQueriedClassesIds(){return this.queriedClassesIds}getQueriedRelationshipsIds(){return this.queriedRelationshipsEndInfo}getRequiredClassesIds(){return this.requiredClassesIds}getRequiredRelationshipsIds(){return this.requiredRelationshipsEndInfo}getPendingClassesIds(){return this.pendingClassesIds}clear(){this.instantiableClassesIds.clear(),this.modifiableClassesIds.clear(),this.modifiableRelationshipsEndInfo.clear(),this.queryRootsIds.clear(),this.queriedClassesIds.clear(),this.queriedRelationshipsEndInfo.clear(),this.requiredClassesIds.clear(),this.requiredRelationshipsEndInfo.clear(),this.pendingClassesIds.clear()}getAllClassesIds(){return new Set([...this.instantiableClassesIds,...this.modifiableClassesIds,...this.queryRootsIds,...this.queriedClassesIds,...this.requiredClassesIds,...this.pendingClassesIds])}};var iu=n(4692),ru=n.n(iu);class au{constructor(e,t,n,o,s,i){this.id=e,this.x=t,this.y=n,this.xF=o,this.yF=s,this.sceneId=i}getScene(){return this.sceneId}isOver(e,t){return this.x<e&&e<this.xF&&this.y<t&&t<this.yF}}const lu=function(){let e=null,t=[],n=0,o=0,s=!1;const i=500;let r=0,a=0,l=0,c=0,d=!1,h=!1,u=null,p=[],m=!1;const g=14,y="https://interactionlab.hci.uniovi.es:8443",f=y+"/TrackerServer/restws/track",C=y+"/TrackerServer/restws/backgroundTracker",E=y+"/TrackerServer/restws/registerComponent",b=y+"/TrackerServer/restws/registerUserData",v=y+"/TrackerServer/restws/registerDemographicData",w=y+"/TrackerServer/restws/experiment/status/"+g;function k(){if(null===localStorage.getItem("user")||void 0===localStorage.getItem("user")){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZ";localStorage.setItem("user",e[Math.floor(Math.random()*e.length)]+e[Math.floor(Math.random()*e.length)]+e[Math.floor(Math.random()*e.length)]+(Math.floor(899999999999*Math.random())+1e11).toString()+Date.now().toString()+function(){const e=new Date,t=e.getDate();return`${e.getMonth()+1}${t}${e.getFullYear()}`}())}return localStorage.getItem("user")}function x(e){let t=-1;return p.forEach((function(o){o.id===e&&o.getScene()===n&&(t=o.id)})),t}function M(e,t){s&&I(e,0,t)}function S(e){s&&I(e,0,null)}function I(e,s,r){const a=new Object;if(a.id=o++,a.sceneId=n,a.eventType=e,a.timeStamp=Date.now(),void 0!==window.event?(a.x=window.event.clientX,a.y=window.event.clientY):(a.x=0,a.y=0),null==a.x&&(a.x=-1),null==a.y&&(a.y=-1),a.keyValueEvent=-1,a.keyCodeEvent=-1,13==e||14==e||15==e?(a.keyValueEvent=r.key,a.keyCodeEvent=r.keyCode,a.elementId=x(r.target.id)):a.elementId=16==e||17==e||18==e||19==e?x(r.target.id):function(e,t){let o=-1;return p.forEach((function(s){s.isOver(e,t)&&s.getScene()===n&&(o=s.id)})),o}(a.x,a.y),t[t.length]=a,t.length>=i){const e=t;t=[],D(e)}}function T(){if(0==d||a>0)console.log("Not ready to leave page, events still pending");else{if(l>0)return console.log("Not ready to leave page, "+l+" backgrounds still pending"),void setTimeout((()=>{T()}),2e3);console.log("Ready to leave page, pending request:"+a+", pending backgrounds "+l+"/"+c),h&&(console.log("Experiment finished, deleting user "+localStorage.getItem("user")),localStorage.removeItem("user")),null!=u&&(window.location.href=u)}}function P(t){const n={timezone:(new Date).getTimezoneOffset()/60*-1,list:t,idExperiment:g,sessionId:e};m&&ru().ajax({data:JSON.stringify(n),url:f,type:"post",beforeSend:function(){a++,r++,console.log("Sending request. Pending requests: "+a+"/"+r)},success:function(e){console.log("Result: "+e),console.log("Pending Requests: "+a+"/"+r)},complete:function(e,t){a--,console.log("Call completed. Status: "+t+", Pending Requests: "+a+"/"+r),0==a&&(d=!0),T()},error:function(e,t,n){console.log("Status: "+t),console.log("Error: "+n)}})}function D(e){let t=0,n=[];e.forEach((function(e){n[t]=e,t++,t>=i&&(t=0,P(n),n=[])})),P(n),n=[]}function A(t){"undefined"!=typeof html2canvas?html2canvas(document.body).then((n=>{console.log("Delivering background for scene "+t),function(t,n){const o={timezone:(new Date).getTimezoneOffset()/60*-1,experiment:g,sceneId:t,canvas:n.toDataURL("image/png"),timeStamp:Date.now(),sessionId:e};m&&ru().ajax({data:JSON.stringify(o),url:C,type:"post",beforeSend:function(){l++,console.log("Sending background. Pending backgrounds: "+l+"/"+r)},success:function(e){l--,c++,console.log("Result: "+e),console.log("Pending Backgrounds: "+l+"/"+r)},complete:function(e,t){console.log("Call completed. Status: "+t+", Pending Requests: "+a+"/"+r)},error:function(e,t,n){console.log("Status: "+t),console.log("Error: "+n)}})}(t,n)})):console.log("html2canvas not available for taking snapshot")}function L(){S(0)}function R(){S(1)}function N(){S(2)}function B(){S(3)}function O(){S(4)}function $(){S(5)}function U(){S(6)}function F(){S(11)}function z(){S(12)}function H(e){M(13,e)}function j(e){M(14,e)}function Q(e){M(15,e)}function W(e){m&&ru().ajax({data:JSON.stringify(e),url:v,type:"post",success:function(e){},error:function(){}})}return{init:function(){e=k(),console.log("Initialized InteractionLab Heuristics module with user ID: "+e)},startExperiment:function(){e=k(),console.log("Creating user session "+e)},finishExperiment:function(){h=!0},initTracking:function(e){s=!0,ru().ajax({url:w,type:"get",success:function(e){m="OPEN"===e},error:function(){console.log("Error getting experiment status")}}),n=e,console.log("Initializing tracking for scene "+e),S(100),window.addEventListener("scroll",F),window.addEventListener("resize",z),window.addEventListener("mousemove",L),window.addEventListener("mousedown",B),window.addEventListener("mouseup",O),window.addEventListener("click",R),window.addEventListener("dblclick",N),window.addEventListener("contextmenu",U),window.addEventListener("wheel",$),window.addEventListener("keydown",H),window.addEventListener("keypress",j),window.addEventListener("keyup",Q)},finishTracking:function(e){S(200),s=!1,A(n),D(t),t=[],u=e,T()},finishSubsceneTracking:function(){S(200),s=!1,A(n)},registerComponent:function(t,n,o,s,i,r,a,l){p.push(new au(n,o,s,i,r,t)),function(e){const t=document.getElementById(e);null!=t&&(t.addEventListener("focus",(function(e){!function(e){M(16,e)}(e)})),t.addEventListener("blur",(function(e){!function(e){M(17,e)}(e)})))}(n),2!==a&&3!==a||function(e){const t=document.getElementById(e);null!=t&&(t.addEventListener("change",(function(e){!function(e){M(18,e)}(e)})),t.addEventListener("click",(function(e){!function(e){M(19,e)}(e)})))}(n);const c={timezone:(new Date).getTimezoneOffset()/60*-1,sceneId:t,componentId:n,x:Math.round(o),y:Math.round(s),xF:Math.round(i),yF:Math.round(r),timeStamp:Date.now(),idExperiment:g,typeId:a,componentAssociated:l,sessionId:e};m&&ru().ajax({data:JSON.stringify(c),url:E,type:"post",beforeSend:function(){},success:function(e){}})},registerUserData:function(){const t={timezone:(new Date).getTimezoneOffset()/60*-1,timeOpened:new Date,pageon:window.location.pathname,referrer:document.referrer,previousSites:history.length,browserName:navigator.appName,browserEngine:navigator.product,browserVersion1a:navigator.appVersion,browserVersion1b:navigator.userAgent,browserLanguage:navigator.language,browserOnline:navigator.onLine,browserPlatform:navigator.platform,javaEnabled:navigator.javaEnabled(),dataCookiesEnabled:navigator.cookieEnabled,dataCookies1:document.cookie,dataCookies2:decodeURIComponent(document.cookie.split(";")),sizeScreenW:screen.width,sizeScreenH:screen.height,sizeDocW:document.body.clientWidth,sizeDocH:document.body.clientHeight,sizeInW:innerWidth,sizeInH:innerHeight,sizeAvailW:screen.availWidth,sizeAvailH:screen.availHeight,scrColorDepth:screen.colorDepth,scrPixelDepth:screen.pixelDepth,idExperiment:g,sessionId:e};m&&ru().ajax({data:JSON.stringify(t),url:b,type:"post",beforeSend:function(){document.getElementById("resultado")&&(document.getElementById("resultado").innerHTML="Registering user data...")},success:function(e){document.getElementById("result")&&(document.getElementById("result").innerHTML=e)},async:!1})},postNumberDD:function(t,n){W({timezone:(new Date).getTimezoneOffset()/60*-1,id:t,numberValue:n,idExperiment:g,sessionId:e})},postStringDD:function(t,n){W({timezone:(new Date).getTimezoneOffset()/60*-1,id:t,stringValue:n,idExperiment:g,sessionId:e})},postDateDD:function(t,n){W({timezone:(new Date).getTimezoneOffset()/60*-1,id:t,dateValue:n,idExperiment:g,sessionId:e})},registeridentificador:function(e){this.postStringDD(29,e)},getUserId:function(){return e},getExperimentId:function(){return g},EVENT_TYPES:{MOUSE_MOVE:0,CLICK:1,DOUBLE_CLICK:2,MOUSE_DOWN:3,MOUSE_UP:4,WHEEL:5,CONTEXT_MENU:6,WINDOW_SCROLL:11,WINDOW_RESIZE:12,KEY_DOWN:13,KEY_PRESS:14,KEY_UP:15,FOCUS:16,BLUR:17,CHANGE_SELECTION:18,CLICK_SELECTION:19,INIT_TRACKING:100,END_TRACKING:200},COMPONENT_TYPES:{TEXT_FIELD:1,COMBOBOX:2,OPTION:3,RADIO_BUTTON:4,CHECK_BOX:5}}}();let cu,du,hu,uu,pu,mu,gu,yu,fu;Promise.all([n.e(96),n.e(87)]).then(n.bind(n,4087));let Cu=!1;document.addEventListener("DOMContentLoaded",(function(){cu=new Jh(r.GDM,r.LDM),du=new Gh(cu),hu=new p(du),uu=new j(du,cu),pu=new Q(du),mu=new eu,yu=new su(cu,uu,mu),gu=new nu(mu,uu,hu,du,cu,yu),du.initialize(),hu.initialize(),"function"==typeof uu.initialize&&uu.initialize()}));const Eu=e=>{hu.onEditorClick(e)},bu=e=>{hu.onChange(e)},vu=e=>{hu.onSwitch(e)},wu=e=>{hu.setTheming(e)},ku=()=>{du.clearActiveModel(),du.clearInactiveModel(),yu.clearHeuristicsData(),mu.resetQueryShapes()},xu=()=>{gu.selectQueryRoot()},Mu=()=>{gu.addToQueryPath()},Su=()=>{gu.finishQueryPath()},Iu=()=>{const e=hu.getLastSelectionUpdateData();return e?e.selectedElementIds:(console.error("No selection found"),[])},Tu=()=>{const e=Iu();uu.tagClassAsInstantiable(e),hu.updateAllButtonStates(!1,!1,!1,gu.isQueryPathInProgress(),!1,!1),yu.addInstantiableClassId(e[0])},Pu=()=>{const e=Iu();uu.tagClassAsModifiable(e),hu.updateAllButtonStates(!1,!1,!1,gu.isQueryPathInProgress(),!1,!1),yu.addModifiableClassId(e[0])},Du=()=>{const e=Iu();uu.tagClassAsRequired(e),hu.updateAllButtonStates(!1,!1,!1,gu.isQueryPathInProgress(),!1,!1),yu.addRequiredClassId(e[0])},Au=()=>{const e=Iu();uu.tagClassAsQueried(e),yu.addQueriedClassId(e[0])},Lu=()=>{uu.copySelectedElementsToLDM()},Ru=()=>{const e=uu.getSelectedRelationshipInfo();e&&hu.showRelationshipModifiableOptions(e)},Nu=e=>{const t=hu.resetRelationshipModifiableOptions(),n=1===e?"source":"target";uu.tagRelationshipEndAsModifiable(t,n),hu.updateAllButtonStates(!1,!1,!1,gu.isQueryPathInProgress(),!1,!1);const o=cu.getGDMManager().getAssociationEndInfo(t,n);yu.addModifiableRelationshipId(o)},Bu=()=>{const e=Iu()[0];gu.highlightQueryShape(e)},Ou=()=>{gu.stopShowingQueryShape()},$u=()=>{pu.downloadGDMAs("json")},Uu=()=>{pu.downloadLDMAs("json")},Fu=()=>{pu.loadGDM()},zu=()=>{const e=document.getElementById("experimentBtn");Cu?(Cu=!1,lu.finishTracking(),lu.finishExperiment(),Cu=!1,e.textContent="Start Experiment"):(fu=prompt("Please introduce an identifier for the experiment: "),lu.startExperiment(),lu.initTracking(fu),lu.registeridentificador(fu),Cu=!0,e.textContent="Finish Experiment")}}},r={};function a(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={id:e,exports:{}};return i[e].call(n.exports,n,n.exports,a),n.exports}a.m=i,e=[],a.O=(t,n,o,s)=>{if(!n){var i=1/0;for(d=0;d<e.length;d++){for(var[n,o,s]=e[d],r=!0,l=0;l<n.length;l++)(!1&s||i>=s)&&Object.keys(a.O).every((e=>a.O[e](n[l])))?n.splice(l--,1):(r=!1,s<i&&(i=s));if(r){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[n,o,s]},a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,a.t=function(e,o){if(1&o&&(e=this(e)),8&o)return e;if("object"==typeof e&&e){if(4&o&&e.__esModule)return e;if(16&o&&"function"==typeof e.then)return e}var s=Object.create(null);a.r(s);var i={};t=t||[null,n({}),n([]),n(n)];for(var r=2&o&&e;"object"==typeof r&&!~t.indexOf(r);r=n(r))Object.getOwnPropertyNames(r).forEach((t=>i[t]=()=>e[t]));return i.default=()=>e,a.d(s,i),s},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce(((t,n)=>(a.f[n](e,t),t)),[])),a.u=e=>e+".1782901a8431c1c4f5a4.js",a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o={},s="apollon:",a.l=(e,t,n,i)=>{if(o[e])o[e].push(t);else{var r,l;if(void 0!==n)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var h=c[d];if(h.getAttribute("src")==e||h.getAttribute("data-webpack")==s+n){r=h;break}}r||(l=!0,(r=document.createElement("script")).charset="utf-8",r.timeout=120,a.nc&&r.setAttribute("nonce",a.nc),r.setAttribute("data-webpack",s+n),r.src=e),o[e]=[t];var u=(t,n)=>{r.onerror=r.onload=null,clearTimeout(p);var s=o[e];if(delete o[e],r.parentNode&&r.parentNode.removeChild(r),s&&s.forEach((e=>e(n))),t)return t(n)},p=setTimeout(u.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=u.bind(null,r.onerror),r.onload=u.bind(null,r.onload),l&&document.head.appendChild(r)}},a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;a.g.importScripts&&(e=a.g.location+"");var t=a.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=n[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e})(),(()=>{var e={792:0};a.f.j=(t,n)=>{var o=a.o(e,t)?e[t]:void 0;if(0!==o)if(o)n.push(o[2]);else{var s=new Promise(((n,s)=>o=e[t]=[n,s]));n.push(o[2]=s);var i=a.p+a.u(t),r=new Error;a.l(i,(n=>{if(a.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var s=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;r.message="Loading chunk "+t+" failed.\n("+s+": "+i+")",r.name="ChunkLoadError",r.type=s,r.request=i,o[1](r)}}),"chunk-"+t,t)}},a.O.j=t=>0===e[t];var t=(t,n)=>{var o,s,[i,r,l]=n,c=0;if(i.some((t=>0!==e[t]))){for(o in r)a.o(r,o)&&(a.m[o]=r[o]);if(l)var d=l(a)}for(t&&t(n);c<i.length;c++)s=i[c],a.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return a.O(d)},n=self.webpackChunkapollon=self.webpackChunkapollon||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),a.nc=void 0;var l=a.O(void 0,[96],(()=>a(321)));return a.O(l)})()));